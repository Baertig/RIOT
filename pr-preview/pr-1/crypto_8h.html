<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="icon" type="image/png" href="favicon.png">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>sys/include/psa_crypto/psa/crypto.h File Reference</title>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="jquery.min.js"></script>
    <script src="jquery.powertip.min.js"></script>
    <script src="jquery-ui.min.js"></script>
    <script src="jquery.scrollTo.min.js"></script>
    <script src="doxy-jquery.js"></script>
    <script src="dynsections.js"></script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <!-- Bootstrap -->
    <link href="doxygen.css" rel="stylesheet">
    <link href="fonts.css" rel="stylesheet">
    <link href="bootstrap.min.css" rel="stylesheet">
    <link href="jquery.smartmenus.bootstrap.css" rel="stylesheet">
    <link href="riot.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
        <script>
            function displaySR(){
            searchBox.Search();
            var rhtml=(document.getElementById('MSearchResults').contentWindow.document.body.innerHTML).replace(/href=\"\.\.\//g,'href="');
            document.getElementById('MSearchResultsWindow').style.display='none';
            document.getElementById('top').append(document.getElementById('MSearchSelectWindow'));
            document.getElementById('top').append(document.getElementById('MSearchResultsWindow'));
            document.getElementById('doc-content').innerHTML=rhtml;
            }
            function modSearch(){
            if(!searchBox.doxySearch){
                searchBox.doxySearch=searchBox.Search
                searchBox.Search= function(){this.doxySearch();
                var r=document.getElementById('MSearchResultsWindow');console.log(r.style);
                if(parseInt(r.style.left)<0)r.style.left=0;
                var x=document.getElementById('MSearchResults');
                if(x.scrollWidth>window.screen.width)x.style.width=window.screen.width-2+'px';
                var f=document.getElementById('riot-searchform');
                if(parseInt( r.style.top) < f.offsetTop+f.scrollHeight) r.style.top = f.offsetTop+f.scrollHeight+'px';}
            }
            }
        </script>
  </head>
  <body>
      <div id="top">
        <nav class="navbar navbar-inverse">
          <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
              <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" id="brand-logo" href="http://riot-os.org"><img height="40px" src="riot-logo.svg" /></a>
              <p class="navbar-text text-center visible-xs">Documentation</p>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="navbar-collapse">
              <p class="navbar-text navbar-left"><span id="projectbrief">The friendly Operating System for the Internet of Things</span></p>
              <ul id="riot-navlist" class="nav navbar-nav"></ul>
              <form id="riot-searchform" class="navbar-form navbar-left navbar-right" action="https://duckduckgo.com/" method="get">
                 <input type="hidden" name="sites" value="doc.riot-os.org"/>
                 <input type="hidden" name="kt" value="h"/>
                 <div class="form-group">
                   <div id="MSearchBox" class="MSearchBoxActive">
                     <div class="input-group">
                       <div class="input-group-addon">
                         <span id="MSearchSelect" class="glyphicon glyphicon-search" aria-hidden="true" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"></span>
                       </div>
                       <input class="form-control" type="text" name="q" id="MSearchField" placeholder="Search" accesskey="S" onfocus="searchBox.OnSearchFieldFocus(true)" onblur="searchBox.OnSearchFieldFocus(false)" onkeyup="searchBox.OnSearchFieldChange(event); modSearch();">
                       <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()">
                         <span id="search-reset" class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span>
                       </a>
                     </div>
                   </div>
                 </div>
              </form>
            </div><!-- /.navbar-collapse -->
          </div><!-- /.container-fluid -->
        </nav>
      </div>
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('crypto_8h.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">crypto.h File Reference<div class="ingroups"><a class="el" href="group__sys.html">System</a> &raquo; <a class="el" href="group__sys__psa__crypto.html">PSA Cryptographic API</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Function declarations for PSA Crypto.  
<a href="#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Function declarations for PSA Crypto. </p>
<dl class="section author"><dt>Author</dt><dd>Lena Boeckmann <a href="#" onclick="location.href='mai'+'lto:'+'len'+'a.'+'boe'+'ck'+'man'+'n@'+'haw'+'-h'+'amb'+'ur'+'g.d'+'e'; return false;">lena.<span style="display: none;">.nosp@m.</span>boec<span style="display: none;">.nosp@m.</span>kmann<span style="display: none;">.nosp@m.</span>@haw<span style="display: none;">.nosp@m.</span>-hamb<span style="display: none;">.nosp@m.</span>urg.<span style="display: none;">.nosp@m.</span>de</a></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://armmbed.github.io/mbed-crypto/html/index.html">https://armmbed.github.io/mbed-crypto/html/index.html</a> </dd></dl>

<p class="definition">Definition in file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>
</div><div class="textblock"><code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;<a class="el" href="kernel__defines_8h_source.html">kernel_defines.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto__sizes_8h_source.html">crypto_sizes.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto__struct_8h_source.html">crypto_struct.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto__values_8h_source.html">crypto_values.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto__types_8h_source.html">crypto_types.h</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for crypto.h:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypto_8h__incl.svg" width="1627" height="590"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div><div class="textblock"><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypto_8h__dep__incl.svg" width="2547" height="350"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div>
<p><a href="crypto_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="memitem:ac31060595fde8f06cb25184ca5689b75"><td class="memItemLeft" align="right" valign="top"><a id="ac31060595fde8f06cb25184ca5689b75"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ac31060595fde8f06cb25184ca5689b75">PSA_CRYPTO_API_VERSION_MAJOR</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:ac31060595fde8f06cb25184ca5689b75"><td class="mdescLeft">&#160;</td><td class="mdescRight">The major version of this implementation of the PSA Crypto API. <br /></td></tr>
<tr class="separator:ac31060595fde8f06cb25184ca5689b75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a154ccd72cff6c6c5a3a38c9a7027d3bf"><td class="memItemLeft" align="right" valign="top"><a id="a154ccd72cff6c6c5a3a38c9a7027d3bf"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a154ccd72cff6c6c5a3a38c9a7027d3bf">PSA_CRYPTO_API_VERSION_MINOR</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:a154ccd72cff6c6c5a3a38c9a7027d3bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">The minor version of this implementation of the PSA Crypto API. <br /></td></tr>
<tr class="separator:a154ccd72cff6c6c5a3a38c9a7027d3bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dfb4c6a8d0ec1d237dcc30de04aeeb3"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a4dfb4c6a8d0ec1d237dcc30de04aeeb3">psa_status_to_humanly_readable</a> (psa_status_t status)</td></tr>
<tr class="memdesc:a4dfb4c6a8d0ec1d237dcc30de04aeeb3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function to convert PSA status values humanly readable.  <a href="#a4dfb4c6a8d0ec1d237dcc30de04aeeb3">More...</a><br /></td></tr>
<tr class="separator:a4dfb4c6a8d0ec1d237dcc30de04aeeb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2de150803fc2f7dc6101d5af7e921dd9"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init</a> (void)</td></tr>
<tr class="memdesc:a2de150803fc2f7dc6101d5af7e921dd9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Library initialization.  <a href="#a2de150803fc2f7dc6101d5af7e921dd9">More...</a><br /></td></tr>
<tr class="separator:a2de150803fc2f7dc6101d5af7e921dd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a174ed4f8e3f3db72670968050d8db6df"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a174ed4f8e3f3db72670968050d8db6df">psa_aead_encrypt</a> (<a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> key, psa_algorithm_t alg, const uint8_t *nonce, size_t nonce_length, const uint8_t *additional_data, size_t additional_data_length, const uint8_t *plaintext, size_t plaintext_length, uint8_t *ciphertext, size_t ciphertext_size, size_t *ciphertext_length)</td></tr>
<tr class="memdesc:a174ed4f8e3f3db72670968050d8db6df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process an authenticated encryption operation.  <a href="#a174ed4f8e3f3db72670968050d8db6df">More...</a><br /></td></tr>
<tr class="separator:a174ed4f8e3f3db72670968050d8db6df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb268fefdd140c2e4d802b01b95a8e7a"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#abb268fefdd140c2e4d802b01b95a8e7a">psa_aead_decrypt</a> (<a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> key, psa_algorithm_t alg, const uint8_t *nonce, size_t nonce_length, const uint8_t *additional_data, size_t additional_data_length, const uint8_t *ciphertext, size_t ciphertext_length, uint8_t *plaintext, size_t plaintext_size, size_t *plaintext_length)</td></tr>
<tr class="memdesc:abb268fefdd140c2e4d802b01b95a8e7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process an authenticated decryption operation.  <a href="#abb268fefdd140c2e4d802b01b95a8e7a">More...</a><br /></td></tr>
<tr class="separator:abb268fefdd140c2e4d802b01b95a8e7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5497da908443e971fdd60248ad07bdae"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a5497da908443e971fdd60248ad07bdae">psa_aead_encrypt_setup</a> (<a class="el" href="crypto__types_8h.html#a14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *operation, <a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> key, psa_algorithm_t alg)</td></tr>
<tr class="memdesc:a5497da908443e971fdd60248ad07bdae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the key for a multi-part authenticated encryption operation.  <a href="#a5497da908443e971fdd60248ad07bdae">More...</a><br /></td></tr>
<tr class="separator:a5497da908443e971fdd60248ad07bdae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31af4853ff1f9df38b589f6014e278b8"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a31af4853ff1f9df38b589f6014e278b8">psa_aead_decrypt_setup</a> (<a class="el" href="crypto__types_8h.html#a14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *operation, <a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> key, psa_algorithm_t alg)</td></tr>
<tr class="memdesc:a31af4853ff1f9df38b589f6014e278b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the key for a multi-part authenticated decryption operation.  <a href="#a31af4853ff1f9df38b589f6014e278b8">More...</a><br /></td></tr>
<tr class="separator:a31af4853ff1f9df38b589f6014e278b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3431e28d05002c2a7b0760610176050"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ad3431e28d05002c2a7b0760610176050">psa_aead_set_lengths</a> (<a class="el" href="crypto__types_8h.html#a14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *operation, size_t ad_length, size_t plaintext_length)</td></tr>
<tr class="memdesc:ad3431e28d05002c2a7b0760610176050"><td class="mdescLeft">&#160;</td><td class="mdescRight">Declare the lengths of the message and additional data for AEAD.  <a href="#ad3431e28d05002c2a7b0760610176050">More...</a><br /></td></tr>
<tr class="separator:ad3431e28d05002c2a7b0760610176050"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5799df1c555efd35970b65be51cb07d1"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a5799df1c555efd35970b65be51cb07d1">psa_aead_generate_nonce</a> (<a class="el" href="crypto__types_8h.html#a14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *operation, uint8_t *nonce, size_t nonce_size, size_t *nonce_length)</td></tr>
<tr class="memdesc:a5799df1c555efd35970b65be51cb07d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a random nonce for an authenticated encryption operation.  <a href="#a5799df1c555efd35970b65be51cb07d1">More...</a><br /></td></tr>
<tr class="separator:a5799df1c555efd35970b65be51cb07d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59132751a6f843d038924cb217b5e13b"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a59132751a6f843d038924cb217b5e13b">psa_aead_set_nonce</a> (<a class="el" href="crypto__types_8h.html#a14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *operation, const uint8_t *nonce, size_t nonce_length)</td></tr>
<tr class="memdesc:a59132751a6f843d038924cb217b5e13b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the nonce for an authenticated encryption or decryption operation.  <a href="#a59132751a6f843d038924cb217b5e13b">More...</a><br /></td></tr>
<tr class="separator:a59132751a6f843d038924cb217b5e13b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d0eed03f832e5c9c91cb8adf2882569"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a6d0eed03f832e5c9c91cb8adf2882569">psa_aead_update_ad</a> (<a class="el" href="crypto__types_8h.html#a14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *operation, const uint8_t *input, size_t input_length)</td></tr>
<tr class="memdesc:a6d0eed03f832e5c9c91cb8adf2882569"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pass additional data to an active AEAD operation.  <a href="#a6d0eed03f832e5c9c91cb8adf2882569">More...</a><br /></td></tr>
<tr class="separator:a6d0eed03f832e5c9c91cb8adf2882569"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6d49864951ca42136b4a9b71ea26e5c"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#af6d49864951ca42136b4a9b71ea26e5c">psa_aead_update</a> (<a class="el" href="crypto__types_8h.html#a14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *operation, const uint8_t *input, size_t input_length, uint8_t *output, size_t output_size, size_t *output_length)</td></tr>
<tr class="memdesc:af6d49864951ca42136b4a9b71ea26e5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt or decrypt a message fragment in an active AEAD operation.  <a href="#af6d49864951ca42136b4a9b71ea26e5c">More...</a><br /></td></tr>
<tr class="separator:af6d49864951ca42136b4a9b71ea26e5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a759791bbe1763b377c3b5447641f1fc8"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a759791bbe1763b377c3b5447641f1fc8">psa_aead_finish</a> (<a class="el" href="crypto__types_8h.html#a14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *operation, uint8_t *ciphertext, size_t ciphertext_size, size_t *ciphertext_length, uint8_t *tag, size_t tag_size, size_t *tag_length)</td></tr>
<tr class="memdesc:a759791bbe1763b377c3b5447641f1fc8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finish encrypting a message in an AEAD operation.  <a href="#a759791bbe1763b377c3b5447641f1fc8">More...</a><br /></td></tr>
<tr class="separator:a759791bbe1763b377c3b5447641f1fc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0280e2e61a185b893c36d858453f0d0"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ae0280e2e61a185b893c36d858453f0d0">psa_aead_verify</a> (<a class="el" href="crypto__types_8h.html#a14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *operation, uint8_t *plaintext, size_t plaintext_size, size_t *plaintext_length, const uint8_t *tag, size_t tag_length)</td></tr>
<tr class="memdesc:ae0280e2e61a185b893c36d858453f0d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finish authenticating and decrypting a message in an AEAD operation.  <a href="#ae0280e2e61a185b893c36d858453f0d0">More...</a><br /></td></tr>
<tr class="separator:ae0280e2e61a185b893c36d858453f0d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8a5f93d92318c8f592ee9fbb9d36ba0"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ae8a5f93d92318c8f592ee9fbb9d36ba0">psa_aead_abort</a> (<a class="el" href="crypto__types_8h.html#a14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *operation)</td></tr>
<tr class="memdesc:ae8a5f93d92318c8f592ee9fbb9d36ba0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Abort an AEAD operation.  <a href="#ae8a5f93d92318c8f592ee9fbb9d36ba0">More...</a><br /></td></tr>
<tr class="separator:ae8a5f93d92318c8f592ee9fbb9d36ba0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29f79a5294e91c320ba69c1956ccf506"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a29f79a5294e91c320ba69c1956ccf506">psa_asymmetric_encrypt</a> (<a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> key, psa_algorithm_t alg, const uint8_t *input, size_t input_length, const uint8_t *salt, size_t salt_length, uint8_t *output, size_t output_size, size_t *output_length)</td></tr>
<tr class="memdesc:a29f79a5294e91c320ba69c1956ccf506"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt a short message with a public key.  <a href="#a29f79a5294e91c320ba69c1956ccf506">More...</a><br /></td></tr>
<tr class="separator:a29f79a5294e91c320ba69c1956ccf506"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19a171d35473710c3b78744713f3fa64"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a19a171d35473710c3b78744713f3fa64">psa_asymmetric_decrypt</a> (<a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> key, psa_algorithm_t alg, const uint8_t *input, size_t input_length, const uint8_t *salt, size_t salt_length, uint8_t *output, size_t output_size, size_t *output_length)</td></tr>
<tr class="memdesc:a19a171d35473710c3b78744713f3fa64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypt a short message with a private key.  <a href="#a19a171d35473710c3b78744713f3fa64">More...</a><br /></td></tr>
<tr class="separator:a19a171d35473710c3b78744713f3fa64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad482cdca2098bca0620596aaa02eaa4"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#aad482cdca2098bca0620596aaa02eaa4">psa_cipher_abort</a> (<a class="el" href="crypto__types_8h.html#a1399de29db657e3737bb09927aae51fa">psa_cipher_operation_t</a> *operation)</td></tr>
<tr class="memdesc:aad482cdca2098bca0620596aaa02eaa4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Abort a cipher operation.  <a href="#aad482cdca2098bca0620596aaa02eaa4">More...</a><br /></td></tr>
<tr class="separator:aad482cdca2098bca0620596aaa02eaa4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31dd2b33667e1a4aebd4789d789c9c55"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a31dd2b33667e1a4aebd4789d789c9c55">psa_cipher_decrypt</a> (<a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> key, psa_algorithm_t alg, const uint8_t *input, size_t input_length, uint8_t *output, size_t output_size, size_t *output_length)</td></tr>
<tr class="memdesc:a31dd2b33667e1a4aebd4789d789c9c55"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypt a message using a symmetric cipher.  <a href="#a31dd2b33667e1a4aebd4789d789c9c55">More...</a><br /></td></tr>
<tr class="separator:a31dd2b33667e1a4aebd4789d789c9c55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ea37677a0e9152ff712d2ea0f3096ad"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a9ea37677a0e9152ff712d2ea0f3096ad">psa_cipher_decrypt_setup</a> (<a class="el" href="crypto__types_8h.html#a1399de29db657e3737bb09927aae51fa">psa_cipher_operation_t</a> *operation, <a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> key, psa_algorithm_t alg)</td></tr>
<tr class="memdesc:a9ea37677a0e9152ff712d2ea0f3096ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the key for a multi-part symmetric decryption operation.  <a href="#a9ea37677a0e9152ff712d2ea0f3096ad">More...</a><br /></td></tr>
<tr class="separator:a9ea37677a0e9152ff712d2ea0f3096ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ba1e627bd194914ef9297212dd423f9"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a0ba1e627bd194914ef9297212dd423f9">psa_cipher_encrypt</a> (<a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> key, psa_algorithm_t alg, const uint8_t *input, size_t input_length, uint8_t *output, size_t output_size, size_t *output_length)</td></tr>
<tr class="memdesc:a0ba1e627bd194914ef9297212dd423f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt a message using a symmetric cipher.  <a href="#a0ba1e627bd194914ef9297212dd423f9">More...</a><br /></td></tr>
<tr class="separator:a0ba1e627bd194914ef9297212dd423f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac696b9ac87eac90d25e08e34d040ff72"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ac696b9ac87eac90d25e08e34d040ff72">psa_cipher_encrypt_setup</a> (<a class="el" href="crypto__types_8h.html#a1399de29db657e3737bb09927aae51fa">psa_cipher_operation_t</a> *operation, <a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> key, psa_algorithm_t alg)</td></tr>
<tr class="memdesc:ac696b9ac87eac90d25e08e34d040ff72"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the key for a multi-part symmetric encryption operation.  <a href="#ac696b9ac87eac90d25e08e34d040ff72">More...</a><br /></td></tr>
<tr class="separator:ac696b9ac87eac90d25e08e34d040ff72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dcb58b8befe23f8a4d7a1d49c99249b"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a1dcb58b8befe23f8a4d7a1d49c99249b">psa_cipher_finish</a> (<a class="el" href="crypto__types_8h.html#a1399de29db657e3737bb09927aae51fa">psa_cipher_operation_t</a> *operation, uint8_t *output, size_t output_size, size_t *output_length)</td></tr>
<tr class="memdesc:a1dcb58b8befe23f8a4d7a1d49c99249b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finish encrypting or decrypting a message in a cipher operation.  <a href="#a1dcb58b8befe23f8a4d7a1d49c99249b">More...</a><br /></td></tr>
<tr class="separator:a1dcb58b8befe23f8a4d7a1d49c99249b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29fd7d32a5729226a2f73e7b6487bd8a"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a29fd7d32a5729226a2f73e7b6487bd8a">psa_cipher_generate_iv</a> (<a class="el" href="crypto__types_8h.html#a1399de29db657e3737bb09927aae51fa">psa_cipher_operation_t</a> *operation, uint8_t *iv, size_t iv_size, size_t *iv_length)</td></tr>
<tr class="memdesc:a29fd7d32a5729226a2f73e7b6487bd8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate an initialization vector (IV) for a symmetric encryption operation.  <a href="#a29fd7d32a5729226a2f73e7b6487bd8a">More...</a><br /></td></tr>
<tr class="separator:a29fd7d32a5729226a2f73e7b6487bd8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9caddac1a429a5032d6d4a907fb70ba1"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a9caddac1a429a5032d6d4a907fb70ba1">psa_cipher_set_iv</a> (<a class="el" href="crypto__types_8h.html#a1399de29db657e3737bb09927aae51fa">psa_cipher_operation_t</a> *operation, const uint8_t *iv, size_t iv_length)</td></tr>
<tr class="memdesc:a9caddac1a429a5032d6d4a907fb70ba1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the initialization vector (IV) for a symmetric encryption or decryption operation.  <a href="#a9caddac1a429a5032d6d4a907fb70ba1">More...</a><br /></td></tr>
<tr class="separator:a9caddac1a429a5032d6d4a907fb70ba1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3ca27ac6682917c48247d01fd96cd0f"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ac3ca27ac6682917c48247d01fd96cd0f">psa_cipher_update</a> (<a class="el" href="crypto__types_8h.html#a1399de29db657e3737bb09927aae51fa">psa_cipher_operation_t</a> *operation, const uint8_t *input, size_t input_length, uint8_t *output, size_t output_size, size_t *output_length)</td></tr>
<tr class="memdesc:ac3ca27ac6682917c48247d01fd96cd0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt or decrypt a message fragment in an active cipher operation.  <a href="#ac3ca27ac6682917c48247d01fd96cd0f">More...</a><br /></td></tr>
<tr class="separator:ac3ca27ac6682917c48247d01fd96cd0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78da90274bd8f8680017a4bb513803a1"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a78da90274bd8f8680017a4bb513803a1">psa_copy_key</a> (<a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> source_key, const <a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *attributes, <a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> *target_key)</td></tr>
<tr class="memdesc:a78da90274bd8f8680017a4bb513803a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make a copy of a key.  <a href="#a78da90274bd8f8680017a4bb513803a1">More...</a><br /></td></tr>
<tr class="separator:a78da90274bd8f8680017a4bb513803a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af503cd251eff1a0d6cd7d8e47003b92e"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#af503cd251eff1a0d6cd7d8e47003b92e">psa_destroy_key</a> (<a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> key)</td></tr>
<tr class="memdesc:af503cd251eff1a0d6cd7d8e47003b92e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy a key.  <a href="#af503cd251eff1a0d6cd7d8e47003b92e">More...</a><br /></td></tr>
<tr class="separator:af503cd251eff1a0d6cd7d8e47003b92e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f2f7c851186c5d1d928be0b6020225c"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a5f2f7c851186c5d1d928be0b6020225c">psa_export_key</a> (<a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> key, uint8_t *data, size_t data_size, size_t *data_length)</td></tr>
<tr class="memdesc:a5f2f7c851186c5d1d928be0b6020225c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Export a key in binary format.  <a href="#a5f2f7c851186c5d1d928be0b6020225c">More...</a><br /></td></tr>
<tr class="separator:a5f2f7c851186c5d1d928be0b6020225c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76970efac4f9418a03bf59dc345eaf88"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a76970efac4f9418a03bf59dc345eaf88">psa_export_public_key</a> (<a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> key, uint8_t *data, size_t data_size, size_t *data_length)</td></tr>
<tr class="memdesc:a76970efac4f9418a03bf59dc345eaf88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Export a public key or the public part of a key pair in binary format.  <a href="#a76970efac4f9418a03bf59dc345eaf88">More...</a><br /></td></tr>
<tr class="separator:a76970efac4f9418a03bf59dc345eaf88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ad52722505e0c0b3ffca6c9cd8ac5c2"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a5ad52722505e0c0b3ffca6c9cd8ac5c2">psa_builtin_generate_key</a> (const <a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *attributes, uint8_t *key_buffer, size_t key_buffer_size, size_t *key_buffer_length)</td></tr>
<tr class="memdesc:a5ad52722505e0c0b3ffca6c9cd8ac5c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Built-in key generation function.  <a href="#a5ad52722505e0c0b3ffca6c9cd8ac5c2">More...</a><br /></td></tr>
<tr class="separator:a5ad52722505e0c0b3ffca6c9cd8ac5c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a950b4199ae7a0164006bd3d6927d1efe"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a950b4199ae7a0164006bd3d6927d1efe">psa_generate_key</a> (const <a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *attributes, <a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> *key)</td></tr>
<tr class="memdesc:a950b4199ae7a0164006bd3d6927d1efe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a key or key pair.  <a href="#a950b4199ae7a0164006bd3d6927d1efe">More...</a><br /></td></tr>
<tr class="separator:a950b4199ae7a0164006bd3d6927d1efe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f55697f068cf08fe5a7b90757aadaa9"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a8f55697f068cf08fe5a7b90757aadaa9">psa_builtin_generate_random</a> (uint8_t *output, size_t output_size)</td></tr>
<tr class="memdesc:a8f55697f068cf08fe5a7b90757aadaa9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Built-in function for random number generation.  <a href="#a8f55697f068cf08fe5a7b90757aadaa9">More...</a><br /></td></tr>
<tr class="separator:a8f55697f068cf08fe5a7b90757aadaa9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1985eae417dfbccedf50d5fff54ea8c5"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a1985eae417dfbccedf50d5fff54ea8c5">psa_generate_random</a> (uint8_t *output, size_t output_size)</td></tr>
<tr class="memdesc:a1985eae417dfbccedf50d5fff54ea8c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate random bytes.  <a href="#a1985eae417dfbccedf50d5fff54ea8c5">More...</a><br /></td></tr>
<tr class="separator:a1985eae417dfbccedf50d5fff54ea8c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb8341ca52baa0279475ea3fd3bcdc98"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#aeb8341ca52baa0279475ea3fd3bcdc98">psa_set_key_algorithm</a> (<a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *attributes, psa_algorithm_t alg)</td></tr>
<tr class="memdesc:aeb8341ca52baa0279475ea3fd3bcdc98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Declare the permitted algorithm policy for a key.  <a href="#aeb8341ca52baa0279475ea3fd3bcdc98">More...</a><br /></td></tr>
<tr class="separator:aeb8341ca52baa0279475ea3fd3bcdc98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac255da850a00bbed925390044f016b34"><td class="memItemLeft" align="right" valign="top">static psa_algorithm_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ac255da850a00bbed925390044f016b34">psa_get_key_algorithm</a> (const <a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *attributes)</td></tr>
<tr class="memdesc:ac255da850a00bbed925390044f016b34"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the permitted algorithm policy from key attributes.  <a href="#ac255da850a00bbed925390044f016b34">More...</a><br /></td></tr>
<tr class="separator:ac255da850a00bbed925390044f016b34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af61683ac87f87687a40262b5afbfa018"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#af61683ac87f87687a40262b5afbfa018">psa_set_key_bits</a> (<a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *attributes, size_t bits)</td></tr>
<tr class="memdesc:af61683ac87f87687a40262b5afbfa018"><td class="mdescLeft">&#160;</td><td class="mdescRight">Declare the size of a key.  <a href="#af61683ac87f87687a40262b5afbfa018">More...</a><br /></td></tr>
<tr class="separator:af61683ac87f87687a40262b5afbfa018"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bee85c2164ad3d4c0d42501241eeb06"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a5bee85c2164ad3d4c0d42501241eeb06">psa_get_key_bits</a> (const <a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *attributes)</td></tr>
<tr class="memdesc:a5bee85c2164ad3d4c0d42501241eeb06"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the key size from key attributes.  <a href="#a5bee85c2164ad3d4c0d42501241eeb06">More...</a><br /></td></tr>
<tr class="separator:a5bee85c2164ad3d4c0d42501241eeb06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc4695aa3d47aa1664271fdc1199bf65"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#adc4695aa3d47aa1664271fdc1199bf65">psa_set_key_id</a> (<a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *attributes, <a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> id)</td></tr>
<tr class="memdesc:adc4695aa3d47aa1664271fdc1199bf65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Declare a key as persistent and set its key identifier.  <a href="#adc4695aa3d47aa1664271fdc1199bf65">More...</a><br /></td></tr>
<tr class="separator:adc4695aa3d47aa1664271fdc1199bf65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add35bbb9e3aea14934cb61c396a3e6f1"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#add35bbb9e3aea14934cb61c396a3e6f1">psa_get_key_id</a> (const <a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *attributes)</td></tr>
<tr class="memdesc:add35bbb9e3aea14934cb61c396a3e6f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the key identifier from key attributes.  <a href="#add35bbb9e3aea14934cb61c396a3e6f1">More...</a><br /></td></tr>
<tr class="separator:add35bbb9e3aea14934cb61c396a3e6f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac03ccf09ca6d36cc3d5b43f8303db6f7"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ac03ccf09ca6d36cc3d5b43f8303db6f7">psa_set_key_lifetime</a> (<a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *attributes, <a class="el" href="lifetime_8h.html#a6821ff6dd39dc2bc370ded760ad8b0cf">psa_key_lifetime_t</a> lifetime)</td></tr>
<tr class="memdesc:ac03ccf09ca6d36cc3d5b43f8303db6f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the location of a persistent key.  <a href="#ac03ccf09ca6d36cc3d5b43f8303db6f7">More...</a><br /></td></tr>
<tr class="separator:ac03ccf09ca6d36cc3d5b43f8303db6f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ea8eae1b81e480cc56dec858859aff9"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="lifetime_8h.html#a6821ff6dd39dc2bc370ded760ad8b0cf">psa_key_lifetime_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a9ea8eae1b81e480cc56dec858859aff9">psa_get_key_lifetime</a> (const <a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *attributes)</td></tr>
<tr class="memdesc:a9ea8eae1b81e480cc56dec858859aff9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the lifetime from key attributes.  <a href="#a9ea8eae1b81e480cc56dec858859aff9">More...</a><br /></td></tr>
<tr class="separator:a9ea8eae1b81e480cc56dec858859aff9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6857ef0ecb3fa844d4536939d9c64025"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a6857ef0ecb3fa844d4536939d9c64025">psa_set_key_type</a> (<a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *attributes, <a class="el" href="psa__crypto_2psa_2key_2type_8h.html#a63fce6880ca5933b5d6baa257febf1f6">psa_key_type_t</a> type)</td></tr>
<tr class="memdesc:a6857ef0ecb3fa844d4536939d9c64025"><td class="mdescLeft">&#160;</td><td class="mdescRight">Declare the type of a key.  <a href="#a6857ef0ecb3fa844d4536939d9c64025">More...</a><br /></td></tr>
<tr class="separator:a6857ef0ecb3fa844d4536939d9c64025"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4fb812af4f57aa1ad85e335a865b918"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="psa__crypto_2psa_2key_2type_8h.html#a63fce6880ca5933b5d6baa257febf1f6">psa_key_type_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ae4fb812af4f57aa1ad85e335a865b918">psa_get_key_type</a> (const <a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *attributes)</td></tr>
<tr class="memdesc:ae4fb812af4f57aa1ad85e335a865b918"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the key type from key attributes.  <a href="#ae4fb812af4f57aa1ad85e335a865b918">More...</a><br /></td></tr>
<tr class="separator:ae4fb812af4f57aa1ad85e335a865b918"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42a65b3c4522ce9b67ea5ea7720e17de"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a42a65b3c4522ce9b67ea5ea7720e17de">psa_set_key_usage_flags</a> (<a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *attributes, <a class="el" href="usage_8h.html#a7bb9de71337e0e98de843aa7f9b55f25">psa_key_usage_t</a> usage_flags)</td></tr>
<tr class="memdesc:a42a65b3c4522ce9b67ea5ea7720e17de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Declare usage flags for a key.  <a href="#a42a65b3c4522ce9b67ea5ea7720e17de">More...</a><br /></td></tr>
<tr class="separator:a42a65b3c4522ce9b67ea5ea7720e17de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1af20f142ca722222c6d98678a0c448"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="usage_8h.html#a7bb9de71337e0e98de843aa7f9b55f25">psa_key_usage_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#aa1af20f142ca722222c6d98678a0c448">psa_get_key_usage_flags</a> (const <a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *attributes)</td></tr>
<tr class="memdesc:aa1af20f142ca722222c6d98678a0c448"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the usage flags from key attributes.  <a href="#aa1af20f142ca722222c6d98678a0c448">More...</a><br /></td></tr>
<tr class="separator:aa1af20f142ca722222c6d98678a0c448"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af737271e0d134f480334784fc23c8672"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#af737271e0d134f480334784fc23c8672">psa_reset_key_attributes</a> (<a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *attributes)</td></tr>
<tr class="memdesc:af737271e0d134f480334784fc23c8672"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset a key attribute object to a freshly initialized state.  <a href="#af737271e0d134f480334784fc23c8672">More...</a><br /></td></tr>
<tr class="separator:af737271e0d134f480334784fc23c8672"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e70d36a3db2ec34425722166f5fa75b"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a8e70d36a3db2ec34425722166f5fa75b">psa_get_key_attributes</a> (<a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> key, <a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *attributes)</td></tr>
<tr class="memdesc:a8e70d36a3db2ec34425722166f5fa75b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the attributes of a key.  <a href="#a8e70d36a3db2ec34425722166f5fa75b">More...</a><br /></td></tr>
<tr class="separator:a8e70d36a3db2ec34425722166f5fa75b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0b4d5f9912a615559497a467b532928"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ab0b4d5f9912a615559497a467b532928">psa_hash_abort</a> (<a class="el" href="crypto__types_8h.html#a3c4205d2ce66c4095fc5c78c25273fab">psa_hash_operation_t</a> *operation)</td></tr>
<tr class="memdesc:ab0b4d5f9912a615559497a467b532928"><td class="mdescLeft">&#160;</td><td class="mdescRight">Abort a hash operation.  <a href="#ab0b4d5f9912a615559497a467b532928">More...</a><br /></td></tr>
<tr class="separator:ab0b4d5f9912a615559497a467b532928"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39673348f3302b4646bd780034a5aeda"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a39673348f3302b4646bd780034a5aeda">psa_hash_clone</a> (const <a class="el" href="crypto__types_8h.html#a3c4205d2ce66c4095fc5c78c25273fab">psa_hash_operation_t</a> *source_operation, <a class="el" href="crypto__types_8h.html#a3c4205d2ce66c4095fc5c78c25273fab">psa_hash_operation_t</a> *target_operation)</td></tr>
<tr class="memdesc:a39673348f3302b4646bd780034a5aeda"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clone a hash operation.  <a href="#a39673348f3302b4646bd780034a5aeda">More...</a><br /></td></tr>
<tr class="separator:a39673348f3302b4646bd780034a5aeda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c08f4797bec96b886c8c8d7acc2a553"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a0c08f4797bec96b886c8c8d7acc2a553">psa_hash_compare</a> (psa_algorithm_t alg, const uint8_t *input, size_t input_length, const uint8_t *hash, size_t hash_length)</td></tr>
<tr class="memdesc:a0c08f4797bec96b886c8c8d7acc2a553"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the hash (digest) of a message and compare it with a reference value.  <a href="#a0c08f4797bec96b886c8c8d7acc2a553">More...</a><br /></td></tr>
<tr class="separator:a0c08f4797bec96b886c8c8d7acc2a553"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac69f7f19d96a56c28cf3799d11b12156"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ac69f7f19d96a56c28cf3799d11b12156">psa_hash_compute</a> (psa_algorithm_t alg, const uint8_t *input, size_t input_length, uint8_t *hash, size_t hash_size, size_t *hash_length)</td></tr>
<tr class="memdesc:ac69f7f19d96a56c28cf3799d11b12156"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the hash (digest) of a message.  <a href="#ac69f7f19d96a56c28cf3799d11b12156">More...</a><br /></td></tr>
<tr class="separator:ac69f7f19d96a56c28cf3799d11b12156"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4795fd06a0067b0adcd92e9627b8c97e"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a4795fd06a0067b0adcd92e9627b8c97e">psa_hash_finish</a> (<a class="el" href="crypto__types_8h.html#a3c4205d2ce66c4095fc5c78c25273fab">psa_hash_operation_t</a> *operation, uint8_t *hash, size_t hash_size, size_t *hash_length)</td></tr>
<tr class="memdesc:a4795fd06a0067b0adcd92e9627b8c97e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finish the calculation of the hash of a message.  <a href="#a4795fd06a0067b0adcd92e9627b8c97e">More...</a><br /></td></tr>
<tr class="separator:a4795fd06a0067b0adcd92e9627b8c97e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70d97824771b5195a23236a135fabcc2"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a70d97824771b5195a23236a135fabcc2">psa_hash_resume</a> (<a class="el" href="crypto__types_8h.html#a3c4205d2ce66c4095fc5c78c25273fab">psa_hash_operation_t</a> *operation, const uint8_t *hash_state, size_t hash_state_length)</td></tr>
<tr class="memdesc:a70d97824771b5195a23236a135fabcc2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up a multi-part hash operation using the hash suspend state from a previously suspended hash operation.  <a href="#a70d97824771b5195a23236a135fabcc2">More...</a><br /></td></tr>
<tr class="separator:a70d97824771b5195a23236a135fabcc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d72896cf70fc4d514c5c6b978912515"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a8d72896cf70fc4d514c5c6b978912515">psa_hash_setup</a> (<a class="el" href="crypto__types_8h.html#a3c4205d2ce66c4095fc5c78c25273fab">psa_hash_operation_t</a> *operation, psa_algorithm_t alg)</td></tr>
<tr class="memdesc:a8d72896cf70fc4d514c5c6b978912515"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up a multipart hash operation.  <a href="#a8d72896cf70fc4d514c5c6b978912515">More...</a><br /></td></tr>
<tr class="separator:a8d72896cf70fc4d514c5c6b978912515"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32b41f2790027e066b373552af2c5c60"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a32b41f2790027e066b373552af2c5c60">psa_hash_suspend</a> (<a class="el" href="crypto__types_8h.html#a3c4205d2ce66c4095fc5c78c25273fab">psa_hash_operation_t</a> *operation, uint8_t *hash_state, size_t hash_state_size, size_t *hash_state_length)</td></tr>
<tr class="memdesc:a32b41f2790027e066b373552af2c5c60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Halt the hash operation and extract the intermediate state of the hash computation.  <a href="#a32b41f2790027e066b373552af2c5c60">More...</a><br /></td></tr>
<tr class="separator:a32b41f2790027e066b373552af2c5c60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65b16ef97d7f650899b7db4b7d1112ff"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a65b16ef97d7f650899b7db4b7d1112ff">psa_hash_update</a> (<a class="el" href="crypto__types_8h.html#a3c4205d2ce66c4095fc5c78c25273fab">psa_hash_operation_t</a> *operation, const uint8_t *input, size_t input_length)</td></tr>
<tr class="memdesc:a65b16ef97d7f650899b7db4b7d1112ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a message fragment to a multi-part hash operation.  <a href="#a65b16ef97d7f650899b7db4b7d1112ff">More...</a><br /></td></tr>
<tr class="separator:a65b16ef97d7f650899b7db4b7d1112ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7be923c5700c9c70ef77ee9b76d1a5c0"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a7be923c5700c9c70ef77ee9b76d1a5c0">psa_hash_verify</a> (<a class="el" href="crypto__types_8h.html#a3c4205d2ce66c4095fc5c78c25273fab">psa_hash_operation_t</a> *operation, const uint8_t *hash, size_t hash_length)</td></tr>
<tr class="memdesc:a7be923c5700c9c70ef77ee9b76d1a5c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finish the calculation of the hash of a message and compare it with an expected value.  <a href="#a7be923c5700c9c70ef77ee9b76d1a5c0">More...</a><br /></td></tr>
<tr class="separator:a7be923c5700c9c70ef77ee9b76d1a5c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac123bb75392c062756f95328c240854d"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ac123bb75392c062756f95328c240854d">psa_builtin_import_key</a> (const <a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *attributes, const uint8_t *data, size_t data_length, uint8_t *key_buffer, size_t key_buffer_size, size_t *key_buffer_length, size_t *bits)</td></tr>
<tr class="memdesc:ac123bb75392c062756f95328c240854d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Built-in key import function.  <a href="#ac123bb75392c062756f95328c240854d">More...</a><br /></td></tr>
<tr class="separator:ac123bb75392c062756f95328c240854d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad088d8ebc854d2f7a5b5c1769bc9ed40"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ad088d8ebc854d2f7a5b5c1769bc9ed40">psa_import_key</a> (const <a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *attributes, const uint8_t *data, size_t data_length, <a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> *key)</td></tr>
<tr class="memdesc:ad088d8ebc854d2f7a5b5c1769bc9ed40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Import a key in binary format.  <a href="#ad088d8ebc854d2f7a5b5c1769bc9ed40">More...</a><br /></td></tr>
<tr class="separator:ad088d8ebc854d2f7a5b5c1769bc9ed40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90fdd2716124d0bd258826184824675f"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a90fdd2716124d0bd258826184824675f">psa_key_derivation_abort</a> (<a class="el" href="crypto__types_8h.html#a1ad89f1ce73274b54b6557dda5ee6290">psa_key_derivation_operation_t</a> *operation)</td></tr>
<tr class="memdesc:a90fdd2716124d0bd258826184824675f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Abort a key derivation operation.  <a href="#a90fdd2716124d0bd258826184824675f">More...</a><br /></td></tr>
<tr class="separator:a90fdd2716124d0bd258826184824675f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b0b6769491b25e0592fce0f1c96f842"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a9b0b6769491b25e0592fce0f1c96f842">psa_key_derivation_get_capacity</a> (const <a class="el" href="crypto__types_8h.html#a1ad89f1ce73274b54b6557dda5ee6290">psa_key_derivation_operation_t</a> *operation, size_t *capacity)</td></tr>
<tr class="memdesc:a9b0b6769491b25e0592fce0f1c96f842"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the current capacity of a key derivation operation.  <a href="#a9b0b6769491b25e0592fce0f1c96f842">More...</a><br /></td></tr>
<tr class="separator:a9b0b6769491b25e0592fce0f1c96f842"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fd934dfb0ca45cbf89542ef2a5494c2"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a8fd934dfb0ca45cbf89542ef2a5494c2">psa_key_derivation_input_bytes</a> (<a class="el" href="crypto__types_8h.html#a1ad89f1ce73274b54b6557dda5ee6290">psa_key_derivation_operation_t</a> *operation, <a class="el" href="crypto__types_8h.html#aac4eeacd36596c548b3a48fc06c5048b">psa_key_derivation_step_t</a> step, const uint8_t *data, size_t data_length)</td></tr>
<tr class="memdesc:a8fd934dfb0ca45cbf89542ef2a5494c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provide an input for key derivation or key agreement.  <a href="#a8fd934dfb0ca45cbf89542ef2a5494c2">More...</a><br /></td></tr>
<tr class="separator:a8fd934dfb0ca45cbf89542ef2a5494c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac14f4c2fa41c2c1f6154f8a9c7a5a0cd"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ac14f4c2fa41c2c1f6154f8a9c7a5a0cd">psa_key_derivation_input_integer</a> (<a class="el" href="crypto__types_8h.html#a1ad89f1ce73274b54b6557dda5ee6290">psa_key_derivation_operation_t</a> *operation, <a class="el" href="crypto__types_8h.html#aac4eeacd36596c548b3a48fc06c5048b">psa_key_derivation_step_t</a> step, uint64_t value)</td></tr>
<tr class="memdesc:ac14f4c2fa41c2c1f6154f8a9c7a5a0cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provide a numeric input for key derivation or key agreement.  <a href="#ac14f4c2fa41c2c1f6154f8a9c7a5a0cd">More...</a><br /></td></tr>
<tr class="separator:ac14f4c2fa41c2c1f6154f8a9c7a5a0cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa936b9b1f6264beb6e23afd5f87bcccc"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#aa936b9b1f6264beb6e23afd5f87bcccc">psa_key_derivation_input_key</a> (<a class="el" href="crypto__types_8h.html#a1ad89f1ce73274b54b6557dda5ee6290">psa_key_derivation_operation_t</a> *operation, <a class="el" href="crypto__types_8h.html#aac4eeacd36596c548b3a48fc06c5048b">psa_key_derivation_step_t</a> step, <a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> key)</td></tr>
<tr class="memdesc:aa936b9b1f6264beb6e23afd5f87bcccc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provide an input for key derivation in the form of a key.  <a href="#aa936b9b1f6264beb6e23afd5f87bcccc">More...</a><br /></td></tr>
<tr class="separator:aa936b9b1f6264beb6e23afd5f87bcccc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4da37a87ff9863e2a61eccefd331254a"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a4da37a87ff9863e2a61eccefd331254a">psa_key_derivation_key_agreement</a> (<a class="el" href="crypto__types_8h.html#a1ad89f1ce73274b54b6557dda5ee6290">psa_key_derivation_operation_t</a> *operation, <a class="el" href="crypto__types_8h.html#aac4eeacd36596c548b3a48fc06c5048b">psa_key_derivation_step_t</a> step, <a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> private_key, const uint8_t *peer_key, size_t peer_key_length)</td></tr>
<tr class="memdesc:a4da37a87ff9863e2a61eccefd331254a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform a key agreement and use the shared secret as input to a key derivation.  <a href="#a4da37a87ff9863e2a61eccefd331254a">More...</a><br /></td></tr>
<tr class="separator:a4da37a87ff9863e2a61eccefd331254a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06b7eb34a2fa88965f68e3d023fa12b9"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a06b7eb34a2fa88965f68e3d023fa12b9">psa_key_derivation_output_bytes</a> (<a class="el" href="crypto__types_8h.html#a1ad89f1ce73274b54b6557dda5ee6290">psa_key_derivation_operation_t</a> *operation, uint8_t *output, size_t output_length)</td></tr>
<tr class="memdesc:a06b7eb34a2fa88965f68e3d023fa12b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read some data from a key derivation operation.  <a href="#a06b7eb34a2fa88965f68e3d023fa12b9">More...</a><br /></td></tr>
<tr class="separator:a06b7eb34a2fa88965f68e3d023fa12b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad286b675f3f8b46fa6cab620de6bead3"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ad286b675f3f8b46fa6cab620de6bead3">psa_key_derivation_output_key</a> (const <a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *attributes, <a class="el" href="crypto__types_8h.html#a1ad89f1ce73274b54b6557dda5ee6290">psa_key_derivation_operation_t</a> *operation, <a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> *key)</td></tr>
<tr class="memdesc:ad286b675f3f8b46fa6cab620de6bead3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derive a key from an ongoing key derivation operation.  <a href="#ad286b675f3f8b46fa6cab620de6bead3">More...</a><br /></td></tr>
<tr class="separator:ad286b675f3f8b46fa6cab620de6bead3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c26178dc8e4581cb9fbce5650db3279"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a8c26178dc8e4581cb9fbce5650db3279">psa_key_derivation_set_capacity</a> (<a class="el" href="crypto__types_8h.html#a1ad89f1ce73274b54b6557dda5ee6290">psa_key_derivation_operation_t</a> *operation, size_t capacity)</td></tr>
<tr class="memdesc:a8c26178dc8e4581cb9fbce5650db3279"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the maximum capacity of a key derivation operation.  <a href="#a8c26178dc8e4581cb9fbce5650db3279">More...</a><br /></td></tr>
<tr class="separator:a8c26178dc8e4581cb9fbce5650db3279"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0b6a76e45cceb1862752bf041701859"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ac0b6a76e45cceb1862752bf041701859">psa_key_derivation_setup</a> (<a class="el" href="crypto__types_8h.html#a1ad89f1ce73274b54b6557dda5ee6290">psa_key_derivation_operation_t</a> *operation, psa_algorithm_t alg)</td></tr>
<tr class="memdesc:ac0b6a76e45cceb1862752bf041701859"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up a key derivation operation.  <a href="#ac0b6a76e45cceb1862752bf041701859">More...</a><br /></td></tr>
<tr class="separator:ac0b6a76e45cceb1862752bf041701859"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af01520beb7ba932143ffe733b0795b08"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#af01520beb7ba932143ffe733b0795b08">psa_key_derivation_verify_bytes</a> (<a class="el" href="crypto__types_8h.html#a1ad89f1ce73274b54b6557dda5ee6290">psa_key_derivation_operation_t</a> *operation, const uint8_t *expected_output, size_t output_length)</td></tr>
<tr class="memdesc:af01520beb7ba932143ffe733b0795b08"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compare output data from a key derivation operation to an expected value.  <a href="#af01520beb7ba932143ffe733b0795b08">More...</a><br /></td></tr>
<tr class="separator:af01520beb7ba932143ffe733b0795b08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac041714e34a94742e8ee006ac7dfea5a"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ac041714e34a94742e8ee006ac7dfea5a">psa_key_derivation_verify_key</a> (<a class="el" href="crypto__types_8h.html#a1ad89f1ce73274b54b6557dda5ee6290">psa_key_derivation_operation_t</a> *operation, <a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> expected)</td></tr>
<tr class="memdesc:ac041714e34a94742e8ee006ac7dfea5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compare output data from a key derivation operation to an expected value stored in a key.  <a href="#ac041714e34a94742e8ee006ac7dfea5a">More...</a><br /></td></tr>
<tr class="separator:ac041714e34a94742e8ee006ac7dfea5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd8dd54855ba1bc0a03f104f252884fd"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#acd8dd54855ba1bc0a03f104f252884fd">psa_mac_abort</a> (<a class="el" href="crypto__types_8h.html#a78f0838b0c4e3db28b26355624d4bd37">psa_mac_operation_t</a> *operation)</td></tr>
<tr class="memdesc:acd8dd54855ba1bc0a03f104f252884fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Abort a MAC operation.  <a href="#acd8dd54855ba1bc0a03f104f252884fd">More...</a><br /></td></tr>
<tr class="separator:acd8dd54855ba1bc0a03f104f252884fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb4c0e338fdc192ef8d293aa545d94cb"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#afb4c0e338fdc192ef8d293aa545d94cb">psa_mac_compute</a> (<a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> key, psa_algorithm_t alg, const uint8_t *input, size_t input_length, uint8_t *mac, size_t mac_size, size_t *mac_length)</td></tr>
<tr class="memdesc:afb4c0e338fdc192ef8d293aa545d94cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the message authentication code (MAC) of a message.  <a href="#afb4c0e338fdc192ef8d293aa545d94cb">More...</a><br /></td></tr>
<tr class="separator:afb4c0e338fdc192ef8d293aa545d94cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac22bc0125580c96724a09226cfbc97f2"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ac22bc0125580c96724a09226cfbc97f2">psa_mac_sign_finish</a> (<a class="el" href="crypto__types_8h.html#a78f0838b0c4e3db28b26355624d4bd37">psa_mac_operation_t</a> *operation, uint8_t *mac, size_t mac_size, size_t *mac_length)</td></tr>
<tr class="memdesc:ac22bc0125580c96724a09226cfbc97f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finish the calculation of the MAC of a message.  <a href="#ac22bc0125580c96724a09226cfbc97f2">More...</a><br /></td></tr>
<tr class="separator:ac22bc0125580c96724a09226cfbc97f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6420e166df3967edf60042e589facd04"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a6420e166df3967edf60042e589facd04">psa_mac_sign_setup</a> (<a class="el" href="crypto__types_8h.html#a78f0838b0c4e3db28b26355624d4bd37">psa_mac_operation_t</a> *operation, <a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> key, psa_algorithm_t alg)</td></tr>
<tr class="memdesc:a6420e166df3967edf60042e589facd04"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up a multi-part MAC calculation operation.  <a href="#a6420e166df3967edf60042e589facd04">More...</a><br /></td></tr>
<tr class="separator:a6420e166df3967edf60042e589facd04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5560af371497babefe03c9da4e8a1c05"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a5560af371497babefe03c9da4e8a1c05">psa_mac_update</a> (<a class="el" href="crypto__types_8h.html#a78f0838b0c4e3db28b26355624d4bd37">psa_mac_operation_t</a> *operation, const uint8_t *input, size_t input_length)</td></tr>
<tr class="memdesc:a5560af371497babefe03c9da4e8a1c05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a message fragment to a multi-part MAC operation.  <a href="#a5560af371497babefe03c9da4e8a1c05">More...</a><br /></td></tr>
<tr class="separator:a5560af371497babefe03c9da4e8a1c05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5542f4a1c590d76c329125d571cf494"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#aa5542f4a1c590d76c329125d571cf494">psa_mac_verify</a> (<a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> key, psa_algorithm_t alg, const uint8_t *input, size_t input_length, const uint8_t *mac, size_t mac_length)</td></tr>
<tr class="memdesc:aa5542f4a1c590d76c329125d571cf494"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the MAC of a message and compare it with a reference value.  <a href="#aa5542f4a1c590d76c329125d571cf494">More...</a><br /></td></tr>
<tr class="separator:aa5542f4a1c590d76c329125d571cf494"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac92b2930d6728e1be4d011c05d485822"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ac92b2930d6728e1be4d011c05d485822">psa_mac_verify_finish</a> (<a class="el" href="crypto__types_8h.html#a78f0838b0c4e3db28b26355624d4bd37">psa_mac_operation_t</a> *operation, const uint8_t *mac, size_t mac_length)</td></tr>
<tr class="memdesc:ac92b2930d6728e1be4d011c05d485822"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finish the calculation of the MAC of a message and compare it with an expected value.  <a href="#ac92b2930d6728e1be4d011c05d485822">More...</a><br /></td></tr>
<tr class="separator:ac92b2930d6728e1be4d011c05d485822"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a715679bbf633be958fa447216127eaf8"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a715679bbf633be958fa447216127eaf8">psa_mac_verify_setup</a> (<a class="el" href="crypto__types_8h.html#a78f0838b0c4e3db28b26355624d4bd37">psa_mac_operation_t</a> *operation, <a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> key, psa_algorithm_t alg)</td></tr>
<tr class="memdesc:a715679bbf633be958fa447216127eaf8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up a multi-part MAC verification operation.  <a href="#a715679bbf633be958fa447216127eaf8">More...</a><br /></td></tr>
<tr class="separator:a715679bbf633be958fa447216127eaf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09670055d73cef15422ad1b92113c09f"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a09670055d73cef15422ad1b92113c09f">psa_purge_key</a> (<a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> key)</td></tr>
<tr class="memdesc:a09670055d73cef15422ad1b92113c09f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove non-essential copies of key material from memory.  <a href="#a09670055d73cef15422ad1b92113c09f">More...</a><br /></td></tr>
<tr class="separator:a09670055d73cef15422ad1b92113c09f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c87346ea56b79f3dd173adee2abbde8"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a0c87346ea56b79f3dd173adee2abbde8">psa_raw_key_agreement</a> (psa_algorithm_t alg, <a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> private_key, const uint8_t *peer_key, size_t peer_key_length, uint8_t *output, size_t output_size, size_t *output_length)</td></tr>
<tr class="memdesc:a0c87346ea56b79f3dd173adee2abbde8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform a key agreement and return the raw shared secret.  <a href="#a0c87346ea56b79f3dd173adee2abbde8">More...</a><br /></td></tr>
<tr class="separator:a0c87346ea56b79f3dd173adee2abbde8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a429241820edc81d0f262bdf43d3b6523"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a429241820edc81d0f262bdf43d3b6523">psa_sign_hash</a> (<a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> key, psa_algorithm_t alg, const uint8_t *hash, size_t hash_length, uint8_t *signature, size_t signature_size, size_t *signature_length)</td></tr>
<tr class="memdesc:a429241820edc81d0f262bdf43d3b6523"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sign an already-calculated hash with a private key.  <a href="#a429241820edc81d0f262bdf43d3b6523">More...</a><br /></td></tr>
<tr class="separator:a429241820edc81d0f262bdf43d3b6523"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a295407a9d6fd0d7ddc6aebf6ead4955c"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a295407a9d6fd0d7ddc6aebf6ead4955c">psa_sign_message</a> (<a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> key, psa_algorithm_t alg, const uint8_t *input, size_t input_length, uint8_t *signature, size_t signature_size, size_t *signature_length)</td></tr>
<tr class="memdesc:a295407a9d6fd0d7ddc6aebf6ead4955c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sign a message with a private key.  <a href="#a295407a9d6fd0d7ddc6aebf6ead4955c">More...</a><br /></td></tr>
<tr class="separator:a295407a9d6fd0d7ddc6aebf6ead4955c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01b4dea9fdb090219123f5de26bb6716"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a01b4dea9fdb090219123f5de26bb6716">psa_verify_hash</a> (<a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> key, psa_algorithm_t alg, const uint8_t *hash, size_t hash_length, const uint8_t *signature, size_t signature_length)</td></tr>
<tr class="memdesc:a01b4dea9fdb090219123f5de26bb6716"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verify the signature of a hash or short message using a public key.  <a href="#a01b4dea9fdb090219123f5de26bb6716">More...</a><br /></td></tr>
<tr class="separator:a01b4dea9fdb090219123f5de26bb6716"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8112e02cd89cc652acb2f45074a7464e"><td class="memItemLeft" align="right" valign="top">psa_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a8112e02cd89cc652acb2f45074a7464e">psa_verify_message</a> (<a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> key, psa_algorithm_t alg, const uint8_t *input, size_t input_length, const uint8_t *signature, size_t signature_length)</td></tr>
<tr class="memdesc:a8112e02cd89cc652acb2f45074a7464e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verify the signature of a message with a public key.  <a href="#a8112e02cd89cc652acb2f45074a7464e">More...</a><br /></td></tr>
<tr class="separator:a8112e02cd89cc652acb2f45074a7464e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ae8a5f93d92318c8f592ee9fbb9d36ba0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8a5f93d92318c8f592ee9fbb9d36ba0">&#9670;&nbsp;</a></span>psa_aead_abort()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_aead_abort </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Abort an AEAD operation. </p>
<p>Aborting an operation frees all associated resources except for the operation object itself. Once aborted, the operation object can be reused for another operation by calling <a class="el" href="crypto_8h.html#a5497da908443e971fdd60248ad07bdae">psa_aead_encrypt_setup()</a> or <a class="el" href="crypto_8h.html#a31af4853ff1f9df38b589f6014e278b8">psa_aead_decrypt_setup()</a> again.</p>
<p>This function can be called any time after the operation object has been initialized as described in <a class="el" href="crypto__types_8h.html#a14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a>.</p>
<p>In particular, calling <a class="el" href="crypto_8h.html#ae8a5f93d92318c8f592ee9fbb9d36ba0">psa_aead_abort()</a> after the operation has been terminated by a call to <a class="el" href="crypto_8h.html#ae8a5f93d92318c8f592ee9fbb9d36ba0">psa_aead_abort()</a>, <a class="el" href="crypto_8h.html#a759791bbe1763b377c3b5447641f1fc8">psa_aead_finish()</a> or <a class="el" href="crypto_8h.html#ae0280e2e61a185b893c36d858453f0d0">psa_aead_verify()</a> is safe and has no effect.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>Initialized AEAD operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_HARDWARE_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_BAD_STATE The library has not been previously initialized by <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </dd></dl>

</div>
</div>
<a id="abb268fefdd140c2e4d802b01b95a8e7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb268fefdd140c2e4d802b01b95a8e7a">&#9670;&nbsp;</a></span>psa_aead_decrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_aead_decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">psa_algorithm_t&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>nonce</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nonce_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>additional_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>additional_data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>ciphertext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ciphertext_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>plaintext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>plaintext_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>plaintext_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process an authenticated decryption operation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Identifier of the key to use for the operation. It must allow the usage <a class="el" href="usage_8h.html#ac3f2d2e5983db1edde9f142ca9bf8e6a">PSA_KEY_USAGE_DECRYPT</a>. </td></tr>
    <tr><td class="paramname">alg</td><td>The AEAD algorithm to compute (<code>PSA_ALG_XXX</code> value such that <a class="el" href="aead_2algorithm_8h.html#a1d44829d60065eaa4ac9a703e7d6abc8">PSA_ALG_IS_AEAD</a>(<code>alg</code>) is true). </td></tr>
    <tr><td class="paramname">nonce</td><td>Nonce or IV to use. </td></tr>
    <tr><td class="paramname">nonce_length</td><td>Size of the nonce buffer in bytes. This must be appropriate for the selected algorithm. The default nonce size is <a class="el" href="crypto__sizes_8h.html#a3dcd505a4e70a63708c05bd8591a4782">PSA_AEAD_NONCE_LENGTH</a>(<code>key_type</code>, <code>alg</code>) where <code>key_type</code> is the type of <code>key</code>. </td></tr>
    <tr><td class="paramname">additional_data</td><td>Additional data that will be authenticated but not encrypted. </td></tr>
    <tr><td class="paramname">additional_data_length</td><td>Size of <code>additional_data</code> in bytes. </td></tr>
    <tr><td class="paramname">ciphertext</td><td>Data that has been authenticated and encrypted. For algorithms where the encrypted data and the authentication tag are defined as separate inputs, the buffer must contain the encrypted data followed by the authentication tag. </td></tr>
    <tr><td class="paramname">ciphertext_length</td><td>Size of <code>ciphertext</code> in bytes. </td></tr>
    <tr><td class="paramname">plaintext</td><td>Output buffer for the decrypted data. </td></tr>
    <tr><td class="paramname">plaintext_size</td><td>Size of the plaintext buffer in bytes. This must be appropriate for the selected algorithm and key:<ul>
<li>A sufficient output size is <a class="el" href="crypto__sizes_8h.html#ad33bdee829a3d6c4083cae62d176fa9e">PSA_AEAD_DECRYPT_OUTPUT_SIZE</a>(<code>key_type</code>, <code>alg</code>, <code>ciphertext_length</code>) where <code>key_type</code> is the type of key.</li>
<li><a class="el" href="crypto__sizes_8h.html#aa7135728f0067ffcf6536e7d6c356aa5">PSA_AEAD_DECRYPT_OUTPUT_MAX_SIZE</a>(<code>ciphertext_length</code>) evaluates to the maximum ciphertext size of any supported AEAD decryption. </li>
</ul>
</td></tr>
    <tr><td class="paramname">plaintext_length</td><td>On success, the size of the output in the plaintext buffer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. </dd>
<dd>
PSA_ERROR_INVALID_HANDLE </dd>
<dd>
PSA_ERROR_INVALID_SIGNATURE The ciphertext is not authentic. </dd>
<dd>
PSA_ERROR_NOT_PERMITTED The key does not have the <a class="el" href="usage_8h.html#ac3f2d2e5983db1edde9f142ca9bf8e6a">PSA_KEY_USAGE_DECRYPT</a> flag, or it does not permit the requested algorithm. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT <code>key</code> is not compatible with <code>alg</code>. </dd>
<dd>
PSA_ERROR_NOT_SUPPORTED <code>alg</code> is not supported or is not an AEAD algorithm. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_BUFFER_TOO_SMALL <code>plaintext_size</code> is too small. <a class="el" href="crypto__sizes_8h.html#ad33bdee829a3d6c4083cae62d176fa9e">PSA_AEAD_DECRYPT_OUTPUT_SIZE()</a> or <a class="el" href="crypto__sizes_8h.html#aa7135728f0067ffcf6536e7d6c356aa5">PSA_AEAD_DECRYPT_OUTPUT_MAX_SIZE()</a> can be used to determine the required buffer size. </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_HARDWARE_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd>
<dd>
PSA_ERROR_BAD_STATE The library has not been previously initialized by <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </dd></dl>

</div>
</div>
<a id="a31af4853ff1f9df38b589f6014e278b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31af4853ff1f9df38b589f6014e278b8">&#9670;&nbsp;</a></span>psa_aead_decrypt_setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_aead_decrypt_setup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">psa_algorithm_t&#160;</td>
          <td class="paramname"><em>alg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the key for a multi-part authenticated decryption operation. </p>
<p>The sequence of operations to decrypt a message with authentication is as follows:</p><ol type="1">
<li>Allocate an operation object which will be passed to all the functions listed here</li>
<li>Initialize the operation object with one of the methods described in the documentation for <a class="el" href="crypto__types_8h.html#a14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a>, e.g. <a class="el" href="crypto__struct_8h.html#af52e036794c0dc6fbadd93a2b990f366">PSA_AEAD_OPERATION_INIT</a>.</li>
<li>Call <a class="el" href="crypto_8h.html#a31af4853ff1f9df38b589f6014e278b8">psa_aead_decrypt_setup()</a> to specify the algorithm and key.</li>
<li>If needed, call <a class="el" href="crypto_8h.html#ad3431e28d05002c2a7b0760610176050">psa_aead_set_lengths()</a> to specify the length of the inputs to the subsequent calls to <a class="el" href="crypto_8h.html#a6d0eed03f832e5c9c91cb8adf2882569">psa_aead_update_ad()</a> and <a class="el" href="crypto_8h.html#af6d49864951ca42136b4a9b71ea26e5c">psa_aead_update()</a>. See the documentation of <a class="el" href="crypto_8h.html#ad3431e28d05002c2a7b0760610176050">psa_aead_set_lengths()</a> for details.</li>
<li>Call <a class="el" href="crypto_8h.html#a59132751a6f843d038924cb217b5e13b">psa_aead_set_nonce()</a> with the nonce for the decryption.</li>
<li>Call <a class="el" href="crypto_8h.html#a6d0eed03f832e5c9c91cb8adf2882569">psa_aead_update_ad()</a> zero, one or more times, passing a fragment of the non-encrypted additional authenticated data each time.</li>
<li>Call <a class="el" href="crypto_8h.html#af6d49864951ca42136b4a9b71ea26e5c">psa_aead_update()</a> zero, one or more times, passing a fragment of the message to encrypt each time.</li>
<li>Call <a class="el" href="crypto_8h.html#ae0280e2e61a185b893c36d858453f0d0">psa_aead_verify()</a>.</li>
</ol>
<p>If an error occurs at any step after a call to <a class="el" href="crypto_8h.html#a31af4853ff1f9df38b589f6014e278b8">psa_aead_decrypt_setup()</a>, the operation will need to be reset by a call to <a class="el" href="crypto_8h.html#ae8a5f93d92318c8f592ee9fbb9d36ba0">psa_aead_abort()</a>. The application can call <a class="el" href="crypto_8h.html#ae8a5f93d92318c8f592ee9fbb9d36ba0">psa_aead_abort()</a> at any time after the operation has been initialized.</p>
<p>After a successful call to <a class="el" href="crypto_8h.html#a31af4853ff1f9df38b589f6014e278b8">psa_aead_decrypt_setup()</a>, the application must eventually terminate the operation. The following events terminate an operation:</p><ul>
<li>A successful call to <a class="el" href="crypto_8h.html#ae0280e2e61a185b893c36d858453f0d0">psa_aead_verify()</a>.</li>
<li>A call to <a class="el" href="crypto_8h.html#ae8a5f93d92318c8f592ee9fbb9d36ba0">psa_aead_abort()</a>.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>The operation object to set up. It must have been initialized as per the documentation for <a class="el" href="crypto__types_8h.html#a14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> and not yet in use. </td></tr>
    <tr><td class="paramname">key</td><td>Identifier of the key to use for the operation. It must remain valid until the operation terminates. It must allow the usage <a class="el" href="usage_8h.html#ac3f2d2e5983db1edde9f142ca9bf8e6a">PSA_KEY_USAGE_DECRYPT</a>. </td></tr>
    <tr><td class="paramname">alg</td><td>The AEAD algorithm to compute (<code>PSA_ALG_XXX</code> value such that <a class="el" href="aead_2algorithm_8h.html#a1d44829d60065eaa4ac9a703e7d6abc8">PSA_ALG_IS_AEAD</a>(<code>alg</code>) is true).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. </dd>
<dd>
PSA_ERROR_BAD_STATE The operation state is not valid: it must be inactive. </dd>
<dd>
PSA_ERROR_INVALID_HANDLE </dd>
<dd>
PSA_ERROR_NOT_PERMITTED The key does not have the <a class="el" href="usage_8h.html#ac3f2d2e5983db1edde9f142ca9bf8e6a">PSA_KEY_USAGE_DECRYPT</a> flag, or it does not permit the requested algorithm. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT <code>key</code> is not compatible with <code>alg</code>. </dd>
<dd>
PSA_ERROR_NOT_SUPPORTED <code>alg</code> is not supported or is not an AEAD algorithm. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_HARDWARE_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd>
<dd>
PSA_ERROR_BAD_STATE The library has not been previously initialized by <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </dd></dl>

</div>
</div>
<a id="a174ed4f8e3f3db72670968050d8db6df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a174ed4f8e3f3db72670968050d8db6df">&#9670;&nbsp;</a></span>psa_aead_encrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_aead_encrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">psa_algorithm_t&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>nonce</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nonce_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>additional_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>additional_data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>plaintext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>plaintext_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>ciphertext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ciphertext_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>ciphertext_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process an authenticated encryption operation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Identifier of the key to use for the operation. It must allow the usage <a class="el" href="usage_8h.html#a75153b296d045d529d97203a6a995dad">PSA_KEY_USAGE_ENCRYPT</a>. </td></tr>
    <tr><td class="paramname">alg</td><td>The AEAD algorithm to compute (<code>PSA_ALG_XXX</code> value such that <a class="el" href="aead_2algorithm_8h.html#a1d44829d60065eaa4ac9a703e7d6abc8">PSA_ALG_IS_AEAD</a>(<code>alg</code>) is true). </td></tr>
    <tr><td class="paramname">nonce</td><td>Nonce or IV to use. </td></tr>
    <tr><td class="paramname">nonce_length</td><td>Size of the nonce buffer in bytes. This must be appropriate for the selected algorithm. The default nonce size is <a class="el" href="crypto__sizes_8h.html#a3dcd505a4e70a63708c05bd8591a4782">PSA_AEAD_NONCE_LENGTH</a>(<code>key_type</code>, <code>alg</code>) where <code>key_type</code> is the type of key. </td></tr>
    <tr><td class="paramname">additional_data</td><td>Additional data that will be authenticated but not encrypted. </td></tr>
    <tr><td class="paramname">additional_data_length</td><td>Size of additional_data in bytes. </td></tr>
    <tr><td class="paramname">plaintext</td><td>Data that will be authenticated and encrypted. </td></tr>
    <tr><td class="paramname">plaintext_length</td><td>Size of plaintext in bytes. </td></tr>
    <tr><td class="paramname">ciphertext</td><td>Output buffer for the authenticated and encrypted data. The additional data is not part of this output. For algorithms where the encrypted data and the authentication tag are defined as separate outputs, the authentication tag is appended to the encrypted data. </td></tr>
    <tr><td class="paramname">ciphertext_size</td><td>Size of the ciphertext buffer in bytes. This must be appropriate for the selected algorithm and key:<ul>
<li>A sufficient output size is <a class="el" href="crypto__sizes_8h.html#a0e0791f41b38a79b1fda63c4cb0eec7a">PSA_AEAD_ENCRYPT_OUTPUT_SIZE</a>(<code>key_type</code>, <code>alg</code>, <code>plaintext_length</code>) where key_type is the type of key.</li>
<li><a class="el" href="crypto__sizes_8h.html#a627fd15f45e7aab42d0126f1534f24a5">PSA_AEAD_ENCRYPT_OUTPUT_MAX_SIZE</a>(<code>plaintext_length</code>) evaluates to the maximum ciphertext size of any supported AEAD encryption. </li>
</ul>
</td></tr>
    <tr><td class="paramname">ciphertext_length</td><td>On success, the size of the output in the ciphertext buffer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. </dd>
<dd>
PSA_ERROR_INVALID_HANDLE </dd>
<dd>
PSA_ERROR_NOT_PERMITTED The key does not have the <a class="el" href="usage_8h.html#a75153b296d045d529d97203a6a995dad">PSA_KEY_USAGE_ENCRYPT</a> flag, or it does not permit the requested algorithm. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT <code>key</code> is not compatible with <code>alg</code>. </dd>
<dd>
PSA_ERROR_NOT_SUPPORTED <code>alg</code> is not supported or is not an AEAD algorithm. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_BUFFER_TOO_SMALL <code>ciphertext_size</code> is too small. <a class="el" href="crypto__sizes_8h.html#a0e0791f41b38a79b1fda63c4cb0eec7a">PSA_AEAD_ENCRYPT_OUTPUT_SIZE()</a> or <a class="el" href="crypto__sizes_8h.html#a627fd15f45e7aab42d0126f1534f24a5">PSA_AEAD_ENCRYPT_OUTPUT_MAX_SIZE()</a> can be used to determine the required buffer size. </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_HARDWARE_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd>
<dd>
PSA_ERROR_BAD_STATE The library has not been previously initialized by <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </dd></dl>

</div>
</div>
<a id="a5497da908443e971fdd60248ad07bdae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5497da908443e971fdd60248ad07bdae">&#9670;&nbsp;</a></span>psa_aead_encrypt_setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_aead_encrypt_setup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">psa_algorithm_t&#160;</td>
          <td class="paramname"><em>alg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the key for a multi-part authenticated encryption operation. </p>
<p>The sequence of operations to encrypt a message with authentication is as follows:</p><ol type="1">
<li>Allocate an operation object which will be passed to all the functions listed here</li>
<li>Initialize the operation object with one of the methods described in the documentation for <a class="el" href="crypto__types_8h.html#a14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a>, e.g. <a class="el" href="crypto__struct_8h.html#af52e036794c0dc6fbadd93a2b990f366">PSA_AEAD_OPERATION_INIT</a>.</li>
<li>Call <a class="el" href="crypto_8h.html#a5497da908443e971fdd60248ad07bdae">psa_aead_encrypt_setup()</a> to specify the algorithm and key.</li>
<li>If needed, call <a class="el" href="crypto_8h.html#ad3431e28d05002c2a7b0760610176050">psa_aead_set_lengths()</a> to specify the length of the inputs to the subsequent calls to <a class="el" href="crypto_8h.html#a6d0eed03f832e5c9c91cb8adf2882569">psa_aead_update_ad()</a> and <a class="el" href="crypto_8h.html#af6d49864951ca42136b4a9b71ea26e5c">psa_aead_update()</a>. See the documentation of <a class="el" href="crypto_8h.html#ad3431e28d05002c2a7b0760610176050">psa_aead_set_lengths()</a> for details.</li>
<li>Call either <a class="el" href="crypto_8h.html#a5799df1c555efd35970b65be51cb07d1">psa_aead_generate_nonce()</a> or <a class="el" href="crypto_8h.html#a59132751a6f843d038924cb217b5e13b">psa_aead_set_nonce()</a> to generate or set the nonce. It is recommended to use <a class="el" href="crypto_8h.html#a5799df1c555efd35970b65be51cb07d1">psa_aead_generate_nonce()</a> unless the protocol being implemented requires a specific nonce value.</li>
<li>Call <a class="el" href="crypto_8h.html#a6d0eed03f832e5c9c91cb8adf2882569">psa_aead_update_ad()</a> zero, one or more times, passing a fragment of the non-encrypted additional authenticated data each time.</li>
<li>Call <a class="el" href="crypto_8h.html#af6d49864951ca42136b4a9b71ea26e5c">psa_aead_update()</a> zero, one or more times, passing a fragment of the message to encrypt each time.</li>
<li>Call <a class="el" href="crypto_8h.html#a759791bbe1763b377c3b5447641f1fc8">psa_aead_finish()</a>.</li>
</ol>
<p>If an error occurs at any step after a call to <a class="el" href="crypto_8h.html#a5497da908443e971fdd60248ad07bdae">psa_aead_encrypt_setup()</a>, the operation will need to be reset by a call to <a class="el" href="crypto_8h.html#ae8a5f93d92318c8f592ee9fbb9d36ba0">psa_aead_abort()</a>. The application can call <a class="el" href="crypto_8h.html#ae8a5f93d92318c8f592ee9fbb9d36ba0">psa_aead_abort()</a> at any time after the operation has been initialized.</p>
<p>After a successful call to <a class="el" href="crypto_8h.html#a5497da908443e971fdd60248ad07bdae">psa_aead_encrypt_setup()</a>, the application must eventually terminate the operation. The following events terminate an operation:</p><ul>
<li>A successful call to <a class="el" href="crypto_8h.html#a759791bbe1763b377c3b5447641f1fc8">psa_aead_finish()</a>.</li>
<li>A call to <a class="el" href="crypto_8h.html#ae8a5f93d92318c8f592ee9fbb9d36ba0">psa_aead_abort()</a>.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>The operation object to set up. It must have been initialized as per the documentation for <a class="el" href="crypto__types_8h.html#a14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> and not yet in use. </td></tr>
    <tr><td class="paramname">key</td><td>Identifier of the key to use for the operation. It must remain valid until the operation terminates. It must allow the usage <a class="el" href="usage_8h.html#a75153b296d045d529d97203a6a995dad">PSA_KEY_USAGE_ENCRYPT</a>. </td></tr>
    <tr><td class="paramname">alg</td><td>The AEAD algorithm to compute (<code>PSA_ALG_XXX</code> value such that <a class="el" href="aead_2algorithm_8h.html#a1d44829d60065eaa4ac9a703e7d6abc8">PSA_ALG_IS_AEAD</a>(<code>alg</code>) is true).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. </dd>
<dd>
PSA_ERROR_BAD_STATE The operation state is not valid: it must be inactive. </dd>
<dd>
PSA_ERROR_INVALID_HANDLE </dd>
<dd>
PSA_ERROR_NOT_PERMITTED The key does not have the <a class="el" href="usage_8h.html#a75153b296d045d529d97203a6a995dad">PSA_KEY_USAGE_ENCRYPT</a> flag, or it does not permit the requested algorithm. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT <code>key</code> is not compatible with <code>alg</code>. </dd>
<dd>
PSA_ERROR_NOT_SUPPORTED <code>alg</code> is not supported or is not an AEAD algorithm. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_HARDWARE_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd>
<dd>
PSA_ERROR_BAD_STATE The library has not been previously initialized by <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </dd></dl>

</div>
</div>
<a id="a759791bbe1763b377c3b5447641f1fc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a759791bbe1763b377c3b5447641f1fc8">&#9670;&nbsp;</a></span>psa_aead_finish()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_aead_finish </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>ciphertext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ciphertext_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>ciphertext_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>tag_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>tag_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finish encrypting a message in an AEAD operation. </p>
<p>The operation must have been set up with <a class="el" href="crypto_8h.html#a5497da908443e971fdd60248ad07bdae">psa_aead_encrypt_setup()</a>. This function finishes the authentication of the additional data formed by concatenating the inputs passed to preceding calls to <a class="el" href="crypto_8h.html#a6d0eed03f832e5c9c91cb8adf2882569">psa_aead_update_ad()</a> with the plaintext formed by concatenating the inputs passed to preceding calls to <a class="el" href="crypto_8h.html#af6d49864951ca42136b4a9b71ea26e5c">psa_aead_update()</a>. This function has two output buffers:</p><ul>
<li><code>ciphertext</code> contains trailing ciphertext that was buffered from preceding calls to <a class="el" href="crypto_8h.html#af6d49864951ca42136b4a9b71ea26e5c">psa_aead_update()</a>.</li>
<li><code>tag</code> contains the authentication tag.</li>
</ul>
<p>When this function returns successfully, the operation becomes inactive. If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="crypto_8h.html#ae8a5f93d92318c8f592ee9fbb9d36ba0">psa_aead_abort()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>Active AEAD operation. </td></tr>
    <tr><td class="paramname">ciphertext</td><td>Buffer where the last part of the ciphertext is to be written. </td></tr>
    <tr><td class="paramname">ciphertext_size</td><td>Size of the ciphertext buffer in bytes. This must be appropriate for the selected algorithm and key:<ul>
<li>A sufficient output size is <a class="el" href="crypto__sizes_8h.html#aeaa3630f4450996638d4c56d651301d3">PSA_AEAD_FINISH_OUTPUT_SIZE</a>( <code>key_type</code>, <code>alg</code>) where <code>key_type</code> is the type of key and <code>alg</code> is the algorithm that were used to set up the operation</li>
<li><a class="el" href="crypto__sizes_8h.html#ae2d44f764023b9e7948af9344ecb66ce">PSA_AEAD_FINISH_OUTPUT_MAX_SIZE</a> evaluates to the maximum output size of any supported AEAD algorithm. </li>
</ul>
</td></tr>
    <tr><td class="paramname">ciphertext_length</td><td>On success, the number of bytes of returned ciphertext. </td></tr>
    <tr><td class="paramname">tag</td><td>Buffer where the authentication tag is to be written. </td></tr>
    <tr><td class="paramname">tag_size</td><td>Size of the tag buffer in bytes. This must be appropriate for the selected algorithm and key:<ul>
<li>The exact tag size is <a class="el" href="crypto__sizes_8h.html#a9aab63d83591633baa13beff3bdf8b2f">PSA_AEAD_TAG_LENGTH</a>(<code>key_type</code>, <code>key_bits</code>, <code>alg</code>) where <code>key_type</code> and <code>key_bits</code> are the type and bit-size of the key, and <code>alg</code> is the algorithm that were used in the call to <a class="el" href="crypto_8h.html#a5497da908443e971fdd60248ad07bdae">psa_aead_encrypt_setup()</a>.</li>
<li><a class="el" href="crypto__sizes_8h.html#ae3b873ea579c278946e6e536b7e513af">PSA_AEAD_TAG_MAX_SIZE</a> evaluates to the maximum tag size of any supported AEAD algorithm. </li>
</ul>
</td></tr>
    <tr><td class="paramname">tag_length</td><td>On success, the number of bytes that make up the returned tag.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. </dd>
<dd>
PSA_ERROR_BAD_STATE The operation state is not valid: it must be an active encryption operation with a nonce set. </dd>
<dd>
PSA_ERROR_BUFFER_TOO_SMALL The size of the ciphertext or tag buffer is too small. <a class="el" href="crypto__sizes_8h.html#aeaa3630f4450996638d4c56d651301d3">PSA_AEAD_FINISH_OUTPUT_SIZE()</a> or <a class="el" href="crypto__sizes_8h.html#ae2d44f764023b9e7948af9344ecb66ce">PSA_AEAD_FINISH_OUTPUT_MAX_SIZE</a> can be used to determine the required ciphertext buffer size. <a class="el" href="crypto__sizes_8h.html#a9aab63d83591633baa13beff3bdf8b2f">PSA_AEAD_TAG_LENGTH()</a> or <a class="el" href="crypto__sizes_8h.html#ae3b873ea579c278946e6e536b7e513af">PSA_AEAD_TAG_MAX_SIZE</a> can be used to determine the required tag buffer size. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The total length of input to <a class="el" href="crypto_8h.html#a6d0eed03f832e5c9c91cb8adf2882569">psa_aead_update_ad()</a> so far is less than the additional data length that was previously specified with <a class="el" href="crypto_8h.html#ad3431e28d05002c2a7b0760610176050">psa_aead_set_lengths()</a> </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The total length of input to <a class="el" href="crypto_8h.html#af6d49864951ca42136b4a9b71ea26e5c">psa_aead_update()</a> so far is less than the plaintext length that was previously specified with <a class="el" href="crypto_8h.html#ad3431e28d05002c2a7b0760610176050">psa_aead_set_lengths()</a>. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_HARDWARE_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd>
<dd>
PSA_ERROR_BAD_STATE The library has not been previously initialized by <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </dd></dl>

</div>
</div>
<a id="a5799df1c555efd35970b65be51cb07d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5799df1c555efd35970b65be51cb07d1">&#9670;&nbsp;</a></span>psa_aead_generate_nonce()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_aead_generate_nonce </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>nonce</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nonce_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>nonce_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate a random nonce for an authenticated encryption operation. </p>
<p>This function generates a random nonce for the authenticated encryption operation with an appropriate size for the chosen algorithm, key type and key size.</p>
<p>The application must call <a class="el" href="crypto_8h.html#a5497da908443e971fdd60248ad07bdae">psa_aead_encrypt_setup()</a> before calling this function. If applicable for the algorithm, the application must call <a class="el" href="crypto_8h.html#ad3431e28d05002c2a7b0760610176050">psa_aead_set_lengths()</a> before calling this function.</p>
<p>If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="crypto_8h.html#ae8a5f93d92318c8f592ee9fbb9d36ba0">psa_aead_abort()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>Active AEAD operation. </td></tr>
    <tr><td class="paramname">nonce</td><td>Buffer where the generated nonce is to be written. </td></tr>
    <tr><td class="paramname">nonce_size</td><td>Size of the nonce buffer in bytes. This must be at least <a class="el" href="crypto__sizes_8h.html#a3dcd505a4e70a63708c05bd8591a4782">PSA_AEAD_NONCE_LENGTH</a>(<code>key_type</code>, <code>alg</code>) where <code>key_type</code> and <code>alg</code> are type of key and the algorithm respectively that were used to set up the AEAD operation. </td></tr>
    <tr><td class="paramname">nonce_length</td><td>On success, the number of bytes of the generated nonce.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. </dd>
<dd>
PSA_ERROR_BAD_STATE The operation state is not valid: it must be an active AEAD encryption operation, with no nonce set. </dd>
<dd>
PSA_ERROR_BAD_STATE The operation state is not valid: this is an algorithm which requires <a class="el" href="crypto_8h.html#ad3431e28d05002c2a7b0760610176050">psa_aead_set_lengths()</a> to be called before setting the nonce. </dd>
<dd>
PSA_ERROR_BUFFER_TOO_SMALL The size of the nonce buffer is too small. <a class="el" href="crypto__sizes_8h.html#a3dcd505a4e70a63708c05bd8591a4782">PSA_AEAD_NONCE_LENGTH()</a> or <a class="el" href="crypto__sizes_8h.html#ac2a332765ba4ccfc24935d6f7f48fcc7">PSA_AEAD_NONCE_MAX_SIZE</a> can be used to determine the required buffer size. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_HARDWARE_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd>
<dd>
PSA_ERROR_BAD_STATE The library has not been previously initialized by <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </dd></dl>

</div>
</div>
<a id="ad3431e28d05002c2a7b0760610176050"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3431e28d05002c2a7b0760610176050">&#9670;&nbsp;</a></span>psa_aead_set_lengths()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_aead_set_lengths </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ad_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>plaintext_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Declare the lengths of the message and additional data for AEAD. </p>
<p>The application must call this function before calling <a class="el" href="crypto_8h.html#a59132751a6f843d038924cb217b5e13b">psa_aead_set_nonce()</a> or <a class="el" href="crypto_8h.html#a5799df1c555efd35970b65be51cb07d1">psa_aead_generate_nonce()</a>, if the algorithm for the operation requires it. If the algorithm does not require it, calling this function is optional, but if this function is called then the implementation must enforce the lengths.</p><ul>
<li>For <a class="el" href="aead_2algorithm_8h.html#ac2c0e7d21f1b2df5e76bcb4a8f84273c">PSA_ALG_CCM</a>, calling this function is required.</li>
<li>For the other AEAD algorithms defined in this specification, calling this function is not required.</li>
<li>For vendor-defined algorithm, refer to the vendor documentation.</li>
</ul>
<p>If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="crypto_8h.html#ae8a5f93d92318c8f592ee9fbb9d36ba0">psa_aead_abort()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>Active AEAD operation. </td></tr>
    <tr><td class="paramname">ad_length</td><td>Size of the non-encrypted additional authenticated data in bytes. </td></tr>
    <tr><td class="paramname">plaintext_length</td><td>Size of the plaintext to encrypt in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. </dd>
<dd>
PSA_ERROR_BAD_STATE The operation state is not valid: it must be active, and <a class="el" href="crypto_8h.html#a59132751a6f843d038924cb217b5e13b">psa_aead_set_nonce()</a> and <a class="el" href="crypto_8h.html#a5799df1c555efd35970b65be51cb07d1">psa_aead_generate_nonce()</a> must not have been called yet. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT At least one of the lengths is not acceptable for the chosen algorithm. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_HARDWARE_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_BAD_STATE The library has not been previously initialized by <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </dd></dl>

</div>
</div>
<a id="a59132751a6f843d038924cb217b5e13b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59132751a6f843d038924cb217b5e13b">&#9670;&nbsp;</a></span>psa_aead_set_nonce()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_aead_set_nonce </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>nonce</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nonce_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the nonce for an authenticated encryption or decryption operation. </p>
<p>This function sets the nonce for the authenticated encryption or decryption operation. The application must call <a class="el" href="crypto_8h.html#a5497da908443e971fdd60248ad07bdae">psa_aead_encrypt_setup()</a> or <a class="el" href="crypto_8h.html#a31af4853ff1f9df38b589f6014e278b8">psa_aead_decrypt_setup()</a> before calling this function. If applicable for the algorithm, the application must call <a class="el" href="crypto_8h.html#ad3431e28d05002c2a7b0760610176050">psa_aead_set_lengths()</a> before calling this function.</p>
<p>If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="crypto_8h.html#ae8a5f93d92318c8f592ee9fbb9d36ba0">psa_aead_abort()</a>.</p>
<dl class="section note"><dt>Note</dt><dd>When encrypting, <a class="el" href="crypto_8h.html#a5799df1c555efd35970b65be51cb07d1">psa_aead_generate_nonce()</a> is recommended instead of using this function, unless implementing a protocol that requires a non-random IV.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>Active AEAD operation. </td></tr>
    <tr><td class="paramname">nonce</td><td>Buffer containing the nonce to use. </td></tr>
    <tr><td class="paramname">nonce_length</td><td>Size of the nonce in bytes. This must be a valid nonce size for the chosen algorithm. The default nonce size is <a class="el" href="crypto__sizes_8h.html#a3dcd505a4e70a63708c05bd8591a4782">PSA_AEAD_NONCE_LENGTH</a> (<code>key_type</code>, <code>alg</code>) where <code>key_type</code> and <code>alg</code> are type of key and the algorithm respectively that were used to set up the AEAD operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. </dd>
<dd>
PSA_ERROR_BAD_STATE The operation state is not valid: it must be an active AEAD encryption operation, with no nonce set. </dd>
<dd>
PSA_ERROR_BAD_STATE The operation state is not valid: this is an algorithm which requires <a class="el" href="crypto_8h.html#ad3431e28d05002c2a7b0760610176050">psa_aead_set_lengths()</a> to be called before setting the nonce. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The size of nonce is not acceptable for the chosen algorithm. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_HARDWARE_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd>
<dd>
PSA_ERROR_BAD_STATE The library has not been previously initialized by <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </dd></dl>

</div>
</div>
<a id="af6d49864951ca42136b4a9b71ea26e5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6d49864951ca42136b4a9b71ea26e5c">&#9670;&nbsp;</a></span>psa_aead_update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_aead_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>input_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>output_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>output_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt or decrypt a message fragment in an active AEAD operation. </p>
<p>The following must occur before calling this function:</p><ol type="1">
<li>Call either <a class="el" href="crypto_8h.html#a5497da908443e971fdd60248ad07bdae">psa_aead_encrypt_setup()</a> or <a class="el" href="crypto_8h.html#a31af4853ff1f9df38b589f6014e278b8">psa_aead_decrypt_setup()</a>. The choice of setup function determines whether this function encrypts or decrypts its input.</li>
<li>Set the nonce with <a class="el" href="crypto_8h.html#a5799df1c555efd35970b65be51cb07d1">psa_aead_generate_nonce()</a> or <a class="el" href="crypto_8h.html#a59132751a6f843d038924cb217b5e13b">psa_aead_set_nonce()</a>.</li>
<li>Call <a class="el" href="crypto_8h.html#a6d0eed03f832e5c9c91cb8adf2882569">psa_aead_update_ad()</a> to pass all the additional data.</li>
</ol>
<p>If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="crypto_8h.html#ae8a5f93d92318c8f592ee9fbb9d36ba0">psa_aead_abort()</a>.</p>
<p>This function does not require the input to be aligned to any particular block boundary. If the implementation can only process a whole block at a time, it must consume all the input provided, but it might delay the end of the corresponding output until a subsequent call to <a class="el" href="crypto_8h.html#af6d49864951ca42136b4a9b71ea26e5c">psa_aead_update()</a>, <a class="el" href="crypto_8h.html#a759791bbe1763b377c3b5447641f1fc8">psa_aead_finish()</a> or <a class="el" href="crypto_8h.html#ae0280e2e61a185b893c36d858453f0d0">psa_aead_verify()</a> provides sufficient input. The amount of data that can be delayed in this way is bounded by <a class="el" href="crypto__sizes_8h.html#a38c502f21653f1b3708ae8897d1bb01d">PSA_AEAD_UPDATE_OUTPUT_SIZE()</a>.</p>
<dl class="section warning"><dt>Warning</dt><dd>When decrypting, do not trust the input until <a class="el" href="crypto_8h.html#ae0280e2e61a185b893c36d858453f0d0">psa_aead_verify()</a> succeeds. See the detailed warning.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>Active AEAD operation. </td></tr>
    <tr><td class="paramname">input</td><td>Buffer containing the message fragment to encrypt or decrypt. </td></tr>
    <tr><td class="paramname">input_length</td><td>Size of the input buffer in bytes. </td></tr>
    <tr><td class="paramname">output</td><td>Buffer where the output is to be written. </td></tr>
    <tr><td class="paramname">output_size</td><td>Size of the output buffer in bytes. This must be appropriate for the selected algorithm and key:<ul>
<li>A sufficient output size is <a class="el" href="crypto__sizes_8h.html#a38c502f21653f1b3708ae8897d1bb01d">PSA_AEAD_UPDATE_OUTPUT_SIZE</a>( <code>key_type</code>, <code>alg</code>, <code>input_length</code>) where <code>key_type</code> is the type of key and <code>alg</code> is the algorithm that were used to set up the operation.</li>
<li><a class="el" href="crypto__sizes_8h.html#a7bad9346cc8ceaffa4a8e7cb8c4fc9ce">PSA_AEAD_UPDATE_OUTPUT_MAX_SIZE</a>(<code>input_length</code>) evaluates to the maximum output size of any supported AEAD algorithm. </li>
</ul>
</td></tr>
    <tr><td class="paramname">output_length</td><td>On success, the number of bytes that make up the returned output.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. </dd>
<dd>
PSA_ERROR_BAD_STATE The operation state is not valid: it must be active, have a nonce set, and have lengths set if required by the algorithm. </dd>
<dd>
PSA_ERROR_BUFFER_TOO_SMALL The size of the output buffer is too small. <a class="el" href="crypto__sizes_8h.html#a38c502f21653f1b3708ae8897d1bb01d">PSA_AEAD_UPDATE_OUTPUT_SIZE()</a> or <a class="el" href="crypto__sizes_8h.html#a7bad9346cc8ceaffa4a8e7cb8c4fc9ce">PSA_AEAD_UPDATE_OUTPUT_MAX_SIZE()</a> can be used to determine the required buffer size. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The total length of input to <a class="el" href="crypto_8h.html#a6d0eed03f832e5c9c91cb8adf2882569">psa_aead_update_ad()</a> so far is less than the additional data length that was previously specified with <a class="el" href="crypto_8h.html#ad3431e28d05002c2a7b0760610176050">psa_aead_set_lengths()</a> </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The total input length overflows the plaintext length that was previously specified with <a class="el" href="crypto_8h.html#ad3431e28d05002c2a7b0760610176050">psa_aead_set_lengths()</a>. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_HARDWARE_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd>
<dd>
PSA_ERROR_BAD_STATE The library has not been previously initialized by <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </dd></dl>

</div>
</div>
<a id="a6d0eed03f832e5c9c91cb8adf2882569"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d0eed03f832e5c9c91cb8adf2882569">&#9670;&nbsp;</a></span>psa_aead_update_ad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_aead_update_ad </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>input_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pass additional data to an active AEAD operation. </p>
<p>Additional data is authenticated, but not encrypted. This function can be called multiple times to pass successive fragments of the additional data. This function must not be called after passing data to encrypt or decrypt with <a class="el" href="crypto_8h.html#af6d49864951ca42136b4a9b71ea26e5c">psa_aead_update()</a>.</p>
<p>The following must occur before calling this function:</p><ol type="1">
<li>Call either <a class="el" href="crypto_8h.html#a5497da908443e971fdd60248ad07bdae">psa_aead_encrypt_setup()</a> or <a class="el" href="crypto_8h.html#a31af4853ff1f9df38b589f6014e278b8">psa_aead_decrypt_setup()</a>.</li>
<li>Set the nonce with <a class="el" href="crypto_8h.html#a5799df1c555efd35970b65be51cb07d1">psa_aead_generate_nonce()</a> or <a class="el" href="crypto_8h.html#a59132751a6f843d038924cb217b5e13b">psa_aead_set_nonce()</a>.</li>
</ol>
<p>If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="crypto_8h.html#ae8a5f93d92318c8f592ee9fbb9d36ba0">psa_aead_abort()</a>.</p>
<dl class="section warning"><dt>Warning</dt><dd>When decrypting, do not trust the input until <a class="el" href="crypto_8h.html#ae0280e2e61a185b893c36d858453f0d0">psa_aead_verify()</a> succeeds. See the detailed warning.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>Active AEAD operation. </td></tr>
    <tr><td class="paramname">input</td><td>Buffer containing the fragment of additional data. </td></tr>
    <tr><td class="paramname">input_length</td><td>Size of the input buffer in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. </dd>
<dd>
PSA_ERROR_BAD_STATE The operation state is not valid: it must be active, have a nonce set, have lengths set if required by the algorithm, and <a class="el" href="crypto_8h.html#af6d49864951ca42136b4a9b71ea26e5c">psa_aead_update()</a> must not have been called yet. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The total input length overflows the additional data length that was previously specified with <a class="el" href="crypto_8h.html#ad3431e28d05002c2a7b0760610176050">psa_aead_set_lengths()</a>. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_HARDWARE_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd>
<dd>
PSA_ERROR_BAD_STATE The library has not been previously initialized by <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </dd></dl>

</div>
</div>
<a id="ae0280e2e61a185b893c36d858453f0d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0280e2e61a185b893c36d858453f0d0">&#9670;&nbsp;</a></span>psa_aead_verify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_aead_verify </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>plaintext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>plaintext_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>plaintext_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>tag_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finish authenticating and decrypting a message in an AEAD operation. </p>
<p>The operation must have been set up with <a class="el" href="crypto_8h.html#a31af4853ff1f9df38b589f6014e278b8">psa_aead_decrypt_setup()</a>. This function finishes the authenticated decryption of the message components:</p><ul>
<li>The additional data consisting of the concatenation of the inputs passed to preceding calls to <a class="el" href="crypto_8h.html#a6d0eed03f832e5c9c91cb8adf2882569">psa_aead_update_ad()</a>.</li>
<li>The ciphertext consisting of the concatenation of the inputs passed to preceding calls to <a class="el" href="crypto_8h.html#af6d49864951ca42136b4a9b71ea26e5c">psa_aead_update()</a>.</li>
<li>The tag passed to this function call.</li>
</ul>
<p>If the authentication tag is correct, this function outputs any remaining plaintext and reports success. If the authentication tag is not correct, this function returns PSA_ERROR_INVALID_SIGNATURE.</p>
<p>When this function returns successfully, the operation becomes inactive. If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="crypto_8h.html#ae8a5f93d92318c8f592ee9fbb9d36ba0">psa_aead_abort()</a>.</p>
<dl class="section note"><dt>Note</dt><dd>Implementations must make the best effort to ensure that the comparison between the actual tag and the expected tag is performed in constant time.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>Active AEAD operation. </td></tr>
    <tr><td class="paramname">plaintext</td><td>Buffer where the last part of the plaintext is to be written. This is the remaining data from previous calls to <a class="el" href="crypto_8h.html#af6d49864951ca42136b4a9b71ea26e5c">psa_aead_update()</a> that could not be processed until the end of the input. </td></tr>
    <tr><td class="paramname">plaintext_size</td><td>Size of the plaintext buffer in bytes. This must be appropriate for the selected algorithm and key:<ul>
<li>A sufficient output size is <a class="el" href="crypto__sizes_8h.html#aeaa3630f4450996638d4c56d651301d3">PSA_AEAD_FINISH_OUTPUT_SIZE</a>( <code>key_type</code>, <code>alg</code>) where <code>key_type</code> is the type of key and <code>alg</code> is the algorithm that were used to set up the operation</li>
<li><a class="el" href="crypto__sizes_8h.html#ae2d44f764023b9e7948af9344ecb66ce">PSA_AEAD_FINISH_OUTPUT_MAX_SIZE</a> evaluates to the maximum output size of any supported AEAD algorithm. </li>
</ul>
</td></tr>
    <tr><td class="paramname">plaintext_length</td><td>On success, the number of bytes of returned plaintext. </td></tr>
    <tr><td class="paramname">tag</td><td>Buffer containing the authentication tag. </td></tr>
    <tr><td class="paramname">tag_length</td><td>Size of the tag buffer in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. </dd>
<dd>
PSA_ERROR_INVALID_SIGNATURE The calculations were successful, but the authentication tag is not correct. </dd>
<dd>
PSA_ERROR_BAD_STATE The operation state is not valid: it must be an active encryption operation with a nonce set. </dd>
<dd>
PSA_ERROR_BUFFER_TOO_SMALL The size of the plaintext buffer is too small. <a class="el" href="crypto__sizes_8h.html#a4ca7886c2fedd17a1327ad90ee1cc480">PSA_AEAD_VERIFY_OUTPUT_SIZE()</a> or <a class="el" href="crypto__sizes_8h.html#a19fc08f5f6f33fd0b91152de1643df0c">PSA_AEAD_VERIFY_OUTPUT_MAX_SIZE</a> can be used to determine the required buffer size. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The total length of input to <a class="el" href="crypto_8h.html#a6d0eed03f832e5c9c91cb8adf2882569">psa_aead_update_ad()</a> so far is less than the additional data length that was previously specified with <a class="el" href="crypto_8h.html#ad3431e28d05002c2a7b0760610176050">psa_aead_set_lengths()</a> </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The total length of input to <a class="el" href="crypto_8h.html#af6d49864951ca42136b4a9b71ea26e5c">psa_aead_update()</a> so far is less than the plaintext length that was previously specified with <a class="el" href="crypto_8h.html#ad3431e28d05002c2a7b0760610176050">psa_aead_set_lengths()</a>. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_HARDWARE_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd>
<dd>
PSA_ERROR_BAD_STATE The library has not been previously initialized by <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </dd></dl>

</div>
</div>
<a id="a19a171d35473710c3b78744713f3fa64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19a171d35473710c3b78744713f3fa64">&#9670;&nbsp;</a></span>psa_asymmetric_decrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_asymmetric_decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">psa_algorithm_t&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>input_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>salt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>salt_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>output_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>output_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypt a short message with a private key. </p>
<p>For <a class="el" href="asymmetric__encryption_2algorithm_8h.html#a4c540d3abe43fb9abcb94f2bc51acef9">PSA_ALG_RSA_PKCS1V15_CRYPT</a>, no salt is supported.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Identifier of the key to use for the operation. It must be an asymmetric key pair. It must allow the usage <a class="el" href="usage_8h.html#ac3f2d2e5983db1edde9f142ca9bf8e6a">PSA_KEY_USAGE_DECRYPT</a>. </td></tr>
    <tr><td class="paramname">alg</td><td>An asymmetric encryption algorithm that is compatible with the type of key. </td></tr>
    <tr><td class="paramname">input</td><td>The message to decrypt. </td></tr>
    <tr><td class="paramname">input_length</td><td>Size of the input buffer in bytes. </td></tr>
    <tr><td class="paramname">salt</td><td>A salt or label, if supported by the encryption algorithm. If the algorithm does not support a salt, pass <code>NULL</code>. If the algorithm supports an optional salt, pass <code>NULL</code> to indicate that there is no salt. </td></tr>
    <tr><td class="paramname">salt_length</td><td>Size of the salt buffer in bytes. If salt is <code>NULL</code>, pass 0. </td></tr>
    <tr><td class="paramname">output</td><td>Buffer where the decrypted message is to be written. </td></tr>
    <tr><td class="paramname">output_size</td><td>Size of the output buffer in bytes. This must be appropriate for the selected algorithm and key:<ul>
<li>The required output size is <a class="el" href="crypto__sizes_8h.html#a61a246f3eac41989821d982e56fea6c1">PSA_ASYMMETRIC_DECRYPT_OUTPUT_SIZE</a> (<code>key_type</code>, <code>key_bits</code>, <code>alg</code>) where <code>key_type</code> and <code>key_bits</code> are the type and bit-size respectively of key.</li>
<li><a class="el" href="crypto__sizes_8h.html#a4b1576b11393e43831232cac4bf75f0c">PSA_ASYMMETRIC_DECRYPT_OUTPUT_MAX_SIZE</a> evaluates to the maximum output size of any supported asymmetric decryption. </li>
</ul>
</td></tr>
    <tr><td class="paramname">output_length</td><td>On success, the number of bytes that make up the returned output.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS </dd>
<dd>
PSA_ERROR_INVALID_HANDLE </dd>
<dd>
PSA_ERROR_NOT_PERMITTED The key does not have the <a class="el" href="usage_8h.html#ac3f2d2e5983db1edde9f142ca9bf8e6a">PSA_KEY_USAGE_DECRYPT</a> flag, or it does not permit the requested algorithm. </dd>
<dd>
PSA_ERROR_BUFFER_TOO_SMALL The size of the output buffer is too small. <a class="el" href="crypto__sizes_8h.html#a61a246f3eac41989821d982e56fea6c1">PSA_ASYMMETRIC_DECRYPT_OUTPUT_SIZE()</a> or <a class="el" href="crypto__sizes_8h.html#a4b1576b11393e43831232cac4bf75f0c">PSA_ASYMMETRIC_DECRYPT_OUTPUT_MAX_SIZE</a> can be used to determine the required buffer size. </dd>
<dd>
PSA_ERROR_NOT_SUPPORTED </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_HARDWARE_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd>
<dd>
PSA_ERROR_INSUFFICIENT_ENTROPY </dd>
<dd>
PSA_ERROR_INVALID_PADDING </dd>
<dd>
PSA_ERROR_BAD_STATE The library has not been previously initialized by <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </dd></dl>

</div>
</div>
<a id="a29f79a5294e91c320ba69c1956ccf506"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29f79a5294e91c320ba69c1956ccf506">&#9670;&nbsp;</a></span>psa_asymmetric_encrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_asymmetric_encrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">psa_algorithm_t&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>input_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>salt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>salt_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>output_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>output_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt a short message with a public key. </p>
<p>For <a class="el" href="asymmetric__encryption_2algorithm_8h.html#a4c540d3abe43fb9abcb94f2bc51acef9">PSA_ALG_RSA_PKCS1V15_CRYPT</a>, no salt is supported.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Identifier of the key to use for the operation. It must be a public key or an asymmetric key pair. It must allow the usage <a class="el" href="usage_8h.html#a75153b296d045d529d97203a6a995dad">PSA_KEY_USAGE_ENCRYPT</a>. </td></tr>
    <tr><td class="paramname">alg</td><td>An asymmetric encryption algorithm that is compatible with the type of key. </td></tr>
    <tr><td class="paramname">input</td><td>The message to encrypt. </td></tr>
    <tr><td class="paramname">input_length</td><td>Size of the input buffer in bytes. </td></tr>
    <tr><td class="paramname">salt</td><td>A salt or label, if supported by the encryption algorithm. If the algorithm does not support a salt, pass <code>NULL</code>. If the algorithm supports an optional salt, pass <code>NULL</code> to indicate that there is no salt. </td></tr>
    <tr><td class="paramname">salt_length</td><td>Size of the salt buffer in bytes. If salt is <code>NULL</code>, pass 0. </td></tr>
    <tr><td class="paramname">output</td><td>Buffer where the encrypted message is to be written. </td></tr>
    <tr><td class="paramname">output_size</td><td>Size of the output buffer in bytes. This must be appropriate for the selected algorithm and key:<ul>
<li>The required output size is <a class="el" href="crypto__sizes_8h.html#a66ba3bd93e5ec52870ccc3848778bad8">PSA_ASYMMETRIC_ENCRYPT_OUTPUT_SIZE</a> (<code>key_type</code>, <code>key_bits</code>, <code>alg</code>) where <code>key_type</code> and <code>key_bits</code> are the type and bit-size respectively of key</li>
<li><a class="el" href="crypto__sizes_8h.html#a1a04450654b66dd9ac2fafb9b5413ae3">PSA_ASYMMETRIC_ENCRYPT_OUTPUT_MAX_SIZE</a> evaluates to the maximum output size of any supported asymmetric encryption. </li>
</ul>
</td></tr>
    <tr><td class="paramname">output_length</td><td>On success, the number of bytes that make up the returned output.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS </dd>
<dd>
PSA_ERROR_INVALID_HANDLE </dd>
<dd>
PSA_ERROR_NOT_PERMITTED The key does not have the <a class="el" href="usage_8h.html#a75153b296d045d529d97203a6a995dad">PSA_KEY_USAGE_ENCRYPT</a> flag, or it does not permit the requested algorithm. </dd>
<dd>
PSA_ERROR_BUFFER_TOO_SMALL The size of the output buffer is too small. <a class="el" href="crypto__sizes_8h.html#a66ba3bd93e5ec52870ccc3848778bad8">PSA_ASYMMETRIC_ENCRYPT_OUTPUT_SIZE()</a> or <a class="el" href="crypto__sizes_8h.html#a1a04450654b66dd9ac2fafb9b5413ae3">PSA_ASYMMETRIC_ENCRYPT_OUTPUT_MAX_SIZE</a> can be used to determine the required buffer size. </dd>
<dd>
PSA_ERROR_NOT_SUPPORTED </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_HARDWARE_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd>
<dd>
PSA_ERROR_INSUFFICIENT_ENTROPY </dd>
<dd>
PSA_ERROR_BAD_STATE The library has not been previously initialized by <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </dd></dl>

</div>
</div>
<a id="a5ad52722505e0c0b3ffca6c9cd8ac5c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ad52722505e0c0b3ffca6c9cd8ac5c2">&#9670;&nbsp;</a></span>psa_builtin_generate_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_builtin_generate_key </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *&#160;</td>
          <td class="paramname"><em>attributes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>key_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>key_buffer_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>key_buffer_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Built-in key generation function. </p>
<p>This function generates a random symmetric key. As of yet it does not implement asymmetric key generation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">attributes</td><td></td></tr>
    <tr><td class="paramname">key_buffer</td><td></td></tr>
    <tr><td class="paramname">key_buffer_size</td><td></td></tr>
    <tr><td class="paramname">key_buffer_length</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>psa_status_t </dd></dl>

</div>
</div>
<a id="a8f55697f068cf08fe5a7b90757aadaa9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f55697f068cf08fe5a7b90757aadaa9">&#9670;&nbsp;</a></span>psa_builtin_generate_random()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_builtin_generate_random </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>output_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Built-in function for random number generation. </p>
<p>This function is being used to generate a random number if no other driver for random number generation is present. It uses the RIOT RNG module as a default backend.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">output</td><td>Output buffer of the size of the random number to be generated. </td></tr>
    <tr><td class="paramname">output_size</td><td>Size of <code>output</code> in bytes</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT <code>output</code> is NULL </dd></dl>

</div>
</div>
<a id="ac123bb75392c062756f95328c240854d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac123bb75392c062756f95328c240854d">&#9670;&nbsp;</a></span>psa_builtin_import_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_builtin_import_key </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *&#160;</td>
          <td class="paramname"><em>attributes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>key_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>key_buffer_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>key_buffer_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>bits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Built-in key import function. </p>
<p>Copies a plain key into local memory. This function is used by the implementation, when an imported key is stored only in local memory.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">attributes</td><td>The attributes for the new key. This function uses the attributes as follows:<ul>
<li>The key type is required, and determines how the data buffer is interpreted.</li>
<li>The key size is always determined from the data buffer. If the key size in attributes is nonzero, it must be equal to the size determined from data.</li>
<li>The key permitted-algorithm policy is required for keys that will be used for a cryptographic operation, see Permitted algorithms.</li>
<li>The key usage flags define what operations are permitted with the key, see Key usage flags.</li>
<li>The key lifetime and identifier are required for a persistent key. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This is an input parameter: it is not updated with the final key attributes. The final attributes of the new key can be queried by calling <a class="el" href="crypto_8h.html#a8e70d36a3db2ec34425722166f5fa75b">psa_get_key_attributes()</a> with the keys identifier. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>Buffer containing the key data. The content of this buffer is interpreted according to the type declared in attributes. All implementations must support at least the format described in the documentation of <a class="el" href="crypto_8h.html#a5f2f7c851186c5d1d928be0b6020225c">psa_export_key()</a> or <a class="el" href="crypto_8h.html#a76970efac4f9418a03bf59dc345eaf88">psa_export_public_key()</a> for the chosen type. Implementations can support other formats, but be conservative in interpreting the key data: it is recommended that implementations reject content if it might be erroneous, for example, if it is the wrong type or is truncated. </td></tr>
    <tr><td class="paramname">data_length</td><td>Size of the data buffer in bytes. </td></tr>
    <tr><td class="paramname">key_buffer</td><td>Pointer to buffer containing the plain text key material </td></tr>
    <tr><td class="paramname">key_buffer_size</td><td>Size of <code>key_buffer</code> in bytes </td></tr>
    <tr><td class="paramname">key_buffer_length</td><td>Size of the key buffer </td></tr>
    <tr><td class="paramname">bits</td><td>Size of the key in bits</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. If the key is persistent, the key material and the keys metadata have been saved to persistent storage. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The following conditions can result in this error:<ul>
<li>The key size is nonzero, and is incompatible with the key data in <code>data</code>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_NOT_SUPPORTED The key attributes, as a whole, are not supported, either by the implementation in general or in the specified storage location. </dd></dl>

</div>
</div>
<a id="aad482cdca2098bca0620596aaa02eaa4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad482cdca2098bca0620596aaa02eaa4">&#9670;&nbsp;</a></span>psa_cipher_abort()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_cipher_abort </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a1399de29db657e3737bb09927aae51fa">psa_cipher_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Abort a cipher operation. </p>
<p>Aborting an operation frees all associated resources except for the operation object itself. Once aborted, the operation object can be reused for another operation by calling <a class="el" href="crypto_8h.html#ac696b9ac87eac90d25e08e34d040ff72">psa_cipher_encrypt_setup()</a> or <a class="el" href="crypto_8h.html#a9ea37677a0e9152ff712d2ea0f3096ad">psa_cipher_decrypt_setup()</a> again.</p>
<p>This function can be called any time after the operation object has been initialized as described in <a class="el" href="crypto__types_8h.html#a1399de29db657e3737bb09927aae51fa">psa_cipher_operation_t</a>.</p>
<p>In particular, calling <a class="el" href="crypto_8h.html#aad482cdca2098bca0620596aaa02eaa4">psa_cipher_abort()</a> after the operation has been terminated by a call to <a class="el" href="crypto_8h.html#aad482cdca2098bca0620596aaa02eaa4">psa_cipher_abort()</a> or <a class="el" href="crypto_8h.html#a1dcb58b8befe23f8a4d7a1d49c99249b">psa_cipher_finish()</a> is safe and has no effect.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>Initialized cipher operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. The operation object can now be discarded or reused. </dd>
<dd>
PSA_ERROR_BAD_STATE The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd></dl>

</div>
</div>
<a id="a31dd2b33667e1a4aebd4789d789c9c55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31dd2b33667e1a4aebd4789d789c9c55">&#9670;&nbsp;</a></span>psa_cipher_decrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_cipher_decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">psa_algorithm_t&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>input_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>output_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>output_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypt a message using a symmetric cipher. </p>
<p>This function decrypts a message encrypted with a symmetric cipher. * The input to this function must contain the IV followed by the ciphertext, as output by <a class="el" href="crypto_8h.html#a0ba1e627bd194914ef9297212dd423f9">psa_cipher_encrypt()</a>. The IV must be <a class="el" href="crypto__sizes_8h.html#adaeef0383905487313ccbfaf1b73c95e">PSA_CIPHER_IV_LENGTH</a>(<code>key_type</code>, <code>alg</code>) bytes in length, where <code>key_type</code> is the type of key.</p>
<p>Use the multi-part operation interface with a <a class="el" href="crypto__types_8h.html#a1399de29db657e3737bb09927aae51fa">psa_cipher_operation_t</a> object to decrypt data which is not in the expected input format.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Identifier of the key to use for the operation. It must remain valid until the operation terminates. It must allow the usage <a class="el" href="usage_8h.html#ac3f2d2e5983db1edde9f142ca9bf8e6a">PSA_KEY_USAGE_DECRYPT</a>. </td></tr>
    <tr><td class="paramname">alg</td><td>The cipher algorithm to compute: a value of type psa_algorithm_t such that <a class="el" href="cipher_2algorithm_8h.html#a1d1a5a402ad89a2e68f12bfb535490eb">PSA_ALG_IS_CIPHER</a>(<code>alg</code>) is true. </td></tr>
    <tr><td class="paramname">input</td><td>Buffer containing the message to decrypt. This consists of the IV followed by the ciphertext proper. </td></tr>
    <tr><td class="paramname">input_length</td><td>Size of the input buffer in bytes. </td></tr>
    <tr><td class="paramname">output</td><td>Buffer where the plaintext is to be written. </td></tr>
    <tr><td class="paramname">output_size</td><td>Size of the output buffer in bytes. This must be appropriate for the selected algorithm and key:<ul>
<li>A sufficient output size is <a class="el" href="crypto__sizes_8h.html#a413e5c78d89d0f7a4ccdb047e7238125">PSA_CIPHER_DECRYPT_OUTPUT_SIZE</a>( <code>key_type</code>, <code>alg</code>, <code>input_length</code>) where <code>key_type</code> is the type of key.</li>
<li><a class="el" href="crypto__sizes_8h.html#afbcce9b24605d70ead18d9c6de6a5ac7">PSA_CIPHER_DECRYPT_OUTPUT_MAX_SIZE</a>(<code>input_length</code>) evaluates to the maximum output size of any supported cipher decryption. </li>
</ul>
</td></tr>
    <tr><td class="paramname">output_length</td><td>On success, the number of bytes that make up the output.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. The first <code></code>(*output_length) bytes of <code>output</code> contain the plaintext. </dd>
<dd>
PSA_ERROR_BAD_STATE The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </dd>
<dd>
PSA_ERROR_INVALID_HANDLE <code>key</code> is not a valid key identifier. </dd>
<dd>
PSA_ERROR_NOT_PERMITTED The key does not have the <a class="el" href="usage_8h.html#ac3f2d2e5983db1edde9f142ca9bf8e6a">PSA_KEY_USAGE_DECRYPT</a> flag, or it does not permit the requested algorithm. </dd>
<dd>
PSA_ERROR_BUFFER_TOO_SMALL The size of the output buffer is too small. <a class="el" href="crypto__sizes_8h.html#a413e5c78d89d0f7a4ccdb047e7238125">PSA_CIPHER_DECRYPT_OUTPUT_SIZE()</a> or <a class="el" href="crypto__sizes_8h.html#afbcce9b24605d70ead18d9c6de6a5ac7">PSA_CIPHER_DECRYPT_OUTPUT_MAX_SIZE()</a> can be used to determine a sufficient buffer size. </dd>
<dd>
PSA_ERROR_INVALID_PADDING The algorithm uses padding, and the input does not contain valid padding. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The following conditions can result in this error:<ul>
<li><code>alg</code> is not a cipher algorithm.</li>
<li><code>key</code> is not compatible with alg.</li>
<li>The input_length is not valid for the algorithm and key type. For example, the algorithm is a based on block cipher and requires a whole number of blocks, but the total input size is not a multiple of the block size. </li>
</ul>
</dd>
<dd>
PSA_ERROR_NOT_SUPPORTED The following conditions can result in this error:<ul>
<li><code>alg</code> is not supported or is not a cipher algorithm.</li>
<li><code>key</code> is not supported for use with alg.</li>
<li><code>input_length</code> is too large for the implementation. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="a9ea37677a0e9152ff712d2ea0f3096ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ea37677a0e9152ff712d2ea0f3096ad">&#9670;&nbsp;</a></span>psa_cipher_decrypt_setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_cipher_decrypt_setup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a1399de29db657e3737bb09927aae51fa">psa_cipher_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">psa_algorithm_t&#160;</td>
          <td class="paramname"><em>alg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the key for a multi-part symmetric decryption operation. </p>
<p>The sequence of operations to decrypt a message with a symmetric cipher is as follows:</p><ol type="1">
<li>Allocate an operation object which will be passed to all the functions listed here.</li>
<li>Initialize the operation object with one of the methods described in the documentation for <a class="el" href="crypto__types_8h.html#a1399de29db657e3737bb09927aae51fa">psa_cipher_operation_t</a>, e.g. <a class="el" href="crypto__struct_8h.html#a2da0541aabf9a4995cf2004e36311919">PSA_CIPHER_OPERATION_INIT</a>.</li>
<li>Call <a class="el" href="crypto_8h.html#a9ea37677a0e9152ff712d2ea0f3096ad">psa_cipher_decrypt_setup()</a> to specify the algorithm and key.</li>
<li>Call <a class="el" href="crypto_8h.html#a9caddac1a429a5032d6d4a907fb70ba1">psa_cipher_set_iv()</a> with the initialization vector (IV) for the decryption, if the algorithm requires one. This must match the IV used for the encryption.</li>
<li>Call <a class="el" href="crypto_8h.html#ac3ca27ac6682917c48247d01fd96cd0f">psa_cipher_update()</a> zero, one or more times, passing a fragment of the message each time.</li>
<li>Call <a class="el" href="crypto_8h.html#a1dcb58b8befe23f8a4d7a1d49c99249b">psa_cipher_finish()</a>.</li>
</ol>
<p>If an error occurs at any step after a call to <a class="el" href="crypto_8h.html#a9ea37677a0e9152ff712d2ea0f3096ad">psa_cipher_decrypt_setup()</a>, the operation will need to be reset by a call to <a class="el" href="crypto_8h.html#aad482cdca2098bca0620596aaa02eaa4">psa_cipher_abort()</a>. The application can call <a class="el" href="crypto_8h.html#aad482cdca2098bca0620596aaa02eaa4">psa_cipher_abort()</a> at any time after the operation has been initialized.</p>
<p>After a successful call to <a class="el" href="crypto_8h.html#a9ea37677a0e9152ff712d2ea0f3096ad">psa_cipher_decrypt_setup()</a>, the application must eventually terminate the operation. The following events terminate an operation:</p><ul>
<li>A successful call to <a class="el" href="crypto_8h.html#a1dcb58b8befe23f8a4d7a1d49c99249b">psa_cipher_finish()</a>.</li>
<li>A call to <a class="el" href="crypto_8h.html#aad482cdca2098bca0620596aaa02eaa4">psa_cipher_abort()</a>.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>The operation object to set up. It must have been initialized as per the documentation for <a class="el" href="crypto__types_8h.html#a1399de29db657e3737bb09927aae51fa">psa_cipher_operation_t</a> and not yet in use. </td></tr>
    <tr><td class="paramname">key</td><td>Identifier of the key to use for the operation. It must remain valid until the operation terminates. It must allow the usage <a class="el" href="usage_8h.html#ac3f2d2e5983db1edde9f142ca9bf8e6a">PSA_KEY_USAGE_DECRYPT</a>. </td></tr>
    <tr><td class="paramname">alg</td><td>The cipher algorithm to compute: a value of type psa_algorithm_t such that <a class="el" href="cipher_2algorithm_8h.html#a1d1a5a402ad89a2e68f12bfb535490eb">PSA_ALG_IS_CIPHER</a>(<code>alg</code>) is true.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. </dd>
<dd>
PSA_ERROR_BAD_STATE The following conditions can result in this error:<ul>
<li>The operation state is not valid: it must be inactive.</li>
<li>The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INVALID_HANDLE <code>key</code> is not a valid key identifier. </dd>
<dd>
PSA_ERROR_NOT_PERMITTED The key does not have the <a class="el" href="usage_8h.html#ac3f2d2e5983db1edde9f142ca9bf8e6a">PSA_KEY_USAGE_DECRYPT</a> flag, or it does not permit the requested algorithm. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The following conditions can result in this error:<ul>
<li><code>alg</code> is not a cipher algorithm.</li>
<li><code>key</code> is not compatible with alg. </li>
</ul>
</dd>
<dd>
PSA_ERROR_NOT_SUPPORTED The following conditions can result in this error:<ul>
<li><code>alg</code> is not supported or is not a cipher algorithm.</li>
<li><code>key</code> is not supported for use with alg. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="a0ba1e627bd194914ef9297212dd423f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ba1e627bd194914ef9297212dd423f9">&#9670;&nbsp;</a></span>psa_cipher_encrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_cipher_encrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">psa_algorithm_t&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>input_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>output_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>output_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt a message using a symmetric cipher. </p>
<p>This function encrypts a message with a random initialization vector (IV). The length of the IV is <a class="el" href="crypto__sizes_8h.html#adaeef0383905487313ccbfaf1b73c95e">PSA_CIPHER_IV_LENGTH</a>(<code>key_type</code>, <code>alg</code>) where <code>key_type</code> is the type of key. The output of <a class="el" href="crypto_8h.html#a0ba1e627bd194914ef9297212dd423f9">psa_cipher_encrypt()</a> is the IV followed by the ciphertext.</p>
<p>Use the multi-part operation interface with a <a class="el" href="crypto__types_8h.html#a1399de29db657e3737bb09927aae51fa">psa_cipher_operation_t</a> object to provide other forms of IV or to manage the IV and ciphertext independently.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Identifier of the key to use for the operation. It must allow the usage <a class="el" href="usage_8h.html#a75153b296d045d529d97203a6a995dad">PSA_KEY_USAGE_ENCRYPT</a>. </td></tr>
    <tr><td class="paramname">alg</td><td>The cipher algorithm to compute (<code>PSA_ALG_XXX</code> value such that <a class="el" href="cipher_2algorithm_8h.html#a1d1a5a402ad89a2e68f12bfb535490eb">PSA_ALG_IS_CIPHER</a>(<code>alg</code>) is true). </td></tr>
    <tr><td class="paramname">input</td><td>Buffer containing the message to encrypt. </td></tr>
    <tr><td class="paramname">input_length</td><td>Size of the input buffer in bytes. </td></tr>
    <tr><td class="paramname">output</td><td>Buffer where the output is to be written. The output contains the IV followed by the ciphertext proper. </td></tr>
    <tr><td class="paramname">output_size</td><td>Size of the output buffer in bytes. This must be appropriate for the selected algorithm and key:<ul>
<li>A sufficient output size is <a class="el" href="crypto__sizes_8h.html#ada02457bee639a10a0c3ddbe1f73fedc">PSA_CIPHER_ENCRYPT_OUTPUT_SIZE</a>( <code>key_type</code>, <code>alg</code>, <code>input_length</code>) where <code>key_type</code> is the type of key</li>
<li><a class="el" href="crypto__sizes_8h.html#a745c06526e5e062a9caf45e6f111f67d">PSA_CIPHER_ENCRYPT_OUTPUT_MAX_SIZE</a>(<code>input_length</code>) evaluates to the maximum output size of any supported cipher encryption. </li>
</ul>
</td></tr>
    <tr><td class="paramname">output_length</td><td>On success, the number of bytes that make up the output.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. </dd>
<dd>
PSA_ERROR_INVALID_HANDLE </dd>
<dd>
PSA_ERROR_NOT_PERMITTED The key does not have the <a class="el" href="usage_8h.html#a75153b296d045d529d97203a6a995dad">PSA_KEY_USAGE_ENCRYPT</a> flag, or it does not permit the requested algorithm. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT <code>key</code> is not compatible with alg. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The <code>input_length</code> is not valid for the algorithm and key type. For example, the algorithm is a based on block cipher and requires a whole number of blocks, but the total input size is not a multiple of the block size. </dd>
<dd>
PSA_ERROR_NOT_SUPPORTED <code>alg</code> is not supported or is not a cipher algorithm. </dd>
<dd>
PSA_ERROR_BUFFER_TOO_SMALL <code>output_size</code> is too small. <a class="el" href="crypto__sizes_8h.html#ada02457bee639a10a0c3ddbe1f73fedc">PSA_CIPHER_ENCRYPT_OUTPUT_SIZE()</a> or <a class="el" href="crypto__sizes_8h.html#a745c06526e5e062a9caf45e6f111f67d">PSA_CIPHER_ENCRYPT_OUTPUT_MAX_SIZE()</a> can be used to determine the required buffer size. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_HARDWARE_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd>
<dd>
PSA_ERROR_BAD_STATE The library has not been previously initialized by <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </dd></dl>

</div>
</div>
<a id="ac696b9ac87eac90d25e08e34d040ff72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac696b9ac87eac90d25e08e34d040ff72">&#9670;&nbsp;</a></span>psa_cipher_encrypt_setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_cipher_encrypt_setup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a1399de29db657e3737bb09927aae51fa">psa_cipher_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">psa_algorithm_t&#160;</td>
          <td class="paramname"><em>alg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the key for a multi-part symmetric encryption operation. </p>
<p>The sequence of operations to encrypt a message with a symmetric cipher is as follows:</p><ol type="1">
<li>Allocate an operation object which will be passed to all the functions listed here.</li>
<li>Initialize the operation object with one of the methods described in the documentation for <a class="el" href="crypto__types_8h.html#a1399de29db657e3737bb09927aae51fa">psa_cipher_operation_t</a>, e.g. <a class="el" href="crypto__struct_8h.html#a2da0541aabf9a4995cf2004e36311919">PSA_CIPHER_OPERATION_INIT</a>.</li>
<li>Call <a class="el" href="crypto_8h.html#ac696b9ac87eac90d25e08e34d040ff72">psa_cipher_encrypt_setup()</a> to specify the algorithm and key.</li>
<li>Call either <a class="el" href="crypto_8h.html#a29fd7d32a5729226a2f73e7b6487bd8a">psa_cipher_generate_iv()</a> or <a class="el" href="crypto_8h.html#a9caddac1a429a5032d6d4a907fb70ba1">psa_cipher_set_iv()</a> to generate or set the initialization vector (IV), if the algorithm requires one. It is recommended to use <a class="el" href="crypto_8h.html#a29fd7d32a5729226a2f73e7b6487bd8a">psa_cipher_generate_iv()</a> unless the protocol being implemented requires a specific IV value.</li>
<li>Call <a class="el" href="crypto_8h.html#ac3ca27ac6682917c48247d01fd96cd0f">psa_cipher_update()</a> zero, one or more times, passing a fragment of the message each time.</li>
<li>Call <a class="el" href="crypto_8h.html#a1dcb58b8befe23f8a4d7a1d49c99249b">psa_cipher_finish()</a>.</li>
</ol>
<p>If an error occurs at any step after a call to <a class="el" href="crypto_8h.html#ac696b9ac87eac90d25e08e34d040ff72">psa_cipher_encrypt_setup()</a>, the operation will need to be reset by a call to <a class="el" href="crypto_8h.html#aad482cdca2098bca0620596aaa02eaa4">psa_cipher_abort()</a>. The application can call <a class="el" href="crypto_8h.html#aad482cdca2098bca0620596aaa02eaa4">psa_cipher_abort()</a> at any time after the operation has been initialized.</p>
<p>After a successful call to <a class="el" href="crypto_8h.html#ac696b9ac87eac90d25e08e34d040ff72">psa_cipher_encrypt_setup()</a>, the application must eventually terminate the operation. The following events terminate an operation:</p><ul>
<li>A successful call to <a class="el" href="crypto_8h.html#a1dcb58b8befe23f8a4d7a1d49c99249b">psa_cipher_finish()</a>.</li>
<li>A call to <a class="el" href="crypto_8h.html#aad482cdca2098bca0620596aaa02eaa4">psa_cipher_abort()</a>.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>The operation object to set up. It must have been initialized as per the documentation for <a class="el" href="crypto__types_8h.html#a1399de29db657e3737bb09927aae51fa">psa_cipher_operation_t</a> and not yet in use. </td></tr>
    <tr><td class="paramname">key</td><td>Identifier of the key to use for the operation. It must remain valid until the operation terminates. It must allow the usage <a class="el" href="usage_8h.html#a75153b296d045d529d97203a6a995dad">PSA_KEY_USAGE_ENCRYPT</a>. </td></tr>
    <tr><td class="paramname">alg</td><td>The cipher algorithm to compute: a value of type psa_algorithm_t such that <a class="el" href="cipher_2algorithm_8h.html#a1d1a5a402ad89a2e68f12bfb535490eb">PSA_ALG_IS_CIPHER</a>(<code>alg</code>) is true.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. </dd>
<dd>
PSA_ERROR_BAD_STATE The following conditions can result in this error:<ul>
<li>The operation state is not valid: it must be inactive.</li>
<li>The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INVALID_HANDLE <code>key</code> is not a valid key identifier. </dd>
<dd>
PSA_ERROR_NOT_PERMITTED The key does not have the <a class="el" href="usage_8h.html#a75153b296d045d529d97203a6a995dad">PSA_KEY_USAGE_ENCRYPT</a> flag, or it does not permit the requested algorithm. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The following conditions can result in this error:<ul>
<li><code>alg</code> is not a cipher algorithm.</li>
<li><code>key</code> is not compatible with alg. </li>
</ul>
</dd>
<dd>
PSA_ERROR_NOT_SUPPORTED The following conditions can result in this error:<ul>
<li><code>alg</code> is not supported or is not a cipher algorithm.</li>
<li><code>key</code> is not supported for use with <code>alg</code>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="a1dcb58b8befe23f8a4d7a1d49c99249b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dcb58b8befe23f8a4d7a1d49c99249b">&#9670;&nbsp;</a></span>psa_cipher_finish()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_cipher_finish </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a1399de29db657e3737bb09927aae51fa">psa_cipher_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>output_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>output_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finish encrypting or decrypting a message in a cipher operation. </p>
<p>The application must call <a class="el" href="crypto_8h.html#ac696b9ac87eac90d25e08e34d040ff72">psa_cipher_encrypt_setup()</a> or <a class="el" href="crypto_8h.html#a9ea37677a0e9152ff712d2ea0f3096ad">psa_cipher_decrypt_setup()</a> before calling this function. The choice of setup function determines whether this function encrypts or decrypts its input.</p>
<p>This function finishes the encryption or decryption of the message formed by concatenating the inputs passed to preceding calls to <a class="el" href="crypto_8h.html#ac3ca27ac6682917c48247d01fd96cd0f">psa_cipher_update()</a>.</p>
<p>When this function returns successfully, the operation becomes inactive. If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="crypto_8h.html#aad482cdca2098bca0620596aaa02eaa4">psa_cipher_abort()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>Active cipher operation. </td></tr>
    <tr><td class="paramname">output</td><td>Buffer where the output is to be written. </td></tr>
    <tr><td class="paramname">output_size</td><td>Size of the output buffer in bytes. This must be appropriate for the selected algorithm and key:<ul>
<li>A sufficient output size is <a class="el" href="crypto__sizes_8h.html#a2d9422f5ca18e6025d41134fe883d697">PSA_CIPHER_FINISH_OUTPUT_SIZE</a>( <code>key_type</code>, <code>alg</code>) where <code>key_type</code> is the type of key and <code>alg</code> is the algorithm that were used to set up the operation.</li>
<li><a class="el" href="crypto__sizes_8h.html#ac7980b0ebf97b171493560b06c51e8f5">PSA_CIPHER_FINISH_OUTPUT_MAX_SIZE</a> evaluates to the maximum output size of any supported cipher algorithm. </li>
</ul>
</td></tr>
    <tr><td class="paramname">output_length</td><td>On success, the number of bytes that make up the returned output.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. The first <code></code>(*output_length) bytes of <code>output</code> contain the final output. </dd>
<dd>
PSA_ERROR_BAD_STATE The following conditions can result in this error:<ul>
<li>The operation state is not valid: it must be active, with an IV set if required for the algorithm.</li>
<li>The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_BUFFER_TOO_SMALL The size of the output buffer is too small. <a class="el" href="crypto__sizes_8h.html#a2d9422f5ca18e6025d41134fe883d697">PSA_CIPHER_FINISH_OUTPUT_SIZE()</a> or <a class="el" href="crypto__sizes_8h.html#ac7980b0ebf97b171493560b06c51e8f5">PSA_CIPHER_FINISH_OUTPUT_MAX_SIZE</a> can be used to determine a sufficient buffer size. </dd>
<dd>
PSA_ERROR_INVALID_PADDING This is a decryption operation for an algorithm that includes padding, and the ciphertext does not contain valid padding. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The total input size passed to this operation is not valid for this particular algorithm. For example, the algorithm is a based on block cipher and requires a whole number of blocks, but the total input size is not a multiple of the block size. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="a29fd7d32a5729226a2f73e7b6487bd8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29fd7d32a5729226a2f73e7b6487bd8a">&#9670;&nbsp;</a></span>psa_cipher_generate_iv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_cipher_generate_iv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a1399de29db657e3737bb09927aae51fa">psa_cipher_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>iv_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>iv_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate an initialization vector (IV) for a symmetric encryption operation. </p>
<p>This function generates a random IV, nonce or initial counter value for the encryption operation as appropriate for the chosen algorithm, key type and key size.</p>
<p>The generated IV is always the default length for the key and algorithm: <a class="el" href="crypto__sizes_8h.html#adaeef0383905487313ccbfaf1b73c95e">PSA_CIPHER_IV_LENGTH</a>(<code>key_type</code>, <code>alg</code>), where <code>key_type</code> is the type of key and <code>alg</code> is the algorithm that were used to set up the operation. To generate different lengths of IV, use <a class="el" href="crypto_8h.html#a1985eae417dfbccedf50d5fff54ea8c5">psa_generate_random()</a> and <a class="el" href="crypto_8h.html#a9caddac1a429a5032d6d4a907fb70ba1">psa_cipher_set_iv()</a>.</p>
<p>If the cipher algorithm does not use an IV, calling this function returns a PSA_ERROR_BAD_STATE error. For these algorithms, <a class="el" href="crypto__sizes_8h.html#adaeef0383905487313ccbfaf1b73c95e">PSA_CIPHER_IV_LENGTH</a>( <code>key_type</code>, <code>alg</code>) will be zero.</p>
<p>The application must call <a class="el" href="crypto_8h.html#ac696b9ac87eac90d25e08e34d040ff72">psa_cipher_encrypt_setup()</a> before calling this function.</p>
<p>If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="crypto_8h.html#aad482cdca2098bca0620596aaa02eaa4">psa_cipher_abort()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>Active cipher operation. </td></tr>
    <tr><td class="paramname">iv</td><td>Buffer where the generated IV is to be written. </td></tr>
    <tr><td class="paramname">iv_size</td><td>Size of the iv buffer in bytes. This must be at least <a class="el" href="crypto__sizes_8h.html#adaeef0383905487313ccbfaf1b73c95e">PSA_CIPHER_IV_LENGTH</a>(<code>key_type</code>, <code>alg</code>) where <code>key_type</code> and <code>alg</code> are type of key and the algorithm respectively that were used to set up the cipher operation. </td></tr>
    <tr><td class="paramname">iv_length</td><td>On success, the number of bytes of the generated IV.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. </dd>
<dd>
PSA_ERROR_BAD_STATE Either:<ul>
<li>The cipher algorithm does not use an IV.</li>
<li>The operation state is not valid: it must be active, with no IV set. </li>
</ul>
</dd>
<dd>
PSA_ERROR_BUFFER_TOO_SMALL The size of the iv buffer is too small. <a class="el" href="crypto__sizes_8h.html#adaeef0383905487313ccbfaf1b73c95e">PSA_CIPHER_IV_LENGTH()</a> or <a class="el" href="crypto__sizes_8h.html#ad5630c60148421b334b1bb3962bd4f86">PSA_CIPHER_IV_MAX_SIZE</a> can be used to determine the required buffer size. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_HARDWARE_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd>
<dd>
PSA_ERROR_BAD_STATE The library has not been previously initialized by <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </dd></dl>

</div>
</div>
<a id="a9caddac1a429a5032d6d4a907fb70ba1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9caddac1a429a5032d6d4a907fb70ba1">&#9670;&nbsp;</a></span>psa_cipher_set_iv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_cipher_set_iv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a1399de29db657e3737bb09927aae51fa">psa_cipher_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>iv_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the initialization vector (IV) for a symmetric encryption or decryption operation. </p>
<p>This function sets the IV, nonce or initial counter value for the encryption or decryption operation.</p>
<p>If the cipher algorithm does not use an IV, calling this function returns a PSA_ERROR_BAD_STATE error. For these algorithms, <a class="el" href="crypto__sizes_8h.html#adaeef0383905487313ccbfaf1b73c95e">PSA_CIPHER_IV_LENGTH(key_type, alg)</a> will be zero.</p>
<p>The application must call <a class="el" href="crypto_8h.html#ac696b9ac87eac90d25e08e34d040ff72">psa_cipher_encrypt_setup()</a> or <a class="el" href="crypto_8h.html#a9ea37677a0e9152ff712d2ea0f3096ad">psa_cipher_decrypt_setup()</a> before calling this function.</p>
<p>If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="crypto_8h.html#aad482cdca2098bca0620596aaa02eaa4">psa_cipher_abort()</a>.</p>
<dl class="section note"><dt>Note</dt><dd>When encrypting, <a class="el" href="crypto_8h.html#a29fd7d32a5729226a2f73e7b6487bd8a">psa_cipher_generate_iv()</a> is recommended instead of using this function, unless implementing a protocol that requires a non-random IV.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>Active cipher operation. </td></tr>
    <tr><td class="paramname">iv</td><td>Buffer containing the IV to use. </td></tr>
    <tr><td class="paramname">iv_length</td><td>Size of the IV in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. </dd>
<dd>
PSA_ERROR_BAD_STATE The following conditions can result in this error:<ul>
<li>The cipher algorithm does not use an IV.</li>
<li>The operation state is not valid: it must be an active cipher encrypt operation, with no IV set.</li>
<li>The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The following conditions can result in this error:<ul>
<li>The chosen algorithm does not use an IV.</li>
<li><code>iv_length</code> is not valid for the chosen algorithm. </li>
</ul>
</dd>
<dd>
PSA_ERROR_NOT_SUPPORTED <code>iv_length</code> is not supported for use with the operations algorithm and key. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="ac3ca27ac6682917c48247d01fd96cd0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3ca27ac6682917c48247d01fd96cd0f">&#9670;&nbsp;</a></span>psa_cipher_update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_cipher_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a1399de29db657e3737bb09927aae51fa">psa_cipher_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>input_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>output_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>output_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt or decrypt a message fragment in an active cipher operation. </p>
<p>The following must occur before calling this function:</p><ol type="1">
<li>Call either <a class="el" href="crypto_8h.html#ac696b9ac87eac90d25e08e34d040ff72">psa_cipher_encrypt_setup()</a> or <a class="el" href="crypto_8h.html#a9ea37677a0e9152ff712d2ea0f3096ad">psa_cipher_decrypt_setup()</a>. The choice of setup function determines whether this function encrypts or decrypts its input.</li>
<li>If the algorithm requires an IV, call <a class="el" href="crypto_8h.html#a29fd7d32a5729226a2f73e7b6487bd8a">psa_cipher_generate_iv()</a> or <a class="el" href="crypto_8h.html#a9caddac1a429a5032d6d4a907fb70ba1">psa_cipher_set_iv()</a>. <a class="el" href="crypto_8h.html#a29fd7d32a5729226a2f73e7b6487bd8a">psa_cipher_generate_iv()</a> is recommended when encrypting.</li>
</ol>
<p>If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="crypto_8h.html#aad482cdca2098bca0620596aaa02eaa4">psa_cipher_abort()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>Active cipher operation. </td></tr>
    <tr><td class="paramname">input</td><td>Buffer containing the message fragment to encrypt or decrypt. </td></tr>
    <tr><td class="paramname">input_length</td><td>Size of the <code>input</code> buffer in bytes. </td></tr>
    <tr><td class="paramname">output</td><td>Buffer where the output is to be written. </td></tr>
    <tr><td class="paramname">output_size</td><td>Size of the output buffer in bytes. This must be appropriate for the selected algorithm and key:<ul>
<li>A sufficient output size is <a class="el" href="crypto__sizes_8h.html#acf11f477f1a0f57e3258bc345e9198bc">PSA_CIPHER_UPDATE_OUTPUT_SIZE</a>( <code>key_type</code>, <code>alg</code>, <code>input_length</code>) where <code>key_type</code> is the type of key and <code>alg</code> is the algorithm that were used to set up the operation.</li>
<li><a class="el" href="crypto__sizes_8h.html#ab1f6598efd6a7dc56e7ad7e34719eb32">PSA_CIPHER_UPDATE_OUTPUT_MAX_SIZE</a>(<code>input_length</code>) evaluates to the maximum output size of any supported cipher algorithm. </li>
</ul>
</td></tr>
    <tr><td class="paramname">output_length</td><td>On success, the number of bytes that make up the returned output.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. The first <code></code>(*output_length) bytes of <code>output</code> contain the output data. </dd>
<dd>
PSA_ERROR_BAD_STATE The following conditions can result in this error:<ul>
<li>The operation state is not valid: it must be active, with an IV set if required for the algorithm.</li>
<li>The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_BUFFER_TOO_SMALL The size of the output buffer is too small. <a class="el" href="crypto__sizes_8h.html#acf11f477f1a0f57e3258bc345e9198bc">PSA_CIPHER_UPDATE_OUTPUT_SIZE()</a> or <a class="el" href="crypto__sizes_8h.html#ab1f6598efd6a7dc56e7ad7e34719eb32">PSA_CIPHER_UPDATE_OUTPUT_MAX_SIZE()</a> can be used to determine a sufficient buffer size. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The total input size passed to this operation is too large for this particular algorithm. </dd>
<dd>
PSA_ERROR_NOT_SUPPORTED The total input size passed to this operation is too large for the implementation. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="a78da90274bd8f8680017a4bb513803a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78da90274bd8f8680017a4bb513803a1">&#9670;&nbsp;</a></span>psa_copy_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_copy_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>source_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *&#160;</td>
          <td class="paramname"><em>attributes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> *&#160;</td>
          <td class="paramname"><em>target_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make a copy of a key. </p>
<p>Copy key material from one location to another. * This function is primarily useful to copy a key from one location to another, as it populates a key using the material from another key which can have a different lifetime.</p>
<p>This function can be used to share a key with a different party, subject to implementation-defined restrictions on key sharing.</p>
<p>The policy on the source key must have the usage flag <a class="el" href="usage_8h.html#a4605d686020a6cb433c5d78bf7e91689">PSA_KEY_USAGE_COPY</a> set. This flag is sufficient to permit the copy if the key has the lifetime <a class="el" href="lifetime_8h.html#a8b438870ba69489b685730d346455108">PSA_KEY_LIFETIME_VOLATILE</a> or <a class="el" href="lifetime_8h.html#a3713a01c5fcd5f7eae46ff22ceaf6d02">PSA_KEY_LIFETIME_PERSISTENT</a>. Some secure elements do not provide a way to copy a key without making it extractable from the secure element. If a key is located in such a secure element, then the key must have both usage flags <a class="el" href="usage_8h.html#a4605d686020a6cb433c5d78bf7e91689">PSA_KEY_USAGE_COPY</a> and <a class="el" href="usage_8h.html#a7dddccdd1303176e87a4d20c87b589ed">PSA_KEY_USAGE_EXPORT</a> in order to make a copy of the key outside the secure element.</p>
<p>The resulting key can only be used in a way that conforms to both the policy of the original key and the policy specified in the attributes parameter:</p><ul>
<li>The usage flags on the resulting key are the bitwise-and of the usage flags on the source policy and the usage flags in attributes.</li>
<li>If both permit the same algorithm or wildcard-based algorithm, the resulting key has the same permitted algorithm.</li>
<li>If either of the policies permits an algorithm and the other policy allows a wildcard-based permitted algorithm that includes this algorithm, the resulting key uses this permitted algorithm.</li>
<li>If the policies do not permit any algorithm in common, this function fails with the status PSA_ERROR_INVALID_ARGUMENT.</li>
</ul>
<p>The effect of this function on implementation-defined attributes is implementation-defined.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">source_key</td><td>The key to copy. It must allow the usage <a class="el" href="usage_8h.html#a4605d686020a6cb433c5d78bf7e91689">PSA_KEY_USAGE_COPY</a>. If a private or secret key is being copied outside of a secure element it must also allow <a class="el" href="usage_8h.html#a7dddccdd1303176e87a4d20c87b589ed">PSA_KEY_USAGE_EXPORT</a>. </td></tr>
    <tr><td class="paramname">attributes</td><td>The attributes for the new key. This function uses the attributes as follows:<ul>
<li>The key type and size can be 0. If either is nonzero, it must match the corresponding attribute of the source key.</li>
<li>The key location (the lifetime and, for persistent keys, the key identifier) is used directly.</li>
<li>The key policy (usage flags and permitted algorithm) are combined from the source key and attributes so that both sets of restrictions apply, as described in the documentation of this function. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This is an input parameter: it is not updated with the final key attributes. The final attributes of the new key can be queried by calling <a class="el" href="crypto_8h.html#a8e70d36a3db2ec34425722166f5fa75b">psa_get_key_attributes()</a> with the keys identifier. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">target_key</td><td>On success, an identifier for the newly created key. <a class="el" href="id_8h.html#a650b5f7c553bf6f8db2076dbd9f4dd44">PSA_KEY_ID_NULL</a> on failure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. If the new key is persistent, the key material and the keys metadata have been saved to persistent storage. </dd>
<dd>
PSA_ERROR_BAD_STATE The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </dd>
<dd>
PSA_ERROR_INVALID_HANDLE <code>source_key</code> is not a valid key identifier. </dd>
<dd>
PSA_ERROR_NOT_PERMITTED The following conditions can result in this error:<ul>
<li><code>source_key</code> does not have the <a class="el" href="usage_8h.html#a4605d686020a6cb433c5d78bf7e91689">PSA_KEY_USAGE_COPY</a> usage flag.</li>
<li><code>source_key</code> does not have the <a class="el" href="usage_8h.html#a7dddccdd1303176e87a4d20c87b589ed">PSA_KEY_USAGE_EXPORT</a> usage flag, and its storage location does not allow copying it to the target keys storage location.</li>
<li><code>The</code> implementation does not permit creating a key with the specified attributes due to some implementation-specific policy. </li>
</ul>
</dd>
<dd>
PSA_ERROR_ALREADY_EXISTS This is an attempt to create a persistent key, and there is already a persistent key with the given identifier. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The following conditions can result in this error:<ul>
<li><code>attributes</code> specifies a key type or key size which does not match the attributes of <code>source_key</code>.</li>
<li>The lifetime or identifier in <code>attributes</code> are invalid.</li>
<li>The key policies from <code>source_key</code> and those specified in <code>attributes</code> are incompatible. </li>
</ul>
</dd>
<dd>
PSA_ERROR_NOT_SUPPORTED The following conditions can result in this error:<ul>
<li>The <code>source_key</code> storage location does not support copying to the target keys storage location.</li>
<li>The key attributes, as a whole, are not supported in the target keys storage location. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_INSUFFICIENT_STORAGE </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="a2de150803fc2f7dc6101d5af7e921dd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2de150803fc2f7dc6101d5af7e921dd9">&#9670;&nbsp;</a></span>psa_crypto_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_crypto_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Library initialization. </p>
<p>Applications must call this function before calling any other function in this module. Applications are permitted to call this function more than once. Once a call succeeds, subsequent calls are guaranteed to succeed.</p>
<p>If the application calls other functions before calling <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>, the behavior is undefined. In this situation:</p><ul>
<li>Implementations are encouraged to either perform the operation as if the library had been initialized or to return PSA_ERROR_BAD_STATE or some other applicable error.</li>
<li>Implementations must not return a success status if the lack of initialization might have security implications, for example due to improper seeding of the random number generator.</li>
</ul>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_HARDWARE_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_INSUFFICIENT_ENTROPY </dd></dl>

</div>
</div>
<a id="af503cd251eff1a0d6cd7d8e47003b92e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af503cd251eff1a0d6cd7d8e47003b92e">&#9670;&nbsp;</a></span>psa_destroy_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_destroy_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroy a key. </p>
<p>This function destroys a key from both volatile memory and, if applicable, non-volatile storage. Implementations must make a best effort to ensure that that the key material cannot be recovered.</p>
<p>This function also erases any metadata such as policies and frees resources associated with the key. Destroying the key makes the key identifier invalid, and the key identifier must not be used again by the application.</p>
<p>If a key is currently in use in a multi-part operation, then destroying the key will cause the multi-part operation to fail.</p>
<dl class="section warning"><dt>Warning</dt><dd>This implementation uses a virtual file system for storing and reading persistent keys to and from flash. Destroying a key only unlinks the file and does not erase the actual key data from flash. Anyone with hardware access can still recover the key material.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Identifier of the key to erase. If this is <a class="el" href="id_8h.html#a650b5f7c553bf6f8db2076dbd9f4dd44">PSA_KEY_ID_NULL</a>, do nothing and return PSA_SUCCESS.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. If <code>key</code> was a valid key identifier, then the key material that it referred to has been erased. Alternatively, <code>key</code> was <a class="el" href="id_8h.html#a650b5f7c553bf6f8db2076dbd9f4dd44">PSA_KEY_ID_NULL</a>. </dd>
<dd>
PSA_ERROR_BAD_STATE The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </dd>
<dd>
PSA_ERROR_INVALID_HANDLE <code>key</code> is neither a valid key identifier, nor <a class="el" href="id_8h.html#a650b5f7c553bf6f8db2076dbd9f4dd44">PSA_KEY_ID_NULL</a>. </dd>
<dd>
PSA_ERROR_NOT_PERMITTED The key cannot be erased because it is read-only, either due to a policy or due to physical restrictions. </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE There was an failure in communication with the cryptoprocessor. The key material might still be present in the cryptoprocessor. </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED An unexpected condition which is not a storage corruption or a communication failure occurred. The cryptoprocessor might have been compromised. </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE The storage operation failed. Implementations must make a best effort to erase key material even in this situation, however, it might be impossible to guarantee that the key material is not recoverable in such cases. </dd>
<dd>
PSA_ERROR_DATA_CORRUPT The storage is corrupted. Implementations must make a best effort to erase key material even in this situation, however, it might be impossible to guarantee that the key material is not recoverable in such cases. </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="a5f2f7c851186c5d1d928be0b6020225c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f2f7c851186c5d1d928be0b6020225c">&#9670;&nbsp;</a></span>psa_export_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_export_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>data_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>data_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Export a key in binary format. </p>
<p>The output of this function can be passed to <a class="el" href="crypto_8h.html#ad088d8ebc854d2f7a5b5c1769bc9ed40">psa_import_key()</a> to create an equivalent object.</p>
<p>If the implementation of <a class="el" href="crypto_8h.html#ad088d8ebc854d2f7a5b5c1769bc9ed40">psa_import_key()</a> supports other formats beyond the format specified here, the output from <a class="el" href="crypto_8h.html#a5f2f7c851186c5d1d928be0b6020225c">psa_export_key()</a> must use the representation specified here, not the original representation.</p>
<p>For standard key types, the output format is as follows:</p><ul>
<li>For symmetric keys, excluding HMAC keys, the format is the raw bytes of the key.</li>
<li>For HMAC keys that are shorter than, or equal in size to, the underlying hash algorithm block size, the format is the raw bytes of the key.</li>
<li>For HMAC keys that are longer than the underlying hash algorithm block size, the format is an implementation defined choice between the following formats:<ul>
<li>The raw bytes of the key.</li>
<li>The raw bytes of the hash of the key, using the underlying hash algorithm. See also <a class="el" href="psa__crypto_2psa_2key_2type_8h.html#a92d989f4ca64abd00f463defd773a6f8">PSA_KEY_TYPE_HMAC</a>.</li>
</ul>
</li>
<li>For DES, the key data consists of 8 bytes. The parity bits must be correct.</li>
<li>For Triple-DES, the format is the concatenation of the two or three DES keys.</li>
<li>For RSA key pairs, with key type <a class="el" href="psa__crypto_2psa_2key_2type_8h.html#a11745b110166e927e2abeabc7d532051">PSA_KEY_TYPE_RSA_KEY_PAIR</a>, the format is the non-encrypted DER encoding of the representation defined by in PKCS #1: RSA Cryptography Specifications Version 2.2 [RFC8017] as RSAPrivateKey, version 0. <div class="fragment"><div class="line">RSAPrivateKey ::= SEQUENCE {</div><div class="line">    version             INTEGER,  -- must be 0</div><div class="line">    modulus             INTEGER,  -- n</div><div class="line">    publicExponent      INTEGER,  -- e</div><div class="line">    privateExponent     INTEGER,  -- d</div><div class="line">    prime1              INTEGER,  -- p</div><div class="line">    prime2              INTEGER,  -- q</div><div class="line">    exponent1           INTEGER,  -- d mod (p-1)</div><div class="line">    exponent2           INTEGER,  -- d mod (q-1)</div><div class="line">    coefficient         INTEGER,  -- (inverse of q) mod p</div><div class="line">}</div></div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>Although it is possible to define an RSA key pair or private key using a subset of these elements, the output from <a class="el" href="crypto_8h.html#a5f2f7c851186c5d1d928be0b6020225c">psa_export_key()</a> for an RSA key pair must include all of these elements.</dd></dl>
</li>
<li>For elliptic curve key pairs, with key types for which PSA_KEY_TYPE_IS_ECC_KEY_PAIR () is true, the format is a representation of the private value.<ul>
<li>For Weierstrass curve families <code>PSA_ECC_FAMILY_SECT_XX</code>, <code>PSA_ECC_FAMILY_SECP_XX</code>, <a class="el" href="psa__crypto_2psa_2key_2type_8h.html#aaf7310c0eaed708f3199796d95b70633">PSA_ECC_FAMILY_FRP</a> and <a class="el" href="psa__crypto_2psa_2key_2type_8h.html#ac1643f1baf38b30d07c20a6eac697f15">PSA_ECC_FAMILY_BRAINPOOL_P_R1</a>, the content of the <code>privateKey</code> field of the <code>ECPrivateKey</code> format defined by Elliptic Curve Private Key Structure [RFC5915]. This is a <code>ceiling</code>(m/8)-byte string in big-endian order where <code>m</code> is the key size in bits.</li>
<li>For curve family <a class="el" href="psa__crypto_2psa_2key_2type_8h.html#a1f624c5cdaf25b21287af33024e1aff8">PSA_ECC_FAMILY_MONTGOMERY</a>, the scalar value of the private key in little-endian order as defined by Elliptic Curves for Security [RFC7748] 6. The value must have the forced bits set to zero or one as specified by <code>decodeScalar25519()</code> and <code>decodeScalar448()</code> in [RFC7748] 5. This is a <code>ceiling</code>(m/8)-byte string where <code>m</code> is the key size in bits. This is 32 bytes for Curve25519, and 56 bytes for Curve448.</li>
<li>For the Twisted Edwards curve family <a class="el" href="psa__crypto_2psa_2key_2type_8h.html#afe45f9fe29699f26795f6251f47eafd4">PSA_ECC_FAMILY_TWISTED_EDWARDS</a>, the private key is defined by Edwards-Curve Digital Signature Algorithm (EdDSA) [RFC8032]. This is a 32-byte string for Edwards25519, and a 57-byte string for Edwards448.</li>
</ul>
</li>
<li>For Diffie-Hellman key exchange key pairs, with key types for which <a class="el" href="psa__crypto_2psa_2key_2type_8h.html#abb9dd614786fe328df4e485c1a61ed25">PSA_KEY_TYPE_IS_DH_KEY_PAIR()</a> is true, the format is the representation of the private key x as a big-endian byte string. The length of the byte string is the private key size in bytes, and leading zeroes are not stripped.</li>
<li>For public keys, with key types for which <a class="el" href="psa__crypto_2psa_2key_2type_8h.html#ac674a0f059bc0cb72b47f0c517b4f45b">PSA_KEY_TYPE_IS_PUBLIC_KEY()</a> is true, the format is the same as for <a class="el" href="crypto_8h.html#a76970efac4f9418a03bf59dc345eaf88">psa_export_public_key()</a>.</li>
</ul>
<p>The policy on the key must have the usage flag <a class="el" href="usage_8h.html#a7dddccdd1303176e87a4d20c87b589ed">PSA_KEY_USAGE_EXPORT</a> set.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Identifier of the key to export. It must allow the usage <a class="el" href="usage_8h.html#a7dddccdd1303176e87a4d20c87b589ed">PSA_KEY_USAGE_EXPORT</a>, unless it is a public key. </td></tr>
    <tr><td class="paramname">data</td><td>Buffer where the key data is to be written. </td></tr>
    <tr><td class="paramname">data_size</td><td>Size of the data buffer in bytes. This must be appropriate for the key:<ul>
<li>The required output size is <a class="el" href="crypto__sizes_8h.html#a2e3ff71b9f4e639c03c9e55c7774dc51">PSA_EXPORT_KEY_OUTPUT_SIZE</a>(<code>type</code>, <code>bits</code>) where <code>type</code> is the key type and <code>bits</code> is the key size in bits.</li>
<li><a class="el" href="crypto__sizes_8h.html#a5aa21302f87f1e932c9a1daa092df7db">PSA_EXPORT_KEY_PAIR_MAX_SIZE</a> evaluates to the maximum output size of any supported key pair.</li>
<li><a class="el" href="crypto__sizes_8h.html#ad4463cb6edc2061338a88d1adc92b94c">PSA_EXPORT_PUBLIC_KEY_MAX_SIZE</a> evaluates to the maximum output size of any supported public key.</li>
<li>This API defines no maximum size for symmetric keys. Arbitrarily large data items can be stored in the key store, for example certificates that correspond to a stored private key or input material for key derivation. </li>
</ul>
</td></tr>
    <tr><td class="paramname">data_length</td><td>On success, the number of bytes that make up the key data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. The first <code></code>(*data_length) bytes of data contain the exported key </dd>
<dd>
PSA_ERROR_BAD_STATE The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </dd>
<dd>
PSA_ERROR_INVALID_HANDLE <code>key</code> is not a valid key identifier. </dd>
<dd>
PSA_ERROR_NOT_PERMITTED The key does not have the <a class="el" href="usage_8h.html#a7dddccdd1303176e87a4d20c87b589ed">PSA_KEY_USAGE_EXPORT</a> flag. </dd>
<dd>
PSA_ERROR_BUFFER_TOO_SMALL The size of the data buffer is too small. <a class="el" href="crypto__sizes_8h.html#a2e3ff71b9f4e639c03c9e55c7774dc51">PSA_EXPORT_KEY_OUTPUT_SIZE()</a> or <a class="el" href="crypto__sizes_8h.html#a5aa21302f87f1e932c9a1daa092df7db">PSA_EXPORT_KEY_PAIR_MAX_SIZE</a> can be used to determine a sufficient buffer size. </dd>
<dd>
PSA_ERROR_NOT_SUPPORTED The following conditions can result in this error:<ul>
<li>The keys storage location does not support export of the key</li>
<li>The implementation does not support export of keys with this key type. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="a76970efac4f9418a03bf59dc345eaf88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76970efac4f9418a03bf59dc345eaf88">&#9670;&nbsp;</a></span>psa_export_public_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_export_public_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>data_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>data_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Export a public key or the public part of a key pair in binary format. </p>
<p>The output of this function can be passed to <a class="el" href="crypto_8h.html#ad088d8ebc854d2f7a5b5c1769bc9ed40">psa_import_key()</a> to create an object that is equivalent to the public key.</p>
<p>If the implementation of <a class="el" href="crypto_8h.html#ad088d8ebc854d2f7a5b5c1769bc9ed40">psa_import_key()</a> supports other formats beyond the format specified here, the output from <a class="el" href="crypto_8h.html#a76970efac4f9418a03bf59dc345eaf88">psa_export_public_key()</a> must use the representation specified here, not the original representation.</p>
<p>For standard key types, the output format is as follows:</p><ul>
<li>For RSA public keys, with key type <a class="el" href="psa__crypto_2psa_2key_2type_8h.html#a9ba0878f56c8bcd1995ac017a74f513b">PSA_KEY_TYPE_RSA_PUBLIC_KEY</a>, the DER encoding of the representation defined by Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile [RFC3279] 2.3.1 as <code>RSAPublicKey</code>. <div class="fragment"><div class="line">RSAPublicKey ::= SEQUENCE {</div><div class="line">    modulus            INTEGER,    -- n</div><div class="line">    publicExponent     INTEGER  }  -- e</div></div><!-- fragment --></li>
<li>For elliptic curve key pairs, with key types for which <a class="el" href="psa__crypto_2psa_2key_2type_8h.html#a5af146a173b0c84d7e737e2fb6a3c0a7">PSA_KEY_TYPE_IS_ECC_PUBLIC_KEY()</a> is true, the format depends on the key family:<ul>
<li>For Weierstrass curve families <code>PSA_ECC_FAMILY_SECT_XX</code>, <code>PSA_ECC_FAMILY_SECP_XX</code>, <a class="el" href="psa__crypto_2psa_2key_2type_8h.html#aaf7310c0eaed708f3199796d95b70633">PSA_ECC_FAMILY_FRP</a> and <a class="el" href="psa__crypto_2psa_2key_2type_8h.html#ac1643f1baf38b30d07c20a6eac697f15">PSA_ECC_FAMILY_BRAINPOOL_P_R1</a>, the uncompressed representation of an elliptic curve point as an octet string defined in SEC 1: Elliptic Curve Cryptography [SEC1] 2.3.3. If <code>m</code> is the bit size associated with the curve, i.e. the bit size of <code>q</code> for a curve over <code>F_q</code>. The representation consists of:<ul>
<li>The byte <code>0x04</code>;</li>
<li><code>x_P</code> as a <code>ceiling</code>(m/8)-byte string, big-endian;</li>
<li><code>y_P</code> as a <code>ceiling</code>(m/8)-byte string, big-endian.</li>
</ul>
</li>
<li>For curve family <a class="el" href="psa__crypto_2psa_2key_2type_8h.html#a1f624c5cdaf25b21287af33024e1aff8">PSA_ECC_FAMILY_MONTGOMERY</a>, the scalar value of the public key in little-endian order as defined by Elliptic Curves for Security [RFC7748] 6. This is a <code>ceiling</code>(m/8)-byte string where <code>m</code> is the key size in bits.<ul>
<li>This is 32 bytes for Curve25519, computed as <code>X25519(private_key, 9)</code>.</li>
<li>This is 56 bytes for Curve448, computed as <code>X448(private_key, 5)</code>.</li>
</ul>
</li>
<li>For curve family <a class="el" href="psa__crypto_2psa_2key_2type_8h.html#afe45f9fe29699f26795f6251f47eafd4">PSA_ECC_FAMILY_TWISTED_EDWARDS</a>, the public key is defined by Edwards-Curve Digital Signature Algorithm (EdDSA) [RFC8032]. This is a 32-byte string for Edwards25519, and a 57-byte string for Edwards448.</li>
</ul>
</li>
<li>For Diffie-Hellman key exchange public keys, with key types for which <a class="el" href="psa__crypto_2psa_2key_2type_8h.html#a23627e047fa4b536f07d6f4796f879f5">PSA_KEY_TYPE_IS_DH_PUBLIC_KEY</a> is true, the format is the representation of the public key <code>y = g^x mod p</code> as a big-endian byte string. The length of the byte string is the length of the base prime p in bytes. Exporting a public key object or the public part of a key pair is always permitted, regardless of the keys usage flags.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Identifier of the key to export. </td></tr>
    <tr><td class="paramname">data</td><td>Buffer where the key data is to be written. </td></tr>
    <tr><td class="paramname">data_size</td><td>Size of the <code>data</code> buffer in bytes. This must be appropriate for the key:<ul>
<li>The required output size is <a class="el" href="crypto__sizes_8h.html#adf475af5fd8eae67bc9cf524d38209f2">PSA_EXPORT_PUBLIC_KEY_OUTPUT_SIZE</a>( <code>type</code>, <code>bits</code>) where <code>type</code> is the key type and <code>bits</code> is the key size in bits.</li>
<li><a class="el" href="crypto__sizes_8h.html#ad4463cb6edc2061338a88d1adc92b94c">PSA_EXPORT_PUBLIC_KEY_MAX_SIZE</a> evaluates to the maximum output size of any supported public key or public part of a key pair. </li>
</ul>
</td></tr>
    <tr><td class="paramname">data_length</td><td>On success, the number of bytes that make up the key data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. The first <code></code>(*data_length) bytes of <code>data</code> contain the exported public key. </dd>
<dd>
PSA_ERROR_BAD_STATE The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </dd>
<dd>
PSA_ERROR_INVALID_HANDLE <code>key</code> is not a valid key identifier. </dd>
<dd>
PSA_ERROR_BUFFER_TOO_SMALL The size of the data buffer is too small. <a class="el" href="crypto__sizes_8h.html#adf475af5fd8eae67bc9cf524d38209f2">PSA_EXPORT_PUBLIC_KEY_OUTPUT_SIZE()</a> or <a class="el" href="crypto__sizes_8h.html#ad4463cb6edc2061338a88d1adc92b94c">PSA_EXPORT_PUBLIC_KEY_MAX_SIZE</a> can be used to determine a sufficient buffer size. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The key is neither a public key nor a key pair. </dd>
<dd>
PSA_ERROR_NOT_SUPPORTED The following conditions can result in this error:<ul>
<li>The keys storage location does not support export of the key.</li>
<li>The implementation does not support export of keys with this key type. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="a950b4199ae7a0164006bd3d6927d1efe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a950b4199ae7a0164006bd3d6927d1efe">&#9670;&nbsp;</a></span>psa_generate_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_generate_key </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *&#160;</td>
          <td class="paramname"><em>attributes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate a key or key pair. </p>
<p>The key is generated randomly. Its location, policy, type and size are taken from <code>attributes</code>.</p>
<p>Implementations must reject an attempt to generate a key of size 0.</p>
<p>The following type-specific considerations apply:</p><ul>
<li>For RSA keys (<a class="el" href="psa__crypto_2psa_2key_2type_8h.html#a11745b110166e927e2abeabc7d532051">PSA_KEY_TYPE_RSA_KEY_PAIR</a>), the public exponent is 65537. The modulus is a product of two probabilistic primes between 2^{n-1} and 2^n where n is the bit size specified in the attributes.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">attributes</td><td>The attributes for the new key. This function uses the attributes as follows:<ul>
<li>The key type is required. It cannot be an asymmetric public key.</li>
<li>The key size is required. It must be a valid size for the key type.</li>
<li>The key permitted-algorithm policy is required for keys that will be used for a cryptographic operation, see Permitted algorithms.</li>
<li>The key usage flags define what operations are permitted with the key, see Key usage flags.</li>
<li>The key lifetime and identifier are required for a persistent key. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This is an input parameter: it is not updated with the final key attributes. The final attributes of the new key can be queried by calling <a class="el" href="crypto_8h.html#a8e70d36a3db2ec34425722166f5fa75b">psa_get_key_attributes()</a> with the keys identifier. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>On success, an identifier for the newly created key. <a class="el" href="id_8h.html#a650b5f7c553bf6f8db2076dbd9f4dd44">PSA_KEY_ID_NULL</a> on failure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. If the key is persistent, the key material and the keys metadata have been saved to persistent storage. </dd>
<dd>
PSA_ERROR_ALREADY_EXISTS This is an attempt to create a persistent key, and there is already a persistent key with the given identifier. </dd>
<dd>
PSA_ERROR_NOT_SUPPORTED The key type or key size is not supported, either by the implementation in general or in this particular persistent location. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The key attributes, as a whole, are invalid. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The key type is an asymmetric public key type. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The key size is not a valid size for the key type. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_INSUFFICIENT_ENTROPY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_HARDWARE_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_INSUFFICIENT_STORAGE </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd>
<dd>
PSA_ERROR_BAD_STATE The library has not been previously initialized by <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </dd></dl>

</div>
</div>
<a id="a1985eae417dfbccedf50d5fff54ea8c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1985eae417dfbccedf50d5fff54ea8c5">&#9670;&nbsp;</a></span>psa_generate_random()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_generate_random </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>output_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate random bytes. </p>
<dl class="section warning"><dt>Warning</dt><dd>This function can fail! Callers MUST check the return status and MUST NOT use the content of the output buffer if the return status is not PSA_SUCCESS.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>To generate a key, use <a class="el" href="crypto_8h.html#a950b4199ae7a0164006bd3d6927d1efe">psa_generate_key()</a> instead.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">output</td><td>Output buffer for the generated data. </td></tr>
    <tr><td class="paramname">output_size</td><td>Number of bytes to generate and output.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. <code>output</code> contains <code>output_size</code> bytes of generated random data. </dd>
<dd>
PSA_ERROR_BAD_STATE The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT <code>output</code> is NULL </dd>
<dd>
PSA_ERROR_NOT_SUPPORTED </dd>
<dd>
PSA_ERROR_INSUFFICIENT_ENTROPY </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd></dl>

</div>
</div>
<a id="ac255da850a00bbed925390044f016b34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac255da850a00bbed925390044f016b34">&#9670;&nbsp;</a></span>psa_get_key_algorithm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static psa_algorithm_t psa_get_key_algorithm </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *&#160;</td>
          <td class="paramname"><em>attributes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve the permitted algorithm policy from key attributes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">attributes</td><td>The key attribute object to query.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>psa_algorithm_t The algorithm stored in the attribute object. </dd></dl>

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l01880">1880</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="a8e70d36a3db2ec34425722166f5fa75b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e70d36a3db2ec34425722166f5fa75b">&#9670;&nbsp;</a></span>psa_get_key_attributes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_get_key_attributes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *&#160;</td>
          <td class="paramname"><em>attributes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the attributes of a key. </p>
<p>This function first resets the attribute object as with <a class="el" href="crypto_8h.html#af737271e0d134f480334784fc23c8672">psa_reset_key_attributes()</a>. It then copies the attributes of the given key into the given attribute object.</p>
<dl class="section note"><dt>Note</dt><dd>This function clears any previous content from the attribute object and therefore expects it to be in a valid state. In particular, if this function is called on a newly allocated attribute object, the attribute object must be initialized before calling this function.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Identifier of the key to query. </td></tr>
    <tr><td class="paramname">attributes</td><td>On entry, <code>*attributes</code> must be in a valid state. On successful return, it contains the attributes of the key. On failure, it is equivalent to a freshly-initialized attribute object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS </dd>
<dd>
PSA_ERROR_INVALID_HANDLE </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd>
<dd>
PSA_ERROR_BAD_STATE The library has not been previously initialized by <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </dd></dl>

</div>
</div>
<a id="a5bee85c2164ad3d4c0d42501241eeb06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5bee85c2164ad3d4c0d42501241eeb06">&#9670;&nbsp;</a></span>psa_get_key_bits()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t psa_get_key_bits </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *&#160;</td>
          <td class="paramname"><em>attributes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve the key size from key attributes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">attributes</td><td>The key attribute object to query.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>size_t The key size stored in the attribute object, in bits. </dd></dl>

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l01908">1908</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="add35bbb9e3aea14934cb61c396a3e6f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add35bbb9e3aea14934cb61c396a3e6f1">&#9670;&nbsp;</a></span>psa_get_key_id()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> psa_get_key_id </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *&#160;</td>
          <td class="paramname"><em>attributes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve the key identifier from key attributes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">attributes</td><td>The key attribute object to query.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> The persistent identifier stored in the attribute object. This value is unspecified if the attribute object declares the key as volatile. </dd></dl>

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l01943">1943</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="a9ea8eae1b81e480cc56dec858859aff9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ea8eae1b81e480cc56dec858859aff9">&#9670;&nbsp;</a></span>psa_get_key_lifetime()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="lifetime_8h.html#a6821ff6dd39dc2bc370ded760ad8b0cf">psa_key_lifetime_t</a> psa_get_key_lifetime </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *&#160;</td>
          <td class="paramname"><em>attributes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve the lifetime from key attributes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">attributes</td><td>The key attribute object to query.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="lifetime_8h.html#a6821ff6dd39dc2bc370ded760ad8b0cf">psa_key_lifetime_t</a> The lifetime value stored in the attribute object. </dd></dl>

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l01979">1979</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="ae4fb812af4f57aa1ad85e335a865b918"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4fb812af4f57aa1ad85e335a865b918">&#9670;&nbsp;</a></span>psa_get_key_type()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="psa__crypto_2psa_2key_2type_8h.html#a63fce6880ca5933b5d6baa257febf1f6">psa_key_type_t</a> psa_get_key_type </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *&#160;</td>
          <td class="paramname"><em>attributes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve the key type from key attributes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">attributes</td><td>The key attribute object to query.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="psa__crypto_2psa_2key_2type_8h.html#a63fce6880ca5933b5d6baa257febf1f6">psa_key_type_t</a> The key type stored in the attribute object. </dd></dl>

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l02006">2006</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="aa1af20f142ca722222c6d98678a0c448"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1af20f142ca722222c6d98678a0c448">&#9670;&nbsp;</a></span>psa_get_key_usage_flags()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="usage_8h.html#a7bb9de71337e0e98de843aa7f9b55f25">psa_key_usage_t</a> psa_get_key_usage_flags </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *&#160;</td>
          <td class="paramname"><em>attributes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve the usage flags from key attributes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">attributes</td><td>The key attribute object to query.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="usage_8h.html#a7bb9de71337e0e98de843aa7f9b55f25">psa_key_usage_t</a> The usage flags stored in the attribute object. </dd></dl>

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l02035">2035</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="ab0b4d5f9912a615559497a467b532928"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0b4d5f9912a615559497a467b532928">&#9670;&nbsp;</a></span>psa_hash_abort()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_hash_abort </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a3c4205d2ce66c4095fc5c78c25273fab">psa_hash_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Abort a hash operation. </p>
<p>Aborting an operation frees all associated resources except for the <code>operation</code> structure itself. Once aborted, the operation object can be reused for another operation by calling <a class="el" href="crypto_8h.html#a8d72896cf70fc4d514c5c6b978912515">psa_hash_setup()</a> again.</p>
<p>You may call this function any time after the operation object has been initialized by one of the methods described in <a class="el" href="crypto__types_8h.html#a3c4205d2ce66c4095fc5c78c25273fab">psa_hash_operation_t</a>.</p>
<p>In particular, calling <a class="el" href="crypto_8h.html#ab0b4d5f9912a615559497a467b532928">psa_hash_abort()</a> after the operation has been terminated by a call to <a class="el" href="crypto_8h.html#ab0b4d5f9912a615559497a467b532928">psa_hash_abort()</a>, <a class="el" href="crypto_8h.html#a4795fd06a0067b0adcd92e9627b8c97e">psa_hash_finish()</a> or <a class="el" href="crypto_8h.html#a7be923c5700c9c70ef77ee9b76d1a5c0">psa_hash_verify()</a> is safe and has no effect.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>Initialized hash operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_HARDWARE_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_BAD_STATE The library has not been previously initialized by <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </dd></dl>

</div>
</div>
<a id="a39673348f3302b4646bd780034a5aeda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39673348f3302b4646bd780034a5aeda">&#9670;&nbsp;</a></span>psa_hash_clone()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_hash_clone </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="crypto__types_8h.html#a3c4205d2ce66c4095fc5c78c25273fab">psa_hash_operation_t</a> *&#160;</td>
          <td class="paramname"><em>source_operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a3c4205d2ce66c4095fc5c78c25273fab">psa_hash_operation_t</a> *&#160;</td>
          <td class="paramname"><em>target_operation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clone a hash operation. </p>
<p>This function copies the state of an ongoing hash operation to a new operation object. In other words, this function is equivalent to calling <a class="el" href="crypto_8h.html#a8d72896cf70fc4d514c5c6b978912515">psa_hash_setup()</a> on <code>target_operation</code> with the same algorithm that <code>source_operation</code> was set up for, then <a class="el" href="crypto_8h.html#a65b16ef97d7f650899b7db4b7d1112ff">psa_hash_update()</a> on <code>target_operation</code> with the same input that that was passed to <code>source_operation</code>. After this function returns, the two objects are independent, i.e. subsequent calls involving one of the objects do not affect the other object.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">source_operation</td><td>The active hash operation to clone. </td></tr>
    <tr><td class="paramname">target_operation</td><td>The operation object to set up. It must be initialized but not active.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS </dd>
<dd>
PSA_ERROR_BAD_STATE The following conditions can result in this error:<ul>
<li>The <code>source_operation</code> state is not valid: it must be active.</li>
<li>The <code>target_operation</code> state is not valid: it must be inactive.</li>
<li>The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_HARDWARE_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd></dl>

</div>
</div>
<a id="a0c08f4797bec96b886c8c8d7acc2a553"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c08f4797bec96b886c8c8d7acc2a553">&#9670;&nbsp;</a></span>psa_hash_compare()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_hash_compare </td>
          <td>(</td>
          <td class="paramtype">psa_algorithm_t&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>input_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>hash_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the hash (digest) of a message and compare it with a reference value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">alg</td><td>The hash algorithm to compute: a value of type psa_algorithm_t such that <a class="el" href="hash_2algorithm_8h.html#ac9280662bb482590b4b33d1dcd32930f">PSA_ALG_IS_HASH</a>(<code>alg</code>) is true. </td></tr>
    <tr><td class="paramname">input</td><td>Buffer containing the message to hash. </td></tr>
    <tr><td class="paramname">input_length</td><td>Size of the input buffer in bytes. </td></tr>
    <tr><td class="paramname">hash</td><td>Buffer containing the expected hash value. </td></tr>
    <tr><td class="paramname">hash_length</td><td>Size of the hash buffer in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. The expected hash is identical to the actual hash of the input. </dd>
<dd>
PSA_ERROR_BAD_STATE The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </dd>
<dd>
PSA_ERROR_INVALID_SIGNATURE The calculated hash of the message does not match the value in hash. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The following conditions can result in this error:<ul>
<li><code>alg</code> is not a hash algorithm.</li>
<li><code>input_length</code> is too large for alg. </li>
</ul>
</dd>
<dd>
PSA_ERROR_NOT_SUPPORTED The following conditions can result in this error:<ul>
<li><code>alg</code> is not supported or is not a hash algorithm.</li>
<li><code>input_length</code> is too large for the implementation. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd></dl>

</div>
</div>
<a id="ac69f7f19d96a56c28cf3799d11b12156"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac69f7f19d96a56c28cf3799d11b12156">&#9670;&nbsp;</a></span>psa_hash_compute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_hash_compute </td>
          <td>(</td>
          <td class="paramtype">psa_algorithm_t&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>input_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>hash_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>hash_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the hash (digest) of a message. </p>
<dl class="section note"><dt>Note</dt><dd>To verify the hash of a message against an expected value, use <a class="el" href="crypto_8h.html#a0c08f4797bec96b886c8c8d7acc2a553">psa_hash_compare()</a> instead.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">alg</td><td>The hash algorithm to compute: a value of type psa_algorithm_t such that <a class="el" href="hash_2algorithm_8h.html#ac9280662bb482590b4b33d1dcd32930f">PSA_ALG_IS_HASH</a>(<code>alg</code>) is true. </td></tr>
    <tr><td class="paramname">input</td><td>Buffer containing the message to hash. </td></tr>
    <tr><td class="paramname">input_length</td><td>Size of the <code>input</code> buffer in bytes. </td></tr>
    <tr><td class="paramname">hash</td><td>Buffer where the hash is to be written. </td></tr>
    <tr><td class="paramname">hash_size</td><td>Size of the <code>hash</code> buffer in bytes. This must be at least <a class="el" href="crypto__sizes_8h.html#ae0c23128dc05e9680d2c4c1b292bcc77">PSA_HASH_LENGTH</a>(<code>alg</code>). </td></tr>
    <tr><td class="paramname">hash_length</td><td>On success, the number of bytes that make up the hash value. This is always <a class="el" href="crypto__sizes_8h.html#ae0c23128dc05e9680d2c4c1b292bcc77">PSA_HASH_LENGTH</a>(<code>alg</code>).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. The first <code></code>(*hash_length) bytes of <code>hash</code> contain the hash value. </dd>
<dd>
PSA_ERROR_BAD_STATE The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </dd>
<dd>
PSA_ERROR_BUFFER_TOO_SMALL The size of the hash buffer is too small. <a class="el" href="crypto__sizes_8h.html#ae0c23128dc05e9680d2c4c1b292bcc77">PSA_HASH_LENGTH()</a> can be used to determine a sufficient buffer size. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The following conditions can result in this error:<ul>
<li><code>alg</code> is not a hash algorithm</li>
<li><code>input_length</code> is too large for alg. </li>
</ul>
</dd>
<dd>
PSA_ERROR_NOT_SUPPORTED The following conditions can result in this error:<ul>
<li><code>alg</code> is not supported or is not a hash algorithm.</li>
<li><code>input_length</code> is too large for the implementation. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd></dl>

</div>
</div>
<a id="a4795fd06a0067b0adcd92e9627b8c97e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4795fd06a0067b0adcd92e9627b8c97e">&#9670;&nbsp;</a></span>psa_hash_finish()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_hash_finish </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a3c4205d2ce66c4095fc5c78c25273fab">psa_hash_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>hash_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>hash_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finish the calculation of the hash of a message. </p>
<p>The application must call <a class="el" href="crypto_8h.html#a8d72896cf70fc4d514c5c6b978912515">psa_hash_setup()</a> before calling this function. This function calculates the hash of the message formed by concatenating the inputs passed to preceding calls to <a class="el" href="crypto_8h.html#a65b16ef97d7f650899b7db4b7d1112ff">psa_hash_update()</a>.</p>
<p>When this function returns successfully, the operation becomes inactive. If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="crypto_8h.html#ab0b4d5f9912a615559497a467b532928">psa_hash_abort()</a>.</p>
<dl class="section warning"><dt>Warning</dt><dd>Applications should not call this function if they expect a specific value for the hash. Call <a class="el" href="crypto_8h.html#a7be923c5700c9c70ef77ee9b76d1a5c0">psa_hash_verify()</a> instead. Beware that comparing integrity or authenticity data such as hash values with a function such as <code>memcmp</code> is risky because the time taken by the comparison may leak information about the hashed data which could allow an attacker to guess a valid hash and thereby bypass security controls.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>Active hash operation. </td></tr>
    <tr><td class="paramname">hash</td><td>Buffer where the hash is to be written. </td></tr>
    <tr><td class="paramname">hash_size</td><td>Size of the <code>hash</code> buffer in bytes. This must be at least <a class="el" href="crypto__sizes_8h.html#ae0c23128dc05e9680d2c4c1b292bcc77">PSA_HASH_LENGTH</a>(<code>alg</code>) where <code>alg</code> is the algorithm that the operation performs. </td></tr>
    <tr><td class="paramname">hash_length</td><td>On success, the number of bytes that make up the hash value. This is always <a class="el" href="crypto__sizes_8h.html#ae0c23128dc05e9680d2c4c1b292bcc77">PSA_HASH_LENGTH</a>(<code>alg</code>) where <code>alg</code> is the hash algorithm that is calculated.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. The first <code></code>(*hash_length) bytes of <code>hash</code> contain the hash value. </dd>
<dd>
PSA_ERROR_BAD_STATE The following conditions can result in this error:<ul>
<li>The operation state is not valid: it must be active.</li>
<li>The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_BUFFER_TOO_SMALL The size of the hash buffer is too small. <a class="el" href="crypto__sizes_8h.html#ae0c23128dc05e9680d2c4c1b292bcc77">PSA_HASH_LENGTH()</a> can be used to determine a sufficient buffer size. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd></dl>

</div>
</div>
<a id="a70d97824771b5195a23236a135fabcc2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70d97824771b5195a23236a135fabcc2">&#9670;&nbsp;</a></span>psa_hash_resume()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_hash_resume </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a3c4205d2ce66c4095fc5c78c25273fab">psa_hash_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>hash_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>hash_state_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set up a multi-part hash operation using the hash suspend state from a previously suspended hash operation. </p>
<p>See <a class="el" href="crypto_8h.html#a32b41f2790027e066b373552af2c5c60">psa_hash_suspend()</a> for an example of how to use this function to suspend and resume a hash operation.</p>
<p>After a successful call to <a class="el" href="crypto_8h.html#a70d97824771b5195a23236a135fabcc2">psa_hash_resume()</a>, the application must eventually terminate the operation. The following events terminate an operation:</p><ul>
<li>A successful call to <a class="el" href="crypto_8h.html#a4795fd06a0067b0adcd92e9627b8c97e">psa_hash_finish()</a>, <a class="el" href="crypto_8h.html#a7be923c5700c9c70ef77ee9b76d1a5c0">psa_hash_verify()</a> or <a class="el" href="crypto_8h.html#a32b41f2790027e066b373552af2c5c60">psa_hash_suspend()</a>.</li>
<li>A call to <a class="el" href="crypto_8h.html#ab0b4d5f9912a615559497a467b532928">psa_hash_abort()</a>.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>The operation object to set up. It must have been initialized as per the documentation for <a class="el" href="crypto__types_8h.html#a3c4205d2ce66c4095fc5c78c25273fab">psa_hash_operation_t</a> and not yet in use. </td></tr>
    <tr><td class="paramname">hash_state</td><td>A buffer containing the suspended hash state which is to be resumed. This must be in the format output by <a class="el" href="crypto_8h.html#a32b41f2790027e066b373552af2c5c60">psa_hash_suspend()</a>. </td></tr>
    <tr><td class="paramname">hash_state_length</td><td>Length of hash_state in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. </dd>
<dd>
PSA_ERROR_BAD_STATE The following conditions can result in this error:<ul>
<li>The operation state is not valid: it must be inactive.</li>
<li>The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT <code>hash_state</code> does not correspond to a valid hash suspend state. See Hash suspend state format for the definition. </dd>
<dd>
PSA_ERROR_NOT_SUPPORTED The provided hash suspend state is for an algorithm that is not supported. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd></dl>

</div>
</div>
<a id="a8d72896cf70fc4d514c5c6b978912515"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d72896cf70fc4d514c5c6b978912515">&#9670;&nbsp;</a></span>psa_hash_setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_hash_setup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a3c4205d2ce66c4095fc5c78c25273fab">psa_hash_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">psa_algorithm_t&#160;</td>
          <td class="paramname"><em>alg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set up a multipart hash operation. </p>
<p>The sequence of operations to calculate a hash (message digest) is as follows:</p><ol type="1">
<li>Allocate an operation object which will be passed to all the functions listed here.</li>
<li>Initialize the operation object with one of the methods described in the documentation for <a class="el" href="crypto__types_8h.html#a3c4205d2ce66c4095fc5c78c25273fab">psa_hash_operation_t</a>, e.g. <a class="el" href="crypto__struct_8h.html#a6ab7fe8d3500bc2f21be840b4f4f8d1d">PSA_HASH_OPERATION_INIT</a>.</li>
<li>Call <a class="el" href="crypto_8h.html#a8d72896cf70fc4d514c5c6b978912515">psa_hash_setup()</a> to specify the algorithm.</li>
<li>Call <a class="el" href="crypto_8h.html#a65b16ef97d7f650899b7db4b7d1112ff">psa_hash_update()</a> zero, one or more times, passing a fragment of the message each time. The hash that is calculated is the hash of the concatenation of these messages in order.</li>
<li>To calculate the hash, call <a class="el" href="crypto_8h.html#a4795fd06a0067b0adcd92e9627b8c97e">psa_hash_finish()</a>. To compare the hash with an expected value, call <a class="el" href="crypto_8h.html#a7be923c5700c9c70ef77ee9b76d1a5c0">psa_hash_verify()</a>.</li>
</ol>
<p>If an error occurs at any step after a call to <a class="el" href="crypto_8h.html#a8d72896cf70fc4d514c5c6b978912515">psa_hash_setup()</a>, the operation will need to be reset by a call to <a class="el" href="crypto_8h.html#ab0b4d5f9912a615559497a467b532928">psa_hash_abort()</a>. The application may call <a class="el" href="crypto_8h.html#ab0b4d5f9912a615559497a467b532928">psa_hash_abort()</a> at any time after the operation has been initialized.</p>
<p>After a successful call to <a class="el" href="crypto_8h.html#a8d72896cf70fc4d514c5c6b978912515">psa_hash_setup()</a>, the application must eventually terminate the operation. The following events terminate an operation:</p><ul>
<li>A successful call to <a class="el" href="crypto_8h.html#a4795fd06a0067b0adcd92e9627b8c97e">psa_hash_finish()</a> or <a class="el" href="crypto_8h.html#a7be923c5700c9c70ef77ee9b76d1a5c0">psa_hash_verify()</a>.</li>
<li>A call to <a class="el" href="crypto_8h.html#ab0b4d5f9912a615559497a467b532928">psa_hash_abort()</a>.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>The operation object to set up. It must have been initialized as per the documentation for <a class="el" href="crypto__types_8h.html#a3c4205d2ce66c4095fc5c78c25273fab">psa_hash_operation_t</a> and not yet in use. </td></tr>
    <tr><td class="paramname">alg</td><td>The hash algorithm to compute: a value of type psa_algorithm_t such that <a class="el" href="hash_2algorithm_8h.html#ac9280662bb482590b4b33d1dcd32930f">PSA_ALG_IS_HASH</a>(<code>alg</code>) is true.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. </dd>
<dd>
PSA_ERROR_BAD_STATE The following conditions can result in this error:<ul>
<li>The operation state is not valid: it must be inactive.</li>
<li>The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT <code>alg</code> is not a hash algorithm. </dd>
<dd>
PSA_ERROR_NOT_SUPPORTED <code>alg</code> is not supported or is not a hash algorithm. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd></dl>

</div>
</div>
<a id="a32b41f2790027e066b373552af2c5c60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32b41f2790027e066b373552af2c5c60">&#9670;&nbsp;</a></span>psa_hash_suspend()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_hash_suspend </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a3c4205d2ce66c4095fc5c78c25273fab">psa_hash_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>hash_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>hash_state_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>hash_state_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Halt the hash operation and extract the intermediate state of the hash computation. </p>
<p>The application must call <a class="el" href="crypto_8h.html#a8d72896cf70fc4d514c5c6b978912515">psa_hash_setup()</a> or <a class="el" href="crypto_8h.html#a70d97824771b5195a23236a135fabcc2">psa_hash_resume()</a> before calling this function. This function extracts an intermediate state of the hash computation of the message formed by concatenating the inputs passed to preceding calls to <a class="el" href="crypto_8h.html#a65b16ef97d7f650899b7db4b7d1112ff">psa_hash_update()</a>.</p>
<p>This function can be used to halt a hash operation, and then resume the hash operation at a later time, or in another application, by transferring the extracted hash suspend state to a call to <a class="el" href="crypto_8h.html#a70d97824771b5195a23236a135fabcc2">psa_hash_resume()</a>.</p>
<p>When this function returns successfully, the operation becomes inactive. If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="crypto_8h.html#ab0b4d5f9912a615559497a467b532928">psa_hash_abort()</a>.</p>
<p>Hash suspend and resume is not defined for the SHA3 family of hash algorithms. Hash suspend state defines the format of the output from <a class="el" href="crypto_8h.html#a32b41f2790027e066b373552af2c5c60">psa_hash_suspend()</a>.</p>
<dl class="section warning"><dt>Warning</dt><dd>Applications must not use any of the hash suspend state as if it was a hash output. Instead, the suspend state must only be used to resume a hash operation, and <a class="el" href="crypto_8h.html#a4795fd06a0067b0adcd92e9627b8c97e">psa_hash_finish()</a> or <a class="el" href="crypto_8h.html#a7be923c5700c9c70ef77ee9b76d1a5c0">psa_hash_verify()</a> can then calculate or verify the final hash value.</dd></dl>
<p>The sequence of operations to suspend and resume a hash operation is as follows:</p><ol type="1">
<li>Compute the first part of the hash.<ol type="a">
<li>Allocate an operation object and initialize it as described in the documentation for <a class="el" href="crypto__types_8h.html#a3c4205d2ce66c4095fc5c78c25273fab">psa_hash_operation_t</a>.</li>
<li>Call <a class="el" href="crypto_8h.html#a8d72896cf70fc4d514c5c6b978912515">psa_hash_setup()</a> to specify the algorithm.</li>
<li>Call <a class="el" href="crypto_8h.html#a65b16ef97d7f650899b7db4b7d1112ff">psa_hash_update()</a> zero, one or more times, passing a fragment of the message each time.</li>
<li>Call <a class="el" href="crypto_8h.html#a32b41f2790027e066b373552af2c5c60">psa_hash_suspend()</a> to extract the hash suspend state into a buffer.</li>
</ol>
</li>
<li>Pass the hash state buffer to the application which will resume the operation.</li>
<li>Compute the rest of the hash.<ol type="a">
<li>Allocate an operation object and initialize it as described in the documentation for <a class="el" href="crypto__types_8h.html#a3c4205d2ce66c4095fc5c78c25273fab">psa_hash_operation_t</a>.</li>
<li>Call <a class="el" href="crypto_8h.html#a70d97824771b5195a23236a135fabcc2">psa_hash_resume()</a> with the extracted hash state.</li>
<li>Call <a class="el" href="crypto_8h.html#a65b16ef97d7f650899b7db4b7d1112ff">psa_hash_update()</a> zero, one or more times, passing a fragment of the message each time.</li>
<li>To calculate the hash, call <a class="el" href="crypto_8h.html#a4795fd06a0067b0adcd92e9627b8c97e">psa_hash_finish()</a>. To compare the hash with an expected value, call <a class="el" href="crypto_8h.html#a7be923c5700c9c70ef77ee9b76d1a5c0">psa_hash_verify()</a>.</li>
</ol>
</li>
</ol>
<p>If an error occurs at any step after a call to <a class="el" href="crypto_8h.html#a8d72896cf70fc4d514c5c6b978912515">psa_hash_setup()</a> or <a class="el" href="crypto_8h.html#a70d97824771b5195a23236a135fabcc2">psa_hash_resume()</a>, the operation will need to be reset by a call to <a class="el" href="crypto_8h.html#ab0b4d5f9912a615559497a467b532928">psa_hash_abort()</a>. The application can call <a class="el" href="crypto_8h.html#ab0b4d5f9912a615559497a467b532928">psa_hash_abort()</a> at any time after the operation has been initialized.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>Active hash operation. </td></tr>
    <tr><td class="paramname">hash_state</td><td>Buffer where the hash suspend state is to be written. </td></tr>
    <tr><td class="paramname">hash_state_size</td><td>Size of the hash_state buffer in bytes. This must be appropriate for the selected algorithm:<ul>
<li>A sufficient output size is <a class="el" href="crypto__sizes_8h.html#a4ef62f02cb87e52e2c1d57e26aca67bd">PSA_HASH_SUSPEND_OUTPUT_SIZE</a>(<code>alg</code>) where alg is the algorithm that was used to set up the operation.</li>
<li><a class="el" href="crypto__sizes_8h.html#ad2f40f259105ea100c332bfb3992824c">PSA_HASH_SUSPEND_OUTPUT_MAX_SIZE</a> evaluates to the maximum output size of any supported hash algorithm. </li>
</ul>
</td></tr>
    <tr><td class="paramname">hash_state_length</td><td>On success, the number of bytes that make up the hash suspend state.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. The first <code></code>(*hash_state_length) bytes of <code>hash_state</code> contain the intermediate hash state. </dd>
<dd>
PSA_ERROR_BAD_STATE The following conditions can result in this error:<ul>
<li>The operation state is not valid: it must be active.</li>
<li>The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_BUFFER_TOO_SMALL The size of the hash_state buffer is too small. <a class="el" href="crypto__sizes_8h.html#a4ef62f02cb87e52e2c1d57e26aca67bd">PSA_HASH_SUSPEND_OUTPUT_SIZE()</a> or <a class="el" href="crypto__sizes_8h.html#ad2f40f259105ea100c332bfb3992824c">PSA_HASH_SUSPEND_OUTPUT_MAX_SIZE</a> can be used to determine a sufficient buffer size. </dd>
<dd>
PSA_ERROR_NOT_SUPPORTED The hash algorithm being computed does not support suspend and resume. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd></dl>

</div>
</div>
<a id="a65b16ef97d7f650899b7db4b7d1112ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65b16ef97d7f650899b7db4b7d1112ff">&#9670;&nbsp;</a></span>psa_hash_update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_hash_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a3c4205d2ce66c4095fc5c78c25273fab">psa_hash_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>input_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a message fragment to a multi-part hash operation. </p>
<p>The application must call <a class="el" href="crypto_8h.html#a8d72896cf70fc4d514c5c6b978912515">psa_hash_setup()</a> before calling this function. If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="crypto_8h.html#ab0b4d5f9912a615559497a467b532928">psa_hash_abort()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>Active hash operation. </td></tr>
    <tr><td class="paramname">input</td><td>Buffer containing the message fragment to hash. </td></tr>
    <tr><td class="paramname">input_length</td><td>Size of the <code>input</code> buffer in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. </dd>
<dd>
PSA_ERROR_BAD_STATE The following conditions can result in this error:<ul>
<li>The operation state is not valid: it must be active.</li>
<li>The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The total input for the operation is too large for the hash algorithm. </dd>
<dd>
PSA_ERROR_NOT_SUPPORTED The total input for the operation is too large for the implementation. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd></dl>

</div>
</div>
<a id="a7be923c5700c9c70ef77ee9b76d1a5c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7be923c5700c9c70ef77ee9b76d1a5c0">&#9670;&nbsp;</a></span>psa_hash_verify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_hash_verify </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a3c4205d2ce66c4095fc5c78c25273fab">psa_hash_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>hash_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finish the calculation of the hash of a message and compare it with an expected value. </p>
<p>The application must call <a class="el" href="crypto_8h.html#a8d72896cf70fc4d514c5c6b978912515">psa_hash_setup()</a> before calling this function. This function calculates the hash of the message formed by concatenating the inputs passed to preceding calls to <a class="el" href="crypto_8h.html#a65b16ef97d7f650899b7db4b7d1112ff">psa_hash_update()</a>. It then compares the calculated hash with the expected hash passed as a parameter to this function.</p>
<p>When this function returns successfully, the operation becomes inactive. If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="crypto_8h.html#ab0b4d5f9912a615559497a467b532928">psa_hash_abort()</a>.</p>
<dl class="section note"><dt>Note</dt><dd>Implementations shall make the best effort to ensure that the comparison between the actual hash and the expected hash is performed in constant time.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>Active hash operation. </td></tr>
    <tr><td class="paramname">hash</td><td>Buffer containing the expected hash value. </td></tr>
    <tr><td class="paramname">hash_length</td><td>Size of the <code>hash</code> buffer in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. The expected hash is identical to the actual hash of the message. </dd>
<dd>
PSA_ERROR_BAD_STATE The following conditions can result in this error:<ul>
<li>The operation state is not valid: it must be active.</li>
<li>The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INVALID_SIGNATURE The calculated hash of the message does not match the value in hash. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd></dl>

</div>
</div>
<a id="ad088d8ebc854d2f7a5b5c1769bc9ed40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad088d8ebc854d2f7a5b5c1769bc9ed40">&#9670;&nbsp;</a></span>psa_import_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_import_key </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *&#160;</td>
          <td class="paramname"><em>attributes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Import a key in binary format. </p>
<p>This function supports any output from <a class="el" href="crypto_8h.html#a5f2f7c851186c5d1d928be0b6020225c">psa_export_key()</a>. Refer to the documentation of <a class="el" href="crypto_8h.html#a76970efac4f9418a03bf59dc345eaf88">psa_export_public_key()</a> for the format of public keys and to the documentation of <a class="el" href="crypto_8h.html#a5f2f7c851186c5d1d928be0b6020225c">psa_export_key()</a> for the format for other key types.</p>
<p>The key data determines the key size. The attributes can optionally specify a key size; in this case it must match the size determined from the key data. A key size of 0 in attributes indicates that the key size is solely determined by the key data.</p>
<p>Implementations must reject an attempt to import a key of size 0.</p>
<p>This specification defines a single format for each key type. Implementations can optionally support other formats in addition to the standard format. It is recommended that implementations that support other formats ensure that the formats are clearly unambiguous, to minimize the risk that an invalid input is accidentally interpreted according to a different format.</p>
<dl class="section note"><dt>Note</dt><dd>The PSA Crypto API does not support asymmetric private key objects outside of a key pair. To import a private key, the attributes must specify the corresponding key pair type. Depending on the key type, either the import format contains the public key data or the implementation will reconstruct the public key from the private key as needed.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">attributes</td><td>The attributes for the new key. This function uses the attributes as follows:<ul>
<li>The key type is required, and determines how the data buffer is interpreted.</li>
<li>The key size is always determined from the data buffer. If the key size in attributes is nonzero, it must be equal to the size determined from data.</li>
<li>The key permitted-algorithm policy is required for keys that will be used for a cryptographic operation, see Permitted algorithms.</li>
<li>The key usage flags define what operations are permitted with the key, see Key usage flags.</li>
<li>The key lifetime and identifier are required for a persistent key. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This is an input parameter: it is not updated with the final key attributes. The final attributes of the new key can be queried by calling <a class="el" href="crypto_8h.html#a8e70d36a3db2ec34425722166f5fa75b">psa_get_key_attributes()</a> with the keys identifier.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>Buffer containing the key data. The content of this buffer is interpreted according to the type declared in attributes. All implementations must support at least the format described in the documentation of <a class="el" href="crypto_8h.html#a5f2f7c851186c5d1d928be0b6020225c">psa_export_key()</a> or <a class="el" href="crypto_8h.html#a76970efac4f9418a03bf59dc345eaf88">psa_export_public_key()</a> for the chosen type. Implementations can support other formats, but be conservative in interpreting the key data: it is recommended that implementations reject content if it might be erroneous, for example, if it is the wrong type or is truncated. </td></tr>
    <tr><td class="paramname">data_length</td><td>Size of the data buffer in bytes. </td></tr>
    <tr><td class="paramname">key</td><td>On success, an identifier for the newly created key. <a class="el" href="id_8h.html#a650b5f7c553bf6f8db2076dbd9f4dd44">PSA_KEY_ID_NULL</a> on failure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. If the key is persistent, the key material and the keys metadata have been saved to persistent storage. </dd>
<dd>
PSA_ERROR_BAD_STATE The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </dd>
<dd>
PSA_ERROR_NOT_PERMITTED The implementation does not permit creating a key with the specified attributes due to some implementation-specific policy. </dd>
<dd>
PSA_ERROR_ALREADY_EXISTS This is an attempt to create a persistent key, and there is already a persistent key with the given identifier. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The following conditions can result in this error:<ul>
<li>The key type is invalid.</li>
<li>The key size is nonzero, and is incompatible with the key data in <code>data</code>.</li>
<li>The key lifetime is invalid.</li>
<li>The key identifier is not valid for the key lifetime.</li>
<li>The key usage flags include invalid values.</li>
<li>The keys permitted-usage algorithm is invalid.</li>
<li>The key attributes, as a whole, are invalid.</li>
<li>The key data is not correctly formatted for the key type. </li>
</ul>
</dd>
<dd>
PSA_ERROR_NOT_SUPPORTED The key attributes, as a whole, are not supported, either by the implementation in general or in the specified storage location. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_INSUFFICIENT_STORAGE </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="a90fdd2716124d0bd258826184824675f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90fdd2716124d0bd258826184824675f">&#9670;&nbsp;</a></span>psa_key_derivation_abort()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_key_derivation_abort </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a1ad89f1ce73274b54b6557dda5ee6290">psa_key_derivation_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Abort a key derivation operation. </p>
<p>Aborting an operation frees all associated resources except for the operation object itself. Once aborted, the operation object can be reused for another operation by calling <a class="el" href="crypto_8h.html#ac0b6a76e45cceb1862752bf041701859">psa_key_derivation_setup()</a> again.</p>
<p>This function can be called at any time after the operation object has been initialized as described in <a class="el" href="crypto__types_8h.html#a1ad89f1ce73274b54b6557dda5ee6290">psa_key_derivation_operation_t</a>.</p>
<p>In particular, it is valid to call <a class="el" href="crypto_8h.html#a90fdd2716124d0bd258826184824675f">psa_key_derivation_abort()</a> twice, or to call <a class="el" href="crypto_8h.html#a90fdd2716124d0bd258826184824675f">psa_key_derivation_abort()</a> on an operation that has not been set up.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>The operation to abort.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. The operation object can now be discarded or reused. </dd>
<dd>
PSA_ERROR_BAD_STATE The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd></dl>

</div>
</div>
<a id="a9b0b6769491b25e0592fce0f1c96f842"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b0b6769491b25e0592fce0f1c96f842">&#9670;&nbsp;</a></span>psa_key_derivation_get_capacity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_key_derivation_get_capacity </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="crypto__types_8h.html#a1ad89f1ce73274b54b6557dda5ee6290">psa_key_derivation_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>capacity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the current capacity of a key derivation operation. </p>
<p>The capacity of a key derivation is the maximum number of bytes that it can return. Reading N bytes of output from a key derivation operation reduces its capacity by at least N. The capacity can be reduced by more than N in the following situations:</p><ul>
<li>Calling <a class="el" href="crypto_8h.html#ad286b675f3f8b46fa6cab620de6bead3">psa_key_derivation_output_key()</a> can reduce the capacity by more than the key size, depending on the type of key being generated. See <a class="el" href="crypto_8h.html#ad286b675f3f8b46fa6cab620de6bead3">psa_key_derivation_output_key()</a> for details of the key derivation process.</li>
<li>When the <a class="el" href="crypto__types_8h.html#a1ad89f1ce73274b54b6557dda5ee6290">psa_key_derivation_operation_t</a> object is operating as a deterministic random bit generator (DBRG), which reduces capacity in whole blocks, even when less than a block is read.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>The operation to query. </td></tr>
    <tr><td class="paramname">capacity</td><td>On success, the capacity of the operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. The maximum number of bytes that this key derivation can return is (<code>*capacity</code>). </dd>
<dd>
PSA_ERROR_BAD_STATE The following conditions can result in this error:<ul>
<li>The operation state is not valid: it must be active.</li>
<li>The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd></dl>

</div>
</div>
<a id="a8fd934dfb0ca45cbf89542ef2a5494c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fd934dfb0ca45cbf89542ef2a5494c2">&#9670;&nbsp;</a></span>psa_key_derivation_input_bytes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_key_derivation_input_bytes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a1ad89f1ce73274b54b6557dda5ee6290">psa_key_derivation_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#aac4eeacd36596c548b3a48fc06c5048b">psa_key_derivation_step_t</a>&#160;</td>
          <td class="paramname"><em>step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>data_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Provide an input for key derivation or key agreement. </p>
<p>Which inputs are required and in what order depends on the algorithm. Refer to the documentation of each key derivation or key agreement algorithm for information.</p>
<p>This function passes direct inputs, which is usually correct for non-secret inputs. To pass a secret input, which is normally in a key object, call <a class="el" href="crypto_8h.html#aa936b9b1f6264beb6e23afd5f87bcccc">psa_key_derivation_input_key()</a> instead of this function. Refer to the documentation of individual step types (<code>PSA_KEY_DERIVATION_INPUT_xxx</code> values of type <a class="el" href="crypto__types_8h.html#aac4eeacd36596c548b3a48fc06c5048b">psa_key_derivation_step_t</a>) for more information.</p>
<p>If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="crypto_8h.html#a90fdd2716124d0bd258826184824675f">psa_key_derivation_abort()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>The key derivation operation object to use. It must have been set up with <a class="el" href="crypto_8h.html#ac0b6a76e45cceb1862752bf041701859">psa_key_derivation_setup()</a> and must not have produced any output yet. </td></tr>
    <tr><td class="paramname">step</td><td>Which step the input data is for. </td></tr>
    <tr><td class="paramname">data</td><td>Input data to use. </td></tr>
    <tr><td class="paramname">data_length</td><td>Size of the data buffer in bytes. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. </dd>
<dd>
PSA_ERROR_BAD_STATE The following conditions can result in this error:<ul>
<li>The operation state is not valid for this input step. This can happen if the application provides a step out of order or repeats a step that may not be repeated.</li>
<li>The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The following conditions can result in this error:<ul>
<li><code>step</code> is not compatible with the operations algorithm.</li>
<li><code>step</code> does not allow direct inputs.</li>
<li><code>data_length</code> is too small or too large for step in this particular algorithm. </li>
</ul>
</dd>
<dd>
PSA_ERROR_NOT_SUPPORTED The following conditions can result in this error:<ul>
<li><code>step</code> is not supported with the operations algorithm.</li>
<li><code>data_length</code> is is not supported for step in this particular algorithm. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="ac14f4c2fa41c2c1f6154f8a9c7a5a0cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac14f4c2fa41c2c1f6154f8a9c7a5a0cd">&#9670;&nbsp;</a></span>psa_key_derivation_input_integer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_key_derivation_input_integer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a1ad89f1ce73274b54b6557dda5ee6290">psa_key_derivation_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#aac4eeacd36596c548b3a48fc06c5048b">psa_key_derivation_step_t</a>&#160;</td>
          <td class="paramname"><em>step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Provide a numeric input for key derivation or key agreement. </p>
<p>Which inputs are required and in what order depends on the algorithm. However, when an algorithm requires a particular order, numeric inputs usually come first as they tend to be configuration parameters. Refer to the documentation of each key derivation or key agreement algorithm for information.</p>
<p>This function is used for inputs which are fixed-size non-negative integers.</p>
<p>If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="crypto_8h.html#a90fdd2716124d0bd258826184824675f">psa_key_derivation_abort()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>The key derivation operation object to use. It must have been set up with <a class="el" href="crypto_8h.html#ac0b6a76e45cceb1862752bf041701859">psa_key_derivation_setup()</a> and must not have produced any output yet. </td></tr>
    <tr><td class="paramname">step</td><td>Which step the input data is for. </td></tr>
    <tr><td class="paramname">value</td><td>The value of the numeric input. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. </dd>
<dd>
PSA_ERROR_BAD_STATE The following conditions can result in this error:<ul>
<li>The operation state is not valid for this input step. This can happen if the application provides a step out of order or repeats a step that may not be repeated.</li>
<li>The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The following conditions can result in this error:<ul>
<li><code>step</code> is not compatible with the operations algorithm.</li>
<li><code>step</code> does not allow numerical inputs.</li>
<li><code>value</code> is not valid for step in the operations algorithm. </li>
</ul>
</dd>
<dd>
PSA_ERROR_NOT_SUPPORTED The following conditions can result in this error:<ul>
<li><code>step</code> is not supported with the operations algorithm.</li>
<li><code>value</code> is not supported for step in the operations algorithm. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="aa936b9b1f6264beb6e23afd5f87bcccc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa936b9b1f6264beb6e23afd5f87bcccc">&#9670;&nbsp;</a></span>psa_key_derivation_input_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_key_derivation_input_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a1ad89f1ce73274b54b6557dda5ee6290">psa_key_derivation_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#aac4eeacd36596c548b3a48fc06c5048b">psa_key_derivation_step_t</a>&#160;</td>
          <td class="paramname"><em>step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Provide an input for key derivation in the form of a key. </p>
<p>Which inputs are required and in what order depends on the algorithm. Refer to the documentation of each key derivation or key agreement algorithm for information.</p>
<p>This function obtains input from a key object, which is usually correct for secret inputs or for non-secret personalization strings kept in the key store. To pass a non-secret parameter which is not in the key store, call <a class="el" href="crypto_8h.html#a8fd934dfb0ca45cbf89542ef2a5494c2">psa_key_derivation_input_bytes()</a> instead of this function. Refer to the documentation of individual step types (<code>PSA_KEY_DERIVATION_INPUT_xxx</code> values of type <a class="el" href="crypto__types_8h.html#aac4eeacd36596c548b3a48fc06c5048b">psa_key_derivation_step_t</a>) for more information.</p>
<dl class="section note"><dt>Note</dt><dd>Once all inputs steps are completed, the following operations are permitted:<ul>
<li><a class="el" href="crypto_8h.html#a06b7eb34a2fa88965f68e3d023fa12b9">psa_key_derivation_output_bytes()</a>  if each input was either a direct input or a key with usage flag <a class="el" href="usage_8h.html#af19022acc5ef23cf12477f632b48a0b2">PSA_KEY_USAGE_DERIVE</a>.</li>
<li><a class="el" href="crypto_8h.html#ad286b675f3f8b46fa6cab620de6bead3">psa_key_derivation_output_key()</a>  if the input for step <a class="el" href="crypto__values_8h.html#a0ddfbe764baba995c402b1b0ef59392e">PSA_KEY_DERIVATION_INPUT_SECRET</a> or <a class="el" href="crypto__values_8h.html#ae19de2d7c74759878b4a6677b0acdda7">PSA_KEY_DERIVATION_INPUT_PASSWORD</a> was a key with usage flag <a class="el" href="usage_8h.html#af19022acc5ef23cf12477f632b48a0b2">PSA_KEY_USAGE_DERIVE</a>, and every other input was either a direct input or a key with usage flag <a class="el" href="usage_8h.html#af19022acc5ef23cf12477f632b48a0b2">PSA_KEY_USAGE_DERIVE</a>.</li>
<li><a class="el" href="crypto_8h.html#af01520beb7ba932143ffe733b0795b08">psa_key_derivation_verify_bytes()</a>  if each input was either a direct input or a key with usage flag <a class="el" href="usage_8h.html#a25aece70be2b79afbdb4180f7c4e68ed">PSA_KEY_USAGE_VERIFY_DERIVATION</a>.</li>
<li><a class="el" href="crypto_8h.html#ac041714e34a94742e8ee006ac7dfea5a">psa_key_derivation_verify_key()</a>  under the same conditions as <a class="el" href="crypto_8h.html#af01520beb7ba932143ffe733b0795b08">psa_key_derivation_verify_bytes()</a>.</li>
</ul>
</dd></dl>
<p>If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="crypto_8h.html#a90fdd2716124d0bd258826184824675f">psa_key_derivation_abort()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>The key derivation operation object to use. It must have been set up with <a class="el" href="crypto_8h.html#ac0b6a76e45cceb1862752bf041701859">psa_key_derivation_setup()</a> and must not have produced any output yet. </td></tr>
    <tr><td class="paramname">step</td><td>Which step the input data is for. </td></tr>
    <tr><td class="paramname">key</td><td>Identifier of the key. The key must have an appropriate type for step, it must allow the usage <a class="el" href="usage_8h.html#af19022acc5ef23cf12477f632b48a0b2">PSA_KEY_USAGE_DERIVE</a> or <a class="el" href="usage_8h.html#a25aece70be2b79afbdb4180f7c4e68ed">PSA_KEY_USAGE_VERIFY_DERIVATION</a> (see note), and it must permit the algorithm used by the operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. </dd>
<dd>
PSA_ERROR_BAD_STATE The following conditions can result in this error:<ul>
<li>The operation state is not valid for this input step. This can happen if the application provides a step out of order or repeats a step that may not be repeated.</li>
<li>The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INVALID_HANDLE <code>key</code> is not a valid key identifier. </dd>
<dd>
PSA_ERROR_NOT_PERMITTED The key has neither the <a class="el" href="usage_8h.html#af19022acc5ef23cf12477f632b48a0b2">PSA_KEY_USAGE_DERIVE</a> nor the <a class="el" href="usage_8h.html#a25aece70be2b79afbdb4180f7c4e68ed">PSA_KEY_USAGE_VERIFY_DERIVATION</a> usage flag, or it does not permit the operations algorithm. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The following conditions can result in this error:<ul>
<li><code>step</code> is not compatible with the operations algorithm.</li>
<li><code>step</code> does not allow key inputs of the given type, or does not allow key inputs at all. </li>
</ul>
</dd>
<dd>
PSA_ERROR_NOT_SUPPORTED The following conditions can result in this error:<ul>
<li><code>step</code> is not supported with the operations algorithm.</li>
<li><code>Key</code> inputs of the given type are not supported for step in the operations algorithm. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="a4da37a87ff9863e2a61eccefd331254a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4da37a87ff9863e2a61eccefd331254a">&#9670;&nbsp;</a></span>psa_key_derivation_key_agreement()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_key_derivation_key_agreement </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a1ad89f1ce73274b54b6557dda5ee6290">psa_key_derivation_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#aac4eeacd36596c548b3a48fc06c5048b">psa_key_derivation_step_t</a>&#160;</td>
          <td class="paramname"><em>step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>private_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>peer_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>peer_key_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform a key agreement and use the shared secret as input to a key derivation. </p>
<p>A key agreement algorithm takes two inputs: a private key <code>private_key</code>, and a public key <code>peer_key</code>. The result of this function is passed as input to the key derivation operation. The output of this key derivation can be extracted by reading from the resulting operation to produce keys and other cryptographic material.</p>
<p>If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="crypto_8h.html#a90fdd2716124d0bd258826184824675f">psa_key_derivation_abort()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>The key derivation operation object to use. It must have been set up with <a class="el" href="crypto_8h.html#ac0b6a76e45cceb1862752bf041701859">psa_key_derivation_setup()</a> with a key agreement and derivation algorithm alg: a value of type psa_algorithm_t such that <a class="el" href="key__agreement_2algorithm_8h.html#a59753742cb06553bd22751bbef472b6f">PSA_ALG_IS_KEY_AGREEMENT</a>(<code>alg</code>) is true and <a class="el" href="key__agreement_2algorithm_8h.html#aa40ab362ce141ce541d69b2eb1f41438">PSA_ALG_IS_RAW_KEY_AGREEMENT</a>(<code>alg</code>) is false. The operation must be ready for an input of the type given by step. </td></tr>
    <tr><td class="paramname">step</td><td>Which step the input data is for. </td></tr>
    <tr><td class="paramname">private_key</td><td>Identifier of the private key to use. It must allow the usage <a class="el" href="usage_8h.html#af19022acc5ef23cf12477f632b48a0b2">PSA_KEY_USAGE_DERIVE</a>. </td></tr>
    <tr><td class="paramname">peer_key</td><td>Public key of the peer. The peer key must be in the same format that <a class="el" href="crypto_8h.html#ad088d8ebc854d2f7a5b5c1769bc9ed40">psa_import_key()</a> accepts for the public key type corresponding to the type of <code>private_key</code>. That is, this function performs the equivalent of <a class="el" href="crypto_8h.html#ad088d8ebc854d2f7a5b5c1769bc9ed40">psa_import_key</a>(..., <code>peer_key</code>, <code>peer_key_length</code>), with key attributes indicating the public key type corresponding to the type of <code>private_key</code>. For example, for ECC keys, this means that <code>peer_key</code> is interpreted as a point on the curve that the private key is on. The standard formats for public keys are documented in the documentation of <a class="el" href="crypto_8h.html#a76970efac4f9418a03bf59dc345eaf88">psa_export_public_key()</a>. </td></tr>
    <tr><td class="paramname">peer_key_length</td><td>Size of <code>peer_key</code> in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. </dd>
<dd>
PSA_ERROR_BAD_STATE The following conditions can result in this error:<ul>
<li>The operation state is not valid for this key agreement step.</li>
<li>The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INVALID_HANDLE <code>private_key</code> is not a valid key identifier. </dd>
<dd>
PSA_ERROR_NOT_PERMITTED <code>private_key</code> does not have the <a class="el" href="usage_8h.html#af19022acc5ef23cf12477f632b48a0b2">PSA_KEY_USAGE_DERIVE</a> flag, or it does not permit the operations algorithm. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The following conditions can result in this error:<ul>
<li>The operations algorithm is not a key agreement algorithm.</li>
<li><code>step</code> does not allow an input resulting from a key agreement.</li>
<li><code>private_key</code> is not compatible with the operations algorithm.</li>
<li><code>peer_key</code> is not a valid public key corresponding to <code>private_key</code>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_NOT_SUPPORTED <code>private_key</code> is not supported for use with the operations algorithm. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="a06b7eb34a2fa88965f68e3d023fa12b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06b7eb34a2fa88965f68e3d023fa12b9">&#9670;&nbsp;</a></span>psa_key_derivation_output_bytes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_key_derivation_output_bytes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a1ad89f1ce73274b54b6557dda5ee6290">psa_key_derivation_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>output_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read some data from a key derivation operation. </p>
<p>This function calculates output bytes from a key derivation algorithm and returns those bytes. If the key derivations output is viewed as a stream of bytes, this function consumes the requested number of bytes from the stream and returns them to the caller. The operations capacity decreases by the number of bytes read.</p>
<p>If this function returns an error status other than PSA_ERROR_INSUFFICIENT_DATA, the operation enters an error state and must be aborted by calling <a class="el" href="crypto_8h.html#a90fdd2716124d0bd258826184824675f">psa_key_derivation_abort()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>The key derivation operation object to read from. </td></tr>
    <tr><td class="paramname">output</td><td>Buffer where the output will be written. </td></tr>
    <tr><td class="paramname">output_length</td><td>Number of bytes to output.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. The first output_length bytes of output contain the derived data. </dd>
<dd>
PSA_ERROR_BAD_STATE The following conditions can result in this error:<ul>
<li>The operation state is not valid: it must be active, with all required input steps complete.</li>
<li>The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_NOT_PERMITTED One of the inputs was a key whose policy did not allow <a class="el" href="usage_8h.html#af19022acc5ef23cf12477f632b48a0b2">PSA_KEY_USAGE_DERIVE</a>. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_DATA The operations capacity was less than <code>output_length</code> bytes. In this case, the following occurs:<ul>
<li>No output is written to the output buffer.</li>
<li>The operations capacity is set to zero  subsequent calls to this function will not succeed, even with a smaller output buffer. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="ad286b675f3f8b46fa6cab620de6bead3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad286b675f3f8b46fa6cab620de6bead3">&#9670;&nbsp;</a></span>psa_key_derivation_output_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_key_derivation_output_key </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *&#160;</td>
          <td class="paramname"><em>attributes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a1ad89f1ce73274b54b6557dda5ee6290">psa_key_derivation_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Derive a key from an ongoing key derivation operation. </p>
<p>This function calculates output bytes from a key derivation algorithm and uses those bytes to generate a key deterministically. The keys location, policy, type and size are taken from attributes.</p>
<p>If the key derivations output is viewed as a stream of bytes, this function consumes the required number of bytes from the stream. The operations capacity decreases by the number of bytes used to derive the key.</p>
<p>If this function returns an error status other than PSA_ERROR_INSUFFICIENT_DATA, the operation enters an error state and must be aborted by calling <a class="el" href="crypto_8h.html#a90fdd2716124d0bd258826184824675f">psa_key_derivation_abort()</a>.</p>
<p>How much output is produced and consumed from the operation, and how the key is derived, depends on the key type.</p>
<ul>
<li>For key types for which the key is an arbitrary sequence of bytes of a given size, this function is functionally equivalent to calling <a class="el" href="crypto_8h.html#a06b7eb34a2fa88965f68e3d023fa12b9">psa_key_derivation_output_bytes()</a> and passing the resulting output to <a class="el" href="crypto_8h.html#ad088d8ebc854d2f7a5b5c1769bc9ed40">psa_import_key()</a>. However, this function has a security benefit: if the implementation provides an isolation boundary then the key material is not exposed outside the isolation boundary. As a consequence, for these key types, this function always consumes exactly <code></code>(bits/8) bytes from the operation. The following key types defined in this specification follow this scheme:<ul>
<li><a class="el" href="psa__crypto_2psa_2key_2type_8h.html#a6ee54579dcf278c677eda4bb1a29575e">PSA_KEY_TYPE_AES</a></li>
<li><a class="el" href="psa__crypto_2psa_2key_2type_8h.html#ae4d46e83f910dcaa126000a8ed03cde9">PSA_KEY_TYPE_ARC4</a></li>
<li><a class="el" href="psa__crypto_2psa_2key_2type_8h.html#a853d69f982740f4fd40cc964075c188f">PSA_KEY_TYPE_ARIA</a></li>
<li><a class="el" href="psa__crypto_2psa_2key_2type_8h.html#ad8e5da742343fd5519f9d8a630c2ed81">PSA_KEY_TYPE_CAMELLIA</a></li>
<li><a class="el" href="psa__crypto_2psa_2key_2type_8h.html#a901548883b3bce56cc21c3a22cf8d93c">PSA_KEY_TYPE_CHACHA20</a></li>
<li><a class="el" href="psa__crypto_2psa_2key_2type_8h.html#a5b2b1f1434710f4ddbcea30919f08a2c">PSA_KEY_TYPE_SM4</a></li>
<li><a class="el" href="psa__crypto_2psa_2key_2type_8h.html#ae871b2357b8593f33bfd51abbf93ebb1">PSA_KEY_TYPE_DERIVE</a></li>
<li><a class="el" href="psa__crypto_2psa_2key_2type_8h.html#a92d989f4ca64abd00f463defd773a6f8">PSA_KEY_TYPE_HMAC</a></li>
<li><a class="el" href="psa__crypto_2psa_2key_2type_8h.html#ac41a0d5fdafc1c19ae73313613142723">PSA_KEY_TYPE_PASSWORD_HASH</a></li>
<li><a class="el" href="psa__crypto_2psa_2key_2type_8h.html#a577562bfbbc691c820d55ec308333138">PSA_KEY_TYPE_DES</a>, 64 bits This function generates a key using the following process:<ol type="1">
<li>Draw an 8-byte string.</li>
<li>Set/clear the parity bits in each byte.</li>
<li>If the result is a forbidden weak key, discard the result and return to step 1.</li>
<li>Output the string.</li>
</ol>
</li>
<li><a class="el" href="psa__crypto_2psa_2key_2type_8h.html#a577562bfbbc691c820d55ec308333138">PSA_KEY_TYPE_DES</a>, 192 bits</li>
<li><a class="el" href="psa__crypto_2psa_2key_2type_8h.html#a577562bfbbc691c820d55ec308333138">PSA_KEY_TYPE_DES</a>, 128 bits The two or three keys are generated by repeated application of the process used to generate a DES key. For example, for 3-key 3DES, if the first 8 bytes specify a weak key and the next 8 bytes do not, discard the first 8 bytes, use the next 8 bytes as the first key, and continue reading output from the operation to derive the other two keys.</li>
</ul>
</li>
<li>For Finite-field Diffie-Hellman keys <a class="el" href="psa__crypto_2psa_2key_2type_8h.html#ab4f857c4cd56f5fe65ded421e61bcc8c">PSA_KEY_TYPE_DH_KEY_PAIR</a>(<code>dh_family</code>) where <code>dh_family</code> designates any Diffie-Hellman family.</li>
<li>ECC keys on a Weierstrass elliptic curve (<a class="el" href="psa__crypto_2psa_2key_2type_8h.html#a0b6f5d4d5037c54ffa850d8059c32df0">PSA_KEY_TYPE_ECC_KEY_PAIR</a>( <code>ecc_family</code>) where <code>ecc_family</code> designates a Weierstrass curve family.) require the generation of a private key which is an integer in the range [1, N - 1], where N is the boundary of the private key domain: N is the prime p for Diffie-Hellman, or the order of the curves base point for ECC. Let m be the bit size of N, such that 2^m &gt; N &gt;= 2^(m-1). This function generates the private key using the following process:<ol type="1">
<li>Draw a byte string of length ceiling(m/8) bytes.</li>
<li>If m is not a multiple of 8, set the most significant (8 * ceiling(m/8) - m) bits of the first byte in the string to zero.</li>
<li>Convert the string to integer k by decoding it as a big-endian byte string.</li>
<li>If k &gt; N - 2, discard the result and return to step 1.</li>
<li>Output k + 1 as the private key. This method allows compliance to NIST standards, specifically the methods titled Key-Pair Generation by Testing Candidates in the following publications:</li>
</ol>
<ul>
<li>NIST Special Publication 800-56A: Recommendation for Pair-Wise Key-Establishment Schemes Using Discrete Logarithm Cryptography SP800-56A 5.6.1.1.4 for Diffie-Hellman keys.</li>
<li>SP800-56A 5.6.1.2.2 or FIPS Publication 186-4: Digital Signature Standard (DSS) FIPS186-4 B.4.2 for elliptic curve keys.</li>
</ul>
</li>
<li>For ECC keys on a Montgomery elliptic curve (where <a class="el" href="psa__crypto_2psa_2key_2type_8h.html#a0b6f5d4d5037c54ffa850d8059c32df0">PSA_KEY_TYPE_ECC_KEY_PAIR</a> (<a class="el" href="psa__crypto_2psa_2key_2type_8h.html#a1f624c5cdaf25b21287af33024e1aff8">PSA_ECC_FAMILY_MONTGOMERY</a>)) this function always draws a byte string whose length is determined by the curve, and sets the mandatory bits accordingly. That is:<ul>
<li>Curve25519 (<a class="el" href="psa__crypto_2psa_2key_2type_8h.html#a1f624c5cdaf25b21287af33024e1aff8">PSA_ECC_FAMILY_MONTGOMERY</a>, 255 bits): draw a 32-byte string and process it as specified in Elliptic Curves for Security RFC7748 5.</li>
<li>Curve448 (<a class="el" href="psa__crypto_2psa_2key_2type_8h.html#a1f624c5cdaf25b21287af33024e1aff8">PSA_ECC_FAMILY_MONTGOMERY</a>, 448 bits): draw a 56-byte string and process it as specified in RFC7748 5.</li>
</ul>
</li>
</ul>
<p>In all cases, the data that is read is discarded from the operation. The operations capacity is decreased by the number of bytes read.</p>
<p>For algorithms that take an input step <a class="el" href="crypto__values_8h.html#a0ddfbe764baba995c402b1b0ef59392e">PSA_KEY_DERIVATION_INPUT_SECRET</a>, the input to that step must be provided with <a class="el" href="crypto_8h.html#aa936b9b1f6264beb6e23afd5f87bcccc">psa_key_derivation_input_key()</a>. Future versions of this specification might include additional restrictions on the derived key based on the attributes and strength of the secret key.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">attributes</td><td>The attributes for the new key. This function uses the attributes as follows:<ul>
<li>The key type is required. It cannot be an asymmetric public key.</li>
<li>The key size is required. It must be a valid size for the key type.</li>
<li>The key permitted-algorithm policy is required for keys that will be used for a cryptographic operation.</li>
<li>If the key type to be created is <a class="el" href="psa__crypto_2psa_2key_2type_8h.html#ac41a0d5fdafc1c19ae73313613142723">PSA_KEY_TYPE_PASSWORD_HASH</a>, then the permitted-algorithm policy must be the same as the current operations algorithm.</li>
<li>The key usage flags define what operations are permitted with the key.</li>
<li>The key lifetime and identifier are required for a persistent key. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This is an input parameter: it is not updated with the final key attributes. The final attributes of the new key can be queried by calling <a class="el" href="crypto_8h.html#a8e70d36a3db2ec34425722166f5fa75b">psa_get_key_attributes()</a> with the keys identifier. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>The key derivation operation object to read from. </td></tr>
    <tr><td class="paramname">key</td><td>On success, an identifier for the newly created key. <a class="el" href="id_8h.html#a650b5f7c553bf6f8db2076dbd9f4dd44">PSA_KEY_ID_NULL</a> on failure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. If the key is persistent, the key material and the keys metadata have been saved to persistent storage. </dd>
<dd>
PSA_ERROR_BAD_STATE The following conditions can result in this error:<ul>
<li>The operation state is not valid: it must be active, with all required input steps complete.</li>
<li>The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_NOT_PERMITTED The following conditions can result in this error:<ul>
<li>The <a class="el" href="crypto__values_8h.html#a0ddfbe764baba995c402b1b0ef59392e">PSA_KEY_DERIVATION_INPUT_SECRET</a> input step was neither provided through a key, nor the result of a key agreement.</li>
<li>One of the inputs was a key whose policy did not allow <a class="el" href="usage_8h.html#af19022acc5ef23cf12477f632b48a0b2">PSA_KEY_USAGE_DERIVE</a>.</li>
<li>The implementation does not permit creating a key with the specified attributes due to some implementation-specific policy. </li>
</ul>
</dd>
<dd>
PSA_ERROR_ALREADY_EXISTS This is an attempt to create a persistent key, and there is already a persistent key with the given identifier. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_DATA There was not enough data to create the desired key. In this case, the following occurs:<ul>
<li>No key is generated.</li>
<li>The operations capacity is set to zero  subsequent calls to this function will not succeed, even if they require less data. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The following conditions can result in this error:<ul>
<li>The key type is invalid, or is an asymmetric public key type.</li>
<li>The key type is <a class="el" href="psa__crypto_2psa_2key_2type_8h.html#ac41a0d5fdafc1c19ae73313613142723">PSA_KEY_TYPE_PASSWORD_HASH</a>, and the permitted-algorithm policy is not the same as the current operations algorithm.</li>
<li>The key size is not valid for the key type.</li>
<li>The key lifetime is invalid.</li>
<li>The key identifier is not valid for the key lifetime.</li>
<li>The key usage flags include invalid values.</li>
<li>The keys permitted-usage algorithm is invalid.</li>
<li>The key attributes, as a whole, are invalid. </li>
</ul>
</dd>
<dd>
PSA_ERROR_NOT_SUPPORTED The key attributes, as a whole, are not supported, either by the implementation in general or in the specified storage location. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_INSUFFICIENT_STORAGE </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="a8c26178dc8e4581cb9fbce5650db3279"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c26178dc8e4581cb9fbce5650db3279">&#9670;&nbsp;</a></span>psa_key_derivation_set_capacity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_key_derivation_set_capacity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a1ad89f1ce73274b54b6557dda5ee6290">psa_key_derivation_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>capacity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the maximum capacity of a key derivation operation. </p>
<p>The capacity of a key derivation operation is the maximum number of bytes that the key derivation operation can return from this point onwards.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>The key derivation operation object to modify. </td></tr>
    <tr><td class="paramname">capacity</td><td>The new capacity of the operation. It must be less or equal to the operations current capacity. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. </dd>
<dd>
PSA_ERROR_BAD_STATE The following conditions can result in this error:<ul>
<li>The operation state is not valid: it must be active.</li>
<li>The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT <code>capacity</code> is larger than the operations current capacity. In this case, the operation object remains valid and its capacity remains unchanged. </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd></dl>

</div>
</div>
<a id="ac0b6a76e45cceb1862752bf041701859"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0b6a76e45cceb1862752bf041701859">&#9670;&nbsp;</a></span>psa_key_derivation_setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_key_derivation_setup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a1ad89f1ce73274b54b6557dda5ee6290">psa_key_derivation_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">psa_algorithm_t&#160;</td>
          <td class="paramname"><em>alg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set up a key derivation operation. </p>
<p>A key derivation algorithm takes some inputs and uses them to generate a byte stream in a deterministic way. This byte stream can be used to produce keys and other cryptographic material.</p>
<p>A key agreement and derivation algorithm uses a key agreement protocol to provide a shared secret which is used for the key derivation. See <a class="el" href="crypto_8h.html#a4da37a87ff9863e2a61eccefd331254a">psa_key_derivation_key_agreement()</a>.</p>
<p>To derive a key:</p><ol type="1">
<li>Start with an initialized object of type <a class="el" href="crypto__types_8h.html#a1ad89f1ce73274b54b6557dda5ee6290">psa_key_derivation_operation_t</a>.</li>
<li>Call <a class="el" href="crypto_8h.html#ac0b6a76e45cceb1862752bf041701859">psa_key_derivation_setup()</a> to select the algorithm.</li>
<li>Provide the inputs for the key derivation by calling <a class="el" href="crypto_8h.html#a8fd934dfb0ca45cbf89542ef2a5494c2">psa_key_derivation_input_bytes()</a> or <a class="el" href="crypto_8h.html#aa936b9b1f6264beb6e23afd5f87bcccc">psa_key_derivation_input_key()</a> as appropriate. Which inputs are needed, in what order, whether keys are permitted, and what type of keys depends on the algorithm.</li>
<li>Optionally set the operations maximum capacity with <a class="el" href="crypto_8h.html#a8c26178dc8e4581cb9fbce5650db3279">psa_key_derivation_set_capacity()</a>. This can be done before, in the middle of, or after providing inputs. For some algorithms, this step is mandatory because the output depends on the maximum capacity.</li>
<li>To derive a key, call <a class="el" href="crypto_8h.html#ad286b675f3f8b46fa6cab620de6bead3">psa_key_derivation_output_key()</a>. To derive a byte string for a different purpose, call <a class="el" href="crypto_8h.html#a06b7eb34a2fa88965f68e3d023fa12b9">psa_key_derivation_output_bytes()</a>. Successive calls to these functions use successive output bytes calculated by the key derivation algorithm.</li>
<li>Clean up the key derivation operation object with <a class="el" href="crypto_8h.html#a90fdd2716124d0bd258826184824675f">psa_key_derivation_abort()</a>.</li>
</ol>
<p>If this function returns an error, the key derivation operation object is not changed.</p>
<p>If an error occurs at any step after a call to <a class="el" href="crypto_8h.html#ac0b6a76e45cceb1862752bf041701859">psa_key_derivation_setup()</a>, the operation will need to be reset by a call to <a class="el" href="crypto_8h.html#a90fdd2716124d0bd258826184824675f">psa_key_derivation_abort()</a>.</p>
<p>Implementations must reject an attempt to derive a key of size 0.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>The key derivation operation object to set up. It must have been initialized but not set up yet. </td></tr>
    <tr><td class="paramname">alg</td><td>The algorithm to compute. This must be one of the following:<ul>
<li>A key derivation algorithm: a value of type psa_algorithm_t such that <a class="el" href="key__derivation_2algorithm_8h.html#af8b90c648aa53dbd06c236695e300cd0">PSA_ALG_IS_KEY_DERIVATION</a>(<code>alg</code>) is true.</li>
<li>A key agreement and derivation algorithm: a value of type psa_algorithm_t such that <a class="el" href="key__agreement_2algorithm_8h.html#a59753742cb06553bd22751bbef472b6f">PSA_ALG_IS_KEY_AGREEMENT</a>(<code>alg</code>) is true and <a class="el" href="key__agreement_2algorithm_8h.html#aa40ab362ce141ce541d69b2eb1f41438">PSA_ALG_IS_RAW_KEY_AGREEMENT</a>(<code>alg</code>) is false.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. </dd>
<dd>
PSA_ERROR_BAD_STATE The following conditions can result in this error:<ul>
<li>The operation state is not valid: it must be inactive.</li>
<li>The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT <code>alg</code> is neither a key derivation algorithm, nor a key agreement and derivation algorithm. </dd>
<dd>
PSA_ERROR_NOT_SUPPORTED <code>alg</code> is not supported or is not a key derivation algorithm, or a key agreement and derivation algorithm. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd></dl>

</div>
</div>
<a id="af01520beb7ba932143ffe733b0795b08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af01520beb7ba932143ffe733b0795b08">&#9670;&nbsp;</a></span>psa_key_derivation_verify_bytes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_key_derivation_verify_bytes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a1ad89f1ce73274b54b6557dda5ee6290">psa_key_derivation_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>expected_output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>output_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compare output data from a key derivation operation to an expected value. </p>
<p>This function calculates output bytes from a key derivation algorithm and compares those bytes to an expected value. If the key derivations output is viewed as a stream of bytes, this function destructively reads <code>output_length</code> bytes from the stream before comparing them with <code>expected_output</code>. The operations capacity decreases by the number of bytes read.</p>
<p>This is functionally equivalent to the following code: </p><div class="fragment"><div class="line">uint8_t tmp[output_length];</div><div class="line"><a class="code" href="crypto_8h.html#a06b7eb34a2fa88965f68e3d023fa12b9">psa_key_derivation_output_bytes</a>(operation, tmp, output_length);</div><div class="line"><span class="keywordflow">if</span> (memcmp(expected_output, tmp, output_length) != 0)</div><div class="line">     <span class="keywordflow">return</span> PSA_ERROR_INVALID_SIGNATURE;</div></div><!-- fragment --><p>However, calling <a class="el" href="crypto_8h.html#af01520beb7ba932143ffe733b0795b08">psa_key_derivation_verify_bytes()</a> works even if the keys policy does not allow output of the bytes.</p>
<p>If this function returns an error status other than PSA_ERROR_INSUFFICIENT_DATA or PSA_ERROR_INVALID_SIGNATURE, the operation enters an error state and must be aborted by calling <a class="el" href="crypto_8h.html#a90fdd2716124d0bd258826184824675f">psa_key_derivation_abort()</a>.</p>
<dl class="section note"><dt>Note</dt><dd>Implementations must make the best effort to ensure that the comparison between the actual key derivation output and the expected output is performed in constant time.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>The key derivation operation object to read from. </td></tr>
    <tr><td class="paramname">expected_output</td><td>Buffer containing the expected derivation output. </td></tr>
    <tr><td class="paramname">output_length</td><td>Length ot the expected output. This is also the number of bytes that will be read.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. The output of the key derivation operation matches expected_output. </dd>
<dd>
PSA_ERROR_BAD_STATE The following conditions can result in this error:<ul>
<li>The operation state is not valid: it must be active, with all required input steps complete.</li>
<li>The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_NOT_PERMITTED One of the inputs is a key whose policy does not permit <a class="el" href="usage_8h.html#a25aece70be2b79afbdb4180f7c4e68ed">PSA_KEY_USAGE_VERIFY_DERIVATION</a>. </dd>
<dd>
PSA_ERROR_INVALID_SIGNATURE The output of the key derivation operation does not match the value in expected_output. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_DATA The operations capacity was less than <code>output_length</code> bytes. In this case, the operations capacity is set to zero  subsequent calls to this function will not succeed, even with a smaller expected output length. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="ac041714e34a94742e8ee006ac7dfea5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac041714e34a94742e8ee006ac7dfea5a">&#9670;&nbsp;</a></span>psa_key_derivation_verify_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_key_derivation_verify_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a1ad89f1ce73274b54b6557dda5ee6290">psa_key_derivation_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>expected</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compare output data from a key derivation operation to an expected value stored in a key. </p>
<p>This function calculates output bytes from a key derivation algorithm and compares those bytes to an expected value, provided as key of type <a class="el" href="psa__crypto_2psa_2key_2type_8h.html#ac41a0d5fdafc1c19ae73313613142723">PSA_KEY_TYPE_PASSWORD_HASH</a>. If the key derivations output is viewed as a stream of bytes, this function destructively reads the number of bytes corresponding to the length of the expected key from the stream before comparing them with the key value. The operations capacity decreases by the number of bytes read.</p>
<p>This is functionally equivalent to exporting the expected key and calling <a class="el" href="crypto_8h.html#af01520beb7ba932143ffe733b0795b08">psa_key_derivation_verify_bytes()</a> on the result, except that it works when the key cannot be exported.</p>
<p>If this function returns an error status other than PSA_ERROR_INSUFFICIENT_DATA or PSA_ERROR_INVALID_SIGNATURE, the operation enters an error state and must be aborted by calling <a class="el" href="crypto_8h.html#a90fdd2716124d0bd258826184824675f">psa_key_derivation_abort()</a>.</p>
<dl class="section note"><dt>Note</dt><dd>Implementations must make the best effort to ensure that the comparison between the actual key derivation output and the expected output is performed in constant time.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>The key derivation operation object to read from. </td></tr>
    <tr><td class="paramname">expected</td><td>A key of type <a class="el" href="psa__crypto_2psa_2key_2type_8h.html#ac41a0d5fdafc1c19ae73313613142723">PSA_KEY_TYPE_PASSWORD_HASH</a> containing the expected output. The key must allow the usage <a class="el" href="usage_8h.html#a25aece70be2b79afbdb4180f7c4e68ed">PSA_KEY_USAGE_VERIFY_DERIVATION</a>, and the permitted algorithm must match the operations algorithm. The value of this key is typically computed by a previous call to <a class="el" href="crypto_8h.html#ad286b675f3f8b46fa6cab620de6bead3">psa_key_derivation_output_key()</a>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. The output of the key derivation operation matches the expected key value. </dd>
<dd>
PSA_ERROR_BAD_STATE The following conditions can result in this error:<ul>
<li>The operation state is not valid: it must be active, with all required input steps complete.</li>
<li>The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INVALID_HANDLE <code>expected</code> is not a valid key identifier. </dd>
<dd>
PSA_ERROR_NOT_PERMITTED The following conditions can result in this error:<ul>
<li>The key does not have the <a class="el" href="usage_8h.html#a25aece70be2b79afbdb4180f7c4e68ed">PSA_KEY_USAGE_VERIFY_DERIVATION</a> flag, or it does not permit the requested algorithm.</li>
<li>One of the inputs is a key whose policy does not permit <a class="el" href="usage_8h.html#a25aece70be2b79afbdb4180f7c4e68ed">PSA_KEY_USAGE_VERIFY_DERIVATION</a>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INVALID_SIGNATURE The output of the key derivation operation does not match the value of the expected key. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_DATA The operations capacity was less than the length of the <code>expected</code> key. In this case, the operations capacity is set to zero  subsequent calls to this function will not succeed, even with a smaller expected key length. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The key type is not <a class="el" href="psa__crypto_2psa_2key_2type_8h.html#ac41a0d5fdafc1c19ae73313613142723">PSA_KEY_TYPE_PASSWORD_HASH</a>. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="acd8dd54855ba1bc0a03f104f252884fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd8dd54855ba1bc0a03f104f252884fd">&#9670;&nbsp;</a></span>psa_mac_abort()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_mac_abort </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a78f0838b0c4e3db28b26355624d4bd37">psa_mac_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Abort a MAC operation. </p>
<p>Aborting an operation frees all associated resources except for the operation object itself. Once aborted, the operation object can be reused for another operation by calling <a class="el" href="crypto_8h.html#a6420e166df3967edf60042e589facd04">psa_mac_sign_setup()</a> or <a class="el" href="crypto_8h.html#a715679bbf633be958fa447216127eaf8">psa_mac_verify_setup()</a> again.</p>
<p>This function can be called any time after the operation object has been initialized by one of the methods described in <a class="el" href="crypto__types_8h.html#a78f0838b0c4e3db28b26355624d4bd37">psa_mac_operation_t</a>.</p>
<p>In particular, calling <a class="el" href="crypto_8h.html#acd8dd54855ba1bc0a03f104f252884fd">psa_mac_abort()</a> after the operation has been terminated by a call to <a class="el" href="crypto_8h.html#acd8dd54855ba1bc0a03f104f252884fd">psa_mac_abort()</a>, <a class="el" href="crypto_8h.html#ac22bc0125580c96724a09226cfbc97f2">psa_mac_sign_finish()</a> or <a class="el" href="crypto_8h.html#ac92b2930d6728e1be4d011c05d485822">psa_mac_verify_finish()</a> is safe and has no effect.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>Initialized MAC operation. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. The operation object can now be discarded or reused. </dd>
<dd>
PSA_ERROR_BAD_STATE The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd></dl>

</div>
</div>
<a id="afb4c0e338fdc192ef8d293aa545d94cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb4c0e338fdc192ef8d293aa545d94cb">&#9670;&nbsp;</a></span>psa_mac_compute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_mac_compute </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">psa_algorithm_t&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>input_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>mac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>mac_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>mac_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the message authentication code (MAC) of a message. </p>
<dl class="section note"><dt>Note</dt><dd>To verify the MAC of a message against an expected value, use <a class="el" href="crypto_8h.html#aa5542f4a1c590d76c329125d571cf494">psa_mac_verify()</a> instead. Beware that comparing integrity or authenticity data such as MAC values with a function such as <code>memcmp()</code> is risky because the time taken by the comparison might leak information about the MAC value which could allow an attacker to guess a valid MAC and thereby bypass security controls.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Identifier of the key to use for the operation. It must allow the usage <a class="el" href="usage_8h.html#a552117ac92b79500cae87d4e65a85c54">PSA_KEY_USAGE_SIGN_MESSAGE</a>. </td></tr>
    <tr><td class="paramname">alg</td><td>The MAC algorithm to compute (PSA_ALG_XXX value such that <a class="el" href="mac_2algorithm_8h.html#aca7aee4c9dde316b3b1a150a26eab776">PSA_ALG_IS_MAC</a>(<code>alg</code>) is true). </td></tr>
    <tr><td class="paramname">input</td><td>Buffer containing the input message. </td></tr>
    <tr><td class="paramname">input_length</td><td>Size of the input buffer in bytes. </td></tr>
    <tr><td class="paramname">mac</td><td>Buffer where the MAC value is to be written. </td></tr>
    <tr><td class="paramname">mac_size</td><td>Size of the mac buffer in bytes. This must be appropriate for the selected algorithm and key:<ul>
<li>The exact MAC size is <a class="el" href="crypto__sizes_8h.html#a4c1151a9816184287aa5f76e82e16080">PSA_MAC_LENGTH</a>(<code>key_type</code>, <code>key_bits</code>, <code>alg</code>) where <code>key_type</code> and <code>key_bits</code> are attributes of the key used to compute the MAC.</li>
<li><a class="el" href="crypto__sizes_8h.html#a4681cc4f6226883a2160122c562ca682">PSA_MAC_MAX_SIZE</a> evaluates to the maximum MAC size of any supported MAC algorithm. </li>
</ul>
</td></tr>
    <tr><td class="paramname">mac_length</td><td>On success, the number of bytes that make up the MAC value.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. The first <code></code>(*mac_length) bytes of <code>mac</code> contain the MAC value. </dd>
<dd>
PSA_ERROR_BAD_STATE The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </dd>
<dd>
PSA_ERROR_INVALID_HANDLE <code>key</code> is not a valid key identifier. </dd>
<dd>
PSA_ERROR_NOT_PERMITTED The key does not have the <a class="el" href="usage_8h.html#a552117ac92b79500cae87d4e65a85c54">PSA_KEY_USAGE_SIGN_MESSAGE</a> flag, or it does not permit the requested algorithm. </dd>
<dd>
PSA_ERROR_BUFFER_TOO_SMALL The size of the mac buffer is too small. <a class="el" href="crypto__sizes_8h.html#a4c1151a9816184287aa5f76e82e16080">PSA_MAC_LENGTH()</a> or <a class="el" href="crypto__sizes_8h.html#a4681cc4f6226883a2160122c562ca682">PSA_MAC_MAX_SIZE</a> can be used to determine a sufficient buffer size. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The following conditions can result in this error:<ul>
<li><code>alg</code> is not a MAC algorithm.</li>
<li><code>key</code> is not compatible with <code>alg</code>.</li>
<li><code>input_length</code> is too large for <code>alg</code>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_NOT_SUPPORTED The following conditions can result in this error:<ul>
<li><code>alg</code> is not supported or is not a MAC algorithm.</li>
<li><code>key</code> is not supported for use with <code>alg</code>.</li>
<li><code>input_length</code> is too large for the implementation. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="ac22bc0125580c96724a09226cfbc97f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac22bc0125580c96724a09226cfbc97f2">&#9670;&nbsp;</a></span>psa_mac_sign_finish()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_mac_sign_finish </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a78f0838b0c4e3db28b26355624d4bd37">psa_mac_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>mac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>mac_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>mac_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finish the calculation of the MAC of a message. </p>
<p>The application must call <a class="el" href="crypto_8h.html#a6420e166df3967edf60042e589facd04">psa_mac_sign_setup()</a> before calling this function. This function calculates the MAC of the message formed by concatenating the inputs passed to preceding calls to <a class="el" href="crypto_8h.html#a5560af371497babefe03c9da4e8a1c05">psa_mac_update()</a>.</p>
<p>When this function returns successfully, the operation becomes inactive. If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="crypto_8h.html#acd8dd54855ba1bc0a03f104f252884fd">psa_mac_abort()</a>.</p>
<dl class="section warning"><dt>Warning</dt><dd>It is not recommended to use this function when a specific value is expected for the MAC. Call <a class="el" href="crypto_8h.html#ac92b2930d6728e1be4d011c05d485822">psa_mac_verify_finish()</a> instead with the expected MAC value. Comparing integrity or authenticity data such as MAC values with a function such as <code>memcmp()</code> is risky because the time taken by the comparison might leak information about the hashed data which could allow an attacker to guess a valid MAC and thereby bypass security controls.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>Active MAC operation. </td></tr>
    <tr><td class="paramname">mac</td><td>Buffer where the MAC value is to be written. </td></tr>
    <tr><td class="paramname">mac_size</td><td>Size of the mac buffer in bytes. This must be appropriate for the selected algorithm and key:<ul>
<li>The exact MAC size is <a class="el" href="crypto__sizes_8h.html#a4c1151a9816184287aa5f76e82e16080">PSA_MAC_LENGTH</a>(<code>key_type</code>, <code>key_bits</code>, <code>alg</code>) where <code>key_type</code> and <code>key_bits</code> are attributes of the key, and <code>alg</code> is the algorithm used to compute the MAC.</li>
<li><a class="el" href="crypto__sizes_8h.html#a4681cc4f6226883a2160122c562ca682">PSA_MAC_MAX_SIZE</a> evaluates to the maximum MAC size of any supported MAC algorithm. </li>
</ul>
</td></tr>
    <tr><td class="paramname">mac_length</td><td>On success, the number of bytes that make up the MAC value. This is always <a class="el" href="crypto__sizes_8h.html#a4c1151a9816184287aa5f76e82e16080">PSA_MAC_LENGTH</a>(<code>key_type</code>, <code>key_bits</code>, <code>alg</code>) where <code>key_type</code> and <code>key_bits</code> are attributes of the key, and <code>alg</code> is the algorithm used to compute the MAC. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. The first <code></code>(*mac_length) bytes of mac contain the MAC value. </dd>
<dd>
PSA_ERROR_BAD_STATE The following conditions can result in this error:<ul>
<li>The operation state is not valid: it must be an active mac sign operation.</li>
<li>The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_BUFFER_TOO_SMALL The size of the mac buffer is too small. <a class="el" href="crypto__sizes_8h.html#a4c1151a9816184287aa5f76e82e16080">PSA_MAC_LENGTH()</a> or <a class="el" href="crypto__sizes_8h.html#a4681cc4f6226883a2160122c562ca682">PSA_MAC_MAX_SIZE</a> can be used to determine a sufficient buffer size. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="a6420e166df3967edf60042e589facd04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6420e166df3967edf60042e589facd04">&#9670;&nbsp;</a></span>psa_mac_sign_setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_mac_sign_setup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a78f0838b0c4e3db28b26355624d4bd37">psa_mac_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">psa_algorithm_t&#160;</td>
          <td class="paramname"><em>alg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set up a multi-part MAC calculation operation. </p>
<p>This function sets up the calculation of the message authentication code (MAC) of a byte string. To verify the MAC of a message against an expected value, use <a class="el" href="crypto_8h.html#a715679bbf633be958fa447216127eaf8">psa_mac_verify_setup()</a> instead.</p>
<p>The sequence of operations to calculate a MAC is as follows:</p><ol type="1">
<li>Allocate an operation object which will be passed to all the functions listed here.</li>
<li>Initialize the operation object with one of the methods described in the documentation for <a class="el" href="crypto__types_8h.html#a78f0838b0c4e3db28b26355624d4bd37">psa_mac_operation_t</a>, e.g. <a class="el" href="crypto__struct_8h.html#a441b6efc161a4573d06465bd22d9dc2d">PSA_MAC_OPERATION_INIT</a>.</li>
<li>Call <a class="el" href="crypto_8h.html#a6420e166df3967edf60042e589facd04">psa_mac_sign_setup()</a> to specify the algorithm and key.</li>
<li>Call <a class="el" href="crypto_8h.html#a5560af371497babefe03c9da4e8a1c05">psa_mac_update()</a> zero, one or more times, passing a fragment of the message each time. The MAC that is calculated is the MAC of the concatenation of these messages in order.</li>
<li>At the end of the message, call <a class="el" href="crypto_8h.html#ac22bc0125580c96724a09226cfbc97f2">psa_mac_sign_finish()</a> to finish calculating the MAC value and retrieve it.</li>
</ol>
<p>If an error occurs at any step after a call to <a class="el" href="crypto_8h.html#a6420e166df3967edf60042e589facd04">psa_mac_sign_setup()</a>, the operation will need to be reset by a call to <a class="el" href="crypto_8h.html#acd8dd54855ba1bc0a03f104f252884fd">psa_mac_abort()</a>. The application can call <a class="el" href="crypto_8h.html#acd8dd54855ba1bc0a03f104f252884fd">psa_mac_abort()</a> at any time after the operation has been initialized.</p>
<p>After a successful call to <a class="el" href="crypto_8h.html#a6420e166df3967edf60042e589facd04">psa_mac_sign_setup()</a>, the application must eventually terminate the operation through one of the following methods:</p><ul>
<li>A successful call to <a class="el" href="crypto_8h.html#ac22bc0125580c96724a09226cfbc97f2">psa_mac_sign_finish()</a>.</li>
<li>A call to <a class="el" href="crypto_8h.html#acd8dd54855ba1bc0a03f104f252884fd">psa_mac_abort()</a>.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>The operation object to set up. It must have been initialized as per the documentation for <a class="el" href="crypto__types_8h.html#a78f0838b0c4e3db28b26355624d4bd37">psa_mac_operation_t</a> and not yet in use. </td></tr>
    <tr><td class="paramname">key</td><td>Identifier of the key to use for the operation. It must remain valid until the operation terminates. It must allow the usage <a class="el" href="usage_8h.html#a552117ac92b79500cae87d4e65a85c54">PSA_KEY_USAGE_SIGN_MESSAGE</a>. </td></tr>
    <tr><td class="paramname">alg</td><td>The MAC algorithm to compute: a value of type psa_algorithm_t such that <a class="el" href="mac_2algorithm_8h.html#aca7aee4c9dde316b3b1a150a26eab776">PSA_ALG_IS_MAC</a>(<code>alg</code>) is true. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. </dd>
<dd>
PSA_ERROR_BAD_STATE The following conditions can result in this error:<ul>
<li>The operation state is not valid: it must be inactive.</li>
<li>The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INVALID_HANDLE <code>key</code> is not a valid key identifier. </dd>
<dd>
PSA_ERROR_NOT_PERMITTED The key does not have the <a class="el" href="usage_8h.html#a552117ac92b79500cae87d4e65a85c54">PSA_KEY_USAGE_SIGN_MESSAGE</a> flag, or it does not permit the requested algorithm. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The following conditions can result in this error:<ul>
<li><code>alg</code> is not a MAC algorithm.</li>
<li><code>key</code> is not compatible with <code>alg</code>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_NOT_SUPPORTED The following conditions can result in this error:<ul>
<li><code>alg</code> is not supported or is not a MAC algorithm.</li>
<li><code>key</code> is not supported for use with <code>alg</code>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="a5560af371497babefe03c9da4e8a1c05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5560af371497babefe03c9da4e8a1c05">&#9670;&nbsp;</a></span>psa_mac_update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_mac_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a78f0838b0c4e3db28b26355624d4bd37">psa_mac_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>input_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a message fragment to a multi-part MAC operation. </p>
<p>The application must call <a class="el" href="crypto_8h.html#a6420e166df3967edf60042e589facd04">psa_mac_sign_setup()</a> or <a class="el" href="crypto_8h.html#a715679bbf633be958fa447216127eaf8">psa_mac_verify_setup()</a> before calling this function.</p>
<p>If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="crypto_8h.html#acd8dd54855ba1bc0a03f104f252884fd">psa_mac_abort()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>Active MAC operation. </td></tr>
    <tr><td class="paramname">input</td><td>Buffer containing the message fragment to add to the MAC calculation. </td></tr>
    <tr><td class="paramname">input_length</td><td>Size of the <code>input</code> buffer in bytes. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. </dd>
<dd>
PSA_ERROR_BAD_STATE The following conditions can result in this error:<ul>
<li>The operation state is not valid: it must be active.</li>
<li>The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The total input for the operation is too large for the MAC algorithm. </dd>
<dd>
PSA_ERROR_NOT_SUPPORTED The total input for the operation is too large for the implementation. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="aa5542f4a1c590d76c329125d571cf494"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5542f4a1c590d76c329125d571cf494">&#9670;&nbsp;</a></span>psa_mac_verify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_mac_verify </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">psa_algorithm_t&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>input_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>mac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>mac_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the MAC of a message and compare it with a reference value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Identifier of the key to use for the operation. It must allow the usage <a class="el" href="usage_8h.html#abea7ec4173f4f943110329ac2953b2b1">PSA_KEY_USAGE_VERIFY_MESSAGE</a>. </td></tr>
    <tr><td class="paramname">alg</td><td>The MAC algorithm to compute: a value of type psa_algorithm_t such that <a class="el" href="mac_2algorithm_8h.html#aca7aee4c9dde316b3b1a150a26eab776">PSA_ALG_IS_MAC</a>(<code>alg</code>) is true. </td></tr>
    <tr><td class="paramname">input</td><td>Buffer containing the input message. </td></tr>
    <tr><td class="paramname">input_length</td><td>Size of the <code>input</code> buffer in bytes. </td></tr>
    <tr><td class="paramname">mac</td><td>Buffer containing the expected MAC value. </td></tr>
    <tr><td class="paramname">mac_length</td><td>Size of the <code>mac</code> buffer in bytes. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. The expected MAC is identical to the actual MAC of the input. </dd>
<dd>
PSA_ERROR_BAD_STATE The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </dd>
<dd>
PSA_ERROR_INVALID_HANDLE <code>key</code> is not a valid key identifier. </dd>
<dd>
PSA_ERROR_NOT_PERMITTED The key does not have the <a class="el" href="usage_8h.html#abea7ec4173f4f943110329ac2953b2b1">PSA_KEY_USAGE_VERIFY_MESSAGE</a> flag, or it does not permit the requested algorithm. </dd>
<dd>
PSA_ERROR_INVALID_SIGNATURE The calculated MAC of the message does not match the value in <code>mac</code>. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The following conditions can result in this error:<ul>
<li><code>alg</code> is not a MAC algorithm.</li>
<li><code>key</code> is not compatible with <code>alg</code>.</li>
<li><code>input_length</code> is too large for <code>alg</code>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_NOT_SUPPORTED The following conditions can result in this error:<ul>
<li><code>alg</code> is not supported or is not a MAC algorithm.</li>
<li><code>key</code> is not supported for use with <code>alg</code>.</li>
<li><code>input_length</code> is too large for the implementation. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="ac92b2930d6728e1be4d011c05d485822"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac92b2930d6728e1be4d011c05d485822">&#9670;&nbsp;</a></span>psa_mac_verify_finish()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_mac_verify_finish </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a78f0838b0c4e3db28b26355624d4bd37">psa_mac_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>mac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>mac_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finish the calculation of the MAC of a message and compare it with an expected value. </p>
<p>The application must call <a class="el" href="crypto_8h.html#a715679bbf633be958fa447216127eaf8">psa_mac_verify_setup()</a> before calling this function. This function calculates the MAC of the message formed by concatenating the inputs passed to preceding calls to <a class="el" href="crypto_8h.html#a5560af371497babefe03c9da4e8a1c05">psa_mac_update()</a>. It then compares the calculated MAC with the expected MAC passed as a parameter to this function.</p>
<p>When this function returns successfully, the operation becomes inactive. If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="crypto_8h.html#acd8dd54855ba1bc0a03f104f252884fd">psa_mac_abort()</a>.</p>
<dl class="section note"><dt>Note</dt><dd>Implementations must make the best effort to ensure that the comparison between the actual MAC and the expected MAC is performed in constant time.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>Active MAC operation. </td></tr>
    <tr><td class="paramname">mac</td><td>Buffer containing the expected MAC value. </td></tr>
    <tr><td class="paramname">mac_length</td><td>Size of the <code>mac</code> buffer in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. The expected MAC is identical to the actual MAC of the message. </dd>
<dd>
PSA_ERROR_BAD_STATE The following conditions can result in this error:<ul>
<li>The operation state is not valid: it must be an active mac verify operation.</li>
<li>The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INVALID_SIGNATURE The calculated MAC of the message does not match the value in mac. </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="a715679bbf633be958fa447216127eaf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a715679bbf633be958fa447216127eaf8">&#9670;&nbsp;</a></span>psa_mac_verify_setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_mac_verify_setup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__types_8h.html#a78f0838b0c4e3db28b26355624d4bd37">psa_mac_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">psa_algorithm_t&#160;</td>
          <td class="paramname"><em>alg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set up a multi-part MAC verification operation. </p>
<p>This function sets up the verification of the message authentication code (MAC) of a byte string against an expected value.</p>
<p>The sequence of operations to verify a MAC is as follows:</p><ol type="1">
<li>Allocate an operation object which will be passed to all the functions listed here.</li>
<li>Initialize the operation object with one of the methods described in the documentation for <a class="el" href="crypto__types_8h.html#a78f0838b0c4e3db28b26355624d4bd37">psa_mac_operation_t</a>, e.g. <a class="el" href="crypto__struct_8h.html#a441b6efc161a4573d06465bd22d9dc2d">PSA_MAC_OPERATION_INIT</a>.</li>
<li>Call <a class="el" href="crypto_8h.html#a715679bbf633be958fa447216127eaf8">psa_mac_verify_setup()</a> to specify the algorithm and key.</li>
<li>Call <a class="el" href="crypto_8h.html#a5560af371497babefe03c9da4e8a1c05">psa_mac_update()</a> zero, one or more times, passing a fragment of the message each time. The MAC that is calculated is the MAC of the concatenation of these messages in order.</li>
<li>At the end of the message, call <a class="el" href="crypto_8h.html#ac92b2930d6728e1be4d011c05d485822">psa_mac_verify_finish()</a> to finish calculating the actual MAC of the message and verify it against the expected value.</li>
</ol>
<p>If an error occurs at any step after a call to <a class="el" href="crypto_8h.html#a715679bbf633be958fa447216127eaf8">psa_mac_verify_setup()</a>, the operation will need to be reset by a call to <a class="el" href="crypto_8h.html#acd8dd54855ba1bc0a03f104f252884fd">psa_mac_abort()</a>. The application can call <a class="el" href="crypto_8h.html#acd8dd54855ba1bc0a03f104f252884fd">psa_mac_abort()</a> at any time after the operation has been initialized.</p>
<p>After a successful call to <a class="el" href="crypto_8h.html#a715679bbf633be958fa447216127eaf8">psa_mac_verify_setup()</a>, the application must eventually terminate the operation through one of the following methods:</p><ul>
<li>A successful call to <a class="el" href="crypto_8h.html#ac92b2930d6728e1be4d011c05d485822">psa_mac_verify_finish()</a>.</li>
<li>A call to <a class="el" href="crypto_8h.html#acd8dd54855ba1bc0a03f104f252884fd">psa_mac_abort()</a>.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>The operation object to set up. It must have been initialized as per the documentation for <a class="el" href="crypto__types_8h.html#a78f0838b0c4e3db28b26355624d4bd37">psa_mac_operation_t</a> and not yet in use. </td></tr>
    <tr><td class="paramname">key</td><td>Identifier of the key to use for the operation. It must remain valid until the operation terminates. It must allow the usage <a class="el" href="usage_8h.html#abea7ec4173f4f943110329ac2953b2b1">PSA_KEY_USAGE_VERIFY_MESSAGE</a>. </td></tr>
    <tr><td class="paramname">alg</td><td>The MAC algorithm to compute: a value of type psa_algorithm_t such that <a class="el" href="mac_2algorithm_8h.html#aca7aee4c9dde316b3b1a150a26eab776">PSA_ALG_IS_MAC</a>(<code>alg</code>) is true. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. </dd>
<dd>
PSA_ERROR_BAD_STATE The following conditions can result in this error:<ul>
<li>The operation state is not valid: it must be inactive.</li>
<li>The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INVALID_HANDLE <code>key</code> is not a valid key identifier. </dd>
<dd>
PSA_ERROR_NOT_PERMITTED The key does not have the <a class="el" href="usage_8h.html#abea7ec4173f4f943110329ac2953b2b1">PSA_KEY_USAGE_VERIFY_MESSAGE</a> flag, or it does not permit the requested algorithm. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The following conditions can result in this error:<ul>
<li><code>alg</code> is not a MAC algorithm.</li>
<li><code>key</code> is not compatible with <code>alg</code>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_NOT_SUPPORTED The following conditions can result in this error:<ul>
<li><code>alg</code> is not supported or is not a MAC algorithm.</li>
<li><code>key</code> is not supported for use with <code>alg</code>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="a09670055d73cef15422ad1b92113c09f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09670055d73cef15422ad1b92113c09f">&#9670;&nbsp;</a></span>psa_purge_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_purge_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove non-essential copies of key material from memory. </p>
<p>For keys that have been created with the <a class="el" href="usage_8h.html#ad0babcff38bd6afb43461197266fe073">PSA_KEY_USAGE_CACHE</a> usage flag, an implementation is permitted to make additional copies of the key material that are not in storage and not for the purpose of ongoing operations.</p>
<p>This function will remove these extra copies of the key material from memory.</p>
<p>This function is not required to remove key material from memory in any of the following situations:</p><ul>
<li>The key is currently in use in a cryptographic operation.</li>
<li>The key is volatile.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Identifier of the key to purge. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. The key material has been removed from memory, if the key material is not currently required. </dd>
<dd>
PSA_ERROR_BAD_STATE The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </dd>
<dd>
PSA_ERROR_INVALID_HANDLE <code>key</code> is not a valid key identifier. </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="a0c87346ea56b79f3dd173adee2abbde8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c87346ea56b79f3dd173adee2abbde8">&#9670;&nbsp;</a></span>psa_raw_key_agreement()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_raw_key_agreement </td>
          <td>(</td>
          <td class="paramtype">psa_algorithm_t&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>private_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>peer_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>peer_key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>output_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>output_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform a key agreement and return the raw shared secret. </p>
<dl class="section warning"><dt>Warning</dt><dd>The raw result of a key agreement algorithm such as finite-field Diffie-Hellman or elliptic curve Diffie-Hellman has biases, and is not suitable for use as key material. Instead it is recommended that the result is used as input to a key derivation algorithm. To chain a key agreement with a key derivation, use <a class="el" href="crypto_8h.html#a4da37a87ff9863e2a61eccefd331254a">psa_key_derivation_key_agreement()</a> and other functions from the key derivation interface.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">alg</td><td>The key agreement algorithm to compute: a value of type psa_algorithm_t such that <a class="el" href="key__agreement_2algorithm_8h.html#aa40ab362ce141ce541d69b2eb1f41438">PSA_ALG_IS_RAW_KEY_AGREEMENT</a>(<code>alg</code>) is true. </td></tr>
    <tr><td class="paramname">private_key</td><td>Identifier of the private key to use. It must allow the usage <a class="el" href="usage_8h.html#af19022acc5ef23cf12477f632b48a0b2">PSA_KEY_USAGE_DERIVE</a>. </td></tr>
    <tr><td class="paramname">peer_key</td><td>Public key of the peer. The peer key must be in the same format that <a class="el" href="crypto_8h.html#ad088d8ebc854d2f7a5b5c1769bc9ed40">psa_import_key()</a> accepts for the public key type corresponding to the type of private_key. That is, this function performs the equivalent of <a class="el" href="crypto_8h.html#ad088d8ebc854d2f7a5b5c1769bc9ed40">psa_import_key</a>(..., <code>peer_key</code>, <code>peer_key_length</code>), with key attributes indicating the public key type corresponding to the type of <code>private_key</code>. For example, for ECC keys, this means that <code>peer_key</code> is interpreted as a point on the curve that the private key is on. The standard formats for public keys are documented in the documentation of <a class="el" href="crypto_8h.html#a76970efac4f9418a03bf59dc345eaf88">psa_export_public_key()</a>. </td></tr>
    <tr><td class="paramname">peer_key_length</td><td>Size of peer_key in bytes. </td></tr>
    <tr><td class="paramname">output</td><td>Buffer where the raw shared secret is to be written. </td></tr>
    <tr><td class="paramname">output_size</td><td>Size of the output buffer in bytes. This must be appropriate for the keys:<ul>
<li>The required output size is <a class="el" href="crypto__values_8h.html#a189c37b83f1d5f792dc119bc5013a978">PSA_RAW_KEY_AGREEMENT_OUTPUT_SIZE</a> (<code>type</code>, <code>bits</code>) where type is the type of <code>private_key</code> and <code>bits</code> is the bit-size of either <code>private_key</code> or the <code>peer_key</code>.</li>
<li><a class="el" href="crypto__values_8h.html#af9612bd2bc7851c937fd6d6f94b4aba0">PSA_RAW_KEY_AGREEMENT_OUTPUT_MAX_SIZE</a> evaluates to the maximum output size of any supported raw key agreement algorithm. </li>
</ul>
</td></tr>
    <tr><td class="paramname">output_length</td><td>On success, the number of bytes that make up the returned output.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. The first (*output_length) bytes of output contain the raw shared secret. </dd>
<dd>
PSA_ERROR_BAD_STATE The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </dd>
<dd>
PSA_ERROR_INVALID_HANDLE <code>private_key</code> is not a valid key identifier. </dd>
<dd>
PSA_ERROR_NOT_PERMITTED <code>private_key</code> does not have the <a class="el" href="usage_8h.html#af19022acc5ef23cf12477f632b48a0b2">PSA_KEY_USAGE_DERIVE</a> flag, or it does not permit the requested algorithm. </dd>
<dd>
PSA_ERROR_BUFFER_TOO_SMALL The size of the output buffer is too small. <a class="el" href="crypto__values_8h.html#a189c37b83f1d5f792dc119bc5013a978">PSA_RAW_KEY_AGREEMENT_OUTPUT_SIZE()</a> or <a class="el" href="crypto__values_8h.html#af9612bd2bc7851c937fd6d6f94b4aba0">PSA_RAW_KEY_AGREEMENT_OUTPUT_MAX_SIZE</a> can be used to determine a sufficient buffer size. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The following conditions can result in this error:<ul>
<li><code>alg</code> is not a key agreement algorithm.</li>
<li><code>private_key</code> is not compatible with <code>alg</code>.</li>
<li><code>peer_key</code> is not a valid public key corresponding to <code>private_key</code>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_NOT_SUPPORTED The following conditions can result in this error:<ul>
<li><code>alg</code> is not supported or is not a key agreement algorithm.</li>
<li><code>private_key</code> is not supported for use with <code>alg</code>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="af737271e0d134f480334784fc23c8672"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af737271e0d134f480334784fc23c8672">&#9670;&nbsp;</a></span>psa_reset_key_attributes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void psa_reset_key_attributes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *&#160;</td>
          <td class="paramname"><em>attributes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reset a key attribute object to a freshly initialized state. </p>
<p>The attribute object must be initialized as described in the documentation of the type <a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> before calling this function. Once the object has been initialized, this function can be called at any time.</p>
<p>This function frees any auxiliary resources that the object might contain.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">attributes</td><td>The attribute object to reset. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l02051">2051</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="aeb8341ca52baa0279475ea3fd3bcdc98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb8341ca52baa0279475ea3fd3bcdc98">&#9670;&nbsp;</a></span>psa_set_key_algorithm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void psa_set_key_algorithm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *&#160;</td>
          <td class="paramname"><em>attributes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">psa_algorithm_t&#160;</td>
          <td class="paramname"><em>alg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Declare the permitted algorithm policy for a key. </p>
<p>The permitted algorithm policy of a key encodes which algorithm or algorithms are permitted to be used with this key. This function overwrites any permitted algorithm policy previously set in attributes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">attributes</td><td>The attribute object to write to. </td></tr>
    <tr><td class="paramname">alg</td><td>The permitted algorithm to write. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l01867">1867</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="af61683ac87f87687a40262b5afbfa018"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af61683ac87f87687a40262b5afbfa018">&#9670;&nbsp;</a></span>psa_set_key_bits()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void psa_set_key_bits </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *&#160;</td>
          <td class="paramname"><em>attributes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>bits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Declare the size of a key. </p>
<p>This function overwrites any key size previously set in attributes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">attributes</td><td>The attribute object to write to. </td></tr>
    <tr><td class="paramname">bits</td><td>The key size in bits. If this is 0, the key size in attributes becomes unspecified. Keys of size 0 are not supported. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l01895">1895</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="adc4695aa3d47aa1664271fdc1199bf65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc4695aa3d47aa1664271fdc1199bf65">&#9670;&nbsp;</a></span>psa_set_key_id()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void psa_set_key_id </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *&#160;</td>
          <td class="paramname"><em>attributes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Declare a key as persistent and set its key identifier. </p>
<p>The application must choose a value for id between <a class="el" href="id_8h.html#a2b062011d930839695577138858ec136">PSA_KEY_ID_USER_MIN</a> and <a class="el" href="id_8h.html#a9cb2bf7c6f7abfacccff4fd31dcfd564">PSA_KEY_ID_USER_MAX</a>. If the attribute object currently declares the key as volatile, which is the default lifetime of an attribute object, this function sets the lifetime attribute to <a class="el" href="lifetime_8h.html#a3713a01c5fcd5f7eae46ff22ceaf6d02">PSA_KEY_LIFETIME_PERSISTENT</a>.</p>
<p>This function does not access storage, it merely stores the given value in the attribute object. The persistent key will be written to storage when the attribute object is passed to a key creation function such as <a class="el" href="crypto_8h.html#ad088d8ebc854d2f7a5b5c1769bc9ed40">psa_import_key()</a>, <a class="el" href="crypto_8h.html#a950b4199ae7a0164006bd3d6927d1efe">psa_generate_key()</a>, <a class="el" href="crypto_8h.html#ad286b675f3f8b46fa6cab620de6bead3">psa_key_derivation_output_key()</a> or <a class="el" href="crypto_8h.html#a78da90274bd8f8680017a4bb513803a1">psa_copy_key()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">attributes</td><td>The attribute object to write to. </td></tr>
    <tr><td class="paramname">id</td><td>The persistent identifier for the key. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l01929">1929</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="ac03ccf09ca6d36cc3d5b43f8303db6f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac03ccf09ca6d36cc3d5b43f8303db6f7">&#9670;&nbsp;</a></span>psa_set_key_lifetime()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void psa_set_key_lifetime </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *&#160;</td>
          <td class="paramname"><em>attributes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="lifetime_8h.html#a6821ff6dd39dc2bc370ded760ad8b0cf">psa_key_lifetime_t</a>&#160;</td>
          <td class="paramname"><em>lifetime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the location of a persistent key. </p>
<p>To make a key persistent, give it a persistent key identifier by using <a class="el" href="crypto_8h.html#adc4695aa3d47aa1664271fdc1199bf65">psa_set_key_id()</a>. By default, a key that has a persistent identifier is stored in the default storage area identifier by <a class="el" href="lifetime_8h.html#a3713a01c5fcd5f7eae46ff22ceaf6d02">PSA_KEY_LIFETIME_PERSISTENT</a>. Call this function to choose a storage area, or to explicitly declare the key as volatile.</p>
<p>This function does not access storage, it merely stores the given value in the attribute object. The persistent key will be written to storage when the attribute object is passed to a key creation function such as <a class="el" href="crypto_8h.html#ad088d8ebc854d2f7a5b5c1769bc9ed40">psa_import_key()</a>, <a class="el" href="crypto_8h.html#a950b4199ae7a0164006bd3d6927d1efe">psa_generate_key()</a>, <a class="el" href="crypto_8h.html#ad286b675f3f8b46fa6cab620de6bead3">psa_key_derivation_output_key()</a> or <a class="el" href="crypto_8h.html#a78da90274bd8f8680017a4bb513803a1">psa_copy_key()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">attributes</td><td>The attribute object to write to. </td></tr>
    <tr><td class="paramname">lifetime</td><td>The lifetime for the key. If this is <a class="el" href="lifetime_8h.html#a8b438870ba69489b685730d346455108">PSA_KEY_LIFETIME_VOLATILE</a>, the key will be volatile, and the key identifier attribute is reset to <a class="el" href="id_8h.html#a650b5f7c553bf6f8db2076dbd9f4dd44">PSA_KEY_ID_NULL</a>. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l01966">1966</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="a6857ef0ecb3fa844d4536939d9c64025"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6857ef0ecb3fa844d4536939d9c64025">&#9670;&nbsp;</a></span>psa_set_key_type()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void psa_set_key_type </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *&#160;</td>
          <td class="paramname"><em>attributes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="psa__crypto_2psa_2key_2type_8h.html#a63fce6880ca5933b5d6baa257febf1f6">psa_key_type_t</a>&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Declare the type of a key. </p>
<p>This function overwrites any key type previously set in <code>attributes</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">attributes</td><td>The attribute object to write to. </td></tr>
    <tr><td class="paramname">type</td><td>The key type to write. If this is <a class="el" href="psa__crypto_2psa_2key_2type_8h.html#afce7ab2b54ce97ea5bff73f13a9f3e5b">PSA_KEY_TYPE_NONE</a>, the key type in attributes becomes unspecified. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l01993">1993</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="a42a65b3c4522ce9b67ea5ea7720e17de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42a65b3c4522ce9b67ea5ea7720e17de">&#9670;&nbsp;</a></span>psa_set_key_usage_flags()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void psa_set_key_usage_flags </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="attributes_8h.html#a0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *&#160;</td>
          <td class="paramname"><em>attributes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="usage_8h.html#a7bb9de71337e0e98de843aa7f9b55f25">psa_key_usage_t</a>&#160;</td>
          <td class="paramname"><em>usage_flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Declare usage flags for a key. </p>
<p>Usage flags are part of a keys policy. They encode what kind of operations are permitted on the key. For more details, see Key policies.</p>
<p>This function overwrites any usage flags previously set in attributes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">attributes</td><td>The attribute object to write to. </td></tr>
    <tr><td class="paramname">usage_flags</td><td>The usage flags to write. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l02022">2022</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="a429241820edc81d0f262bdf43d3b6523"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a429241820edc81d0f262bdf43d3b6523">&#9670;&nbsp;</a></span>psa_sign_hash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_sign_hash </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">psa_algorithm_t&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>hash_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>signature_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>signature_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sign an already-calculated hash with a private key. </p>
<p>With most signature mechanisms that follow the hash-and-sign paradigm, the hash input to this function is the hash of the message to sign. The hash algorithm is encoded in the signature algorithm.</p>
<p>Some hash-and-sign mechanisms apply a padding or encoding to the hash. In such cases, the encoded hash must be passed to this function. The current version of this specification defines one such signature algorithm: <a class="el" href="asymmetric__signature_2algorithm_8h.html#a4215e2a78dcf834e9a625927faa2a817">PSA_ALG_RSA_PKCS1V15_SIGN_RAW</a>.</p>
<dl class="section note"><dt>Note</dt><dd>To perform a hash-and-sign signature algorithm, the hash must be calculated before passing it to this function. This can be done by calling <a class="el" href="crypto_8h.html#ac69f7f19d96a56c28cf3799d11b12156">psa_hash_compute()</a> or with a multi-part hash operation. The correct hash algorithm to use can be determined using <a class="el" href="hash_2algorithm_8h.html#a181b0fe4619c1a70c5ef82f28eea09f5">PSA_ALG_GET_HASH()</a>.</dd></dl>
<p>Alternatively, to hash and sign a message in a single call, use <a class="el" href="crypto_8h.html#a295407a9d6fd0d7ddc6aebf6ead4955c">psa_sign_message()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Identifier of the key to use for the operation. It must be an asymmetric key pair. The key must allow the usage <a class="el" href="usage_8h.html#a181c73e00d9e95aa3a8366f26c4380b6">PSA_KEY_USAGE_SIGN_HASH</a>. </td></tr>
    <tr><td class="paramname">alg</td><td>An asymmetric signature algorithm that separates the hash and sign operations: a value of type psa_algorithm_t such that <a class="el" href="asymmetric__signature_2algorithm_8h.html#a7664f69c28b193cc6cb8368481fcda64">PSA_ALG_IS_SIGN_HASH</a>(<code>alg</code>) is true. </td></tr>
    <tr><td class="paramname">hash</td><td>The input to sign. This is usually the hash of a message. See the detailed description of this function and the description of individual signature algorithms for a detailed description of acceptable inputs. </td></tr>
    <tr><td class="paramname">hash_length</td><td>Size of the hash buffer in bytes. </td></tr>
    <tr><td class="paramname">signature</td><td>Buffer where the signature is to be written. </td></tr>
    <tr><td class="paramname">signature_size</td><td>Size of the signature buffer in bytes. This must be appropriate for the selected algorithm and key:<ul>
<li>The required signature size is <a class="el" href="crypto__sizes_8h.html#a31021bbd8bb365fc350532b5fd18a25a">PSA_SIGN_OUTPUT_SIZE</a>(<code>key_type</code>, <code>key_bits</code>, <code>alg</code>) where <code>key_type</code> and <code>key_bits</code> are the type and bit-size respectively of <code>key</code>.</li>
<li><a class="el" href="crypto__values_8h.html#a687a317642db9486fda38ea553900a1e">PSA_SIGNATURE_MAX_SIZE</a> evaluates to the maximum signature size of any supported signature algorithm. </li>
</ul>
</td></tr>
    <tr><td class="paramname">signature_length</td><td>On success, the number of bytes that make up the returned signature value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. The first <code></code>(*signature_length) bytes of <code>signature</code> contain the signature value. </dd>
<dd>
PSA_ERROR_BAD_STATE The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </dd>
<dd>
PSA_ERROR_INVALID_HANDLE <code>key</code> is not a valid key identifier. </dd>
<dd>
PSA_ERROR_NOT_PERMITTED The key does not have the <a class="el" href="usage_8h.html#a181c73e00d9e95aa3a8366f26c4380b6">PSA_KEY_USAGE_SIGN_HASH</a> flag, or it does not permit the requested algorithm. </dd>
<dd>
PSA_ERROR_BUFFER_TOO_SMALL The size of the signature buffer is too small. <a class="el" href="crypto__sizes_8h.html#a31021bbd8bb365fc350532b5fd18a25a">PSA_SIGN_OUTPUT_SIZE()</a> or <a class="el" href="crypto__values_8h.html#a687a317642db9486fda38ea553900a1e">PSA_SIGNATURE_MAX_SIZE</a> can be used to determine a sufficient buffer size. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The following conditions can result in this error:<ul>
<li><code>alg</code> is not an asymmetric signature algorithm.</li>
<li><code>key</code> is not an asymmetric key pair, that is compatible with <code>alg</code>.</li>
<li><code>hash_length</code> is not valid for the algorithm and key type. </li>
</ul>
</dd>
<dd>
PSA_ERROR_NOT_SUPPORTED The following conditions can result in this error:<ul>
<li><code>alg</code> is not supported or is not an asymmetric signature algorithm.</li>
<li><code>key</code> is not supported for use with alg. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INSUFFICIENT_ENTROPY </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="a295407a9d6fd0d7ddc6aebf6ead4955c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a295407a9d6fd0d7ddc6aebf6ead4955c">&#9670;&nbsp;</a></span>psa_sign_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_sign_message </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">psa_algorithm_t&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>input_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>signature_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>signature_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sign a message with a private key. </p>
<p>For hash-and-sign algorithms, this includes the hashing step.</p>
<dl class="section note"><dt>Note</dt><dd>To perform a multi-part hash-and-sign signature algorithm, first use a multi-part hash operation and then pass the resulting hash to <a class="el" href="crypto_8h.html#a429241820edc81d0f262bdf43d3b6523">psa_sign_hash()</a>. <a class="el" href="hash_2algorithm_8h.html#a181b0fe4619c1a70c5ef82f28eea09f5">PSA_ALG_GET_HASH</a>(<code>alg</code>) can be used to determine the hash algorithm to use.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Identifier of the key to use for the operation. It must be an asymmetric key pair. The key must allow the usage <a class="el" href="usage_8h.html#a552117ac92b79500cae87d4e65a85c54">PSA_KEY_USAGE_SIGN_MESSAGE</a>. </td></tr>
    <tr><td class="paramname">alg</td><td>An asymmetric signature algorithm: a value of type psa_algorithm_t such that <a class="el" href="asymmetric__signature_2algorithm_8h.html#acd8b87e858614134de566edaa4d84db8">PSA_ALG_IS_SIGN_MESSAGE</a>(<code>alg</code>) is true. </td></tr>
    <tr><td class="paramname">input</td><td>The input message to sign. </td></tr>
    <tr><td class="paramname">input_length</td><td>Size of the input buffer in bytes. </td></tr>
    <tr><td class="paramname">signature</td><td>Buffer where the signature is to be written. </td></tr>
    <tr><td class="paramname">signature_size</td><td>Size of the signature buffer in bytes. This must be appropriate for the selected algorithm and key:<ul>
<li>The required signature size is <a class="el" href="crypto__sizes_8h.html#a31021bbd8bb365fc350532b5fd18a25a">PSA_SIGN_OUTPUT_SIZE</a> (<code>key_type</code>, <code>key_bits</code>, <code>alg</code>) where <code>key_type</code> and <code>key_bits</code> are the type and bit-size respectively of <code>key</code>.</li>
<li><a class="el" href="crypto__values_8h.html#a687a317642db9486fda38ea553900a1e">PSA_SIGNATURE_MAX_SIZE</a> evaluates to the maximum signature size of any supported signature algorithm. </li>
</ul>
</td></tr>
    <tr><td class="paramname">signature_length</td><td>On success, the number of bytes that make up the returned signature value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. The first <code></code>(*signature_length) bytes of <code>signature</code> contain the signature value. </dd>
<dd>
PSA_ERROR_BAD_STATE The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </dd>
<dd>
PSA_ERROR_INVALID_HANDLE <code>key</code> is not a valid key identifier. </dd>
<dd>
PSA_ERROR_NOT_PERMITTED The key does not have the <a class="el" href="usage_8h.html#a552117ac92b79500cae87d4e65a85c54">PSA_KEY_USAGE_SIGN_MESSAGE</a> flag, or it does not permit the requested algorithm. </dd>
<dd>
PSA_ERROR_BUFFER_TOO_SMALL The size of the signature buffer is too small. <a class="el" href="crypto__sizes_8h.html#a31021bbd8bb365fc350532b5fd18a25a">PSA_SIGN_OUTPUT_SIZE()</a> or <a class="el" href="crypto__values_8h.html#a687a317642db9486fda38ea553900a1e">PSA_SIGNATURE_MAX_SIZE</a> can be used to determine a sufficient buffer size. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The following conditions can result in this error:<ul>
<li><code>alg</code> is not an asymmetric signature algorithm.</li>
<li><code>key</code> is not an asymmetric key pair, that is compatible with <code>alg</code>.</li>
<li><code>input_length</code> is too large for the algorithm and key type. </li>
</ul>
</dd>
<dd>
PSA_ERROR_NOT_SUPPORTED The following conditions can result in this error:<ul>
<li><code>alg</code> is not supported or is not an asymmetric signature algorithm.</li>
<li><code>key</code> is not supported for use with <code>alg</code>.</li>
<li><code>input_length</code> is too large for the implementation. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INSUFFICIENT_ENTROPY </dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="a4dfb4c6a8d0ec1d237dcc30de04aeeb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4dfb4c6a8d0ec1d237dcc30de04aeeb3">&#9670;&nbsp;</a></span>psa_status_to_humanly_readable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* psa_status_to_humanly_readable </td>
          <td>(</td>
          <td class="paramtype">psa_status_t&#160;</td>
          <td class="paramname"><em>status</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Helper function to convert PSA status values humanly readable. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">status</td><td>PSA status value </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to string </dd></dl>

</div>
</div>
<a id="a01b4dea9fdb090219123f5de26bb6716"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01b4dea9fdb090219123f5de26bb6716">&#9670;&nbsp;</a></span>psa_verify_hash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_verify_hash </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">psa_algorithm_t&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>hash_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>signature_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verify the signature of a hash or short message using a public key. </p>
<p>With most signature mechanisms that follow the hash-and-sign paradigm, the hash input to this function is the hash of the message to sign. The hash algorithm is encoded in the signature algorithm.</p>
<p>Some hash-and-sign mechanisms apply a padding or encoding to the hash. In such cases, the encoded hash must be passed to this function. The current version of this specification defines one such signature algorithm: <a class="el" href="asymmetric__signature_2algorithm_8h.html#a4215e2a78dcf834e9a625927faa2a817">PSA_ALG_RSA_PKCS1V15_SIGN_RAW</a>.</p>
<dl class="section note"><dt>Note</dt><dd>To perform a hash-and-sign verification algorithm, the hash must be calculated before passing it to this function. This can be done by calling <a class="el" href="crypto_8h.html#ac69f7f19d96a56c28cf3799d11b12156">psa_hash_compute()</a> or with a multi-part hash operation. Alternatively, to hash and verify a message signature in a single call, use <a class="el" href="crypto_8h.html#a8112e02cd89cc652acb2f45074a7464e">psa_verify_message()</a>.</dd>
<dd>
When using secure elements as backends in this implementation, the key type can only be of type <a class="el" href="psa__crypto_2psa_2key_2type_8h.html#ad54c03d3b47020e571a72cd01d978cf2">PSA_KEY_TYPE_ECC_PUBLIC_KEY(curve)</a> and must be stored on a secure element. To use the public key of a previously generated key pair, please export the public key first and then import it as a separate key with its own attributes and identifier.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Identifier of the key to use for the operation. It must be a public key or an asymmetric key pair. The key must allow the usage <a class="el" href="usage_8h.html#afadf131ef2182045e3483d03aadaa1bd">PSA_KEY_USAGE_VERIFY_HASH</a>. </td></tr>
    <tr><td class="paramname">alg</td><td>An asymmetric signature algorithm that separates the hash and sign operations (PSA_ALG_XXX value such that <a class="el" href="asymmetric__signature_2algorithm_8h.html#a7664f69c28b193cc6cb8368481fcda64">PSA_ALG_IS_SIGN_HASH</a>(<code>alg</code>) is true), that is compatible with the type of key. </td></tr>
    <tr><td class="paramname">hash</td><td>The input whose signature is to be verified. This is usually the hash of a message. See the detailed description of this function and the description of individual signature algorithms for a detailed description of acceptable inputs. </td></tr>
    <tr><td class="paramname">hash_length</td><td>Size of the hash buffer in bytes. </td></tr>
    <tr><td class="paramname">signature</td><td>Buffer containing the signature to verify. </td></tr>
    <tr><td class="paramname">signature_length</td><td>Size of the signature buffer in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. The signature is valid. </dd>
<dd>
PSA_ERROR_BAD_STATE The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </dd>
<dd>
PSA_ERROR_INVALID_HANDLE <code>key</code> is not a valid key identifier. </dd>
<dd>
PSA_ERROR_NOT_PERMITTED The key does not have the <a class="el" href="usage_8h.html#afadf131ef2182045e3483d03aadaa1bd">PSA_KEY_USAGE_VERIFY_HASH</a> flag, or it does not permit the requested algorithm. </dd>
<dd>
PSA_ERROR_INVALID_SIGNATURE <code>signature</code> is not the result of signing hash with algorithm <code>alg</code> using the private key corresponding to <code>key</code>. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The following conditions can result in this error:<ul>
<li><code>alg</code> is not an asymmetric signature algorithm.</li>
<li><code>key</code> is not a public key or an asymmetric key pair, that is compatible with <code>alg</code>.</li>
<li><code>hash_length</code> is not valid for the algorithm and key type. </li>
</ul>
</dd>
<dd>
PSA_ERROR_NOT_SUPPORTED The following conditions can result in this error:<ul>
<li><code>alg</code> is not supported or is not an asymmetric signature algorithm.</li>
<li><code>key</code> is not supported for use with <code>alg</code>. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
<a id="a8112e02cd89cc652acb2f45074a7464e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8112e02cd89cc652acb2f45074a7464e">&#9670;&nbsp;</a></span>psa_verify_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psa_status_t psa_verify_message </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="id_8h.html#a11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">psa_algorithm_t&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>input_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>signature_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verify the signature of a message with a public key. </p>
<p>For hash-and-sign algorithms, this includes the hashing step.</p>
<dl class="section note"><dt>Note</dt><dd>To perform a multi-part hash-and-sign signature verification algorithm, first use a multi-part hash operation to hash the message and then pass the resulting hash to <a class="el" href="crypto_8h.html#a01b4dea9fdb090219123f5de26bb6716">psa_verify_hash()</a>. <a class="el" href="hash_2algorithm_8h.html#a181b0fe4619c1a70c5ef82f28eea09f5">PSA_ALG_GET_HASH</a>(<code>alg</code>) can be used to determine the hash algorithm to use.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Identifier of the key to use for the operation. It must be a public key or an asymmetric key pair. The key must allow the usage <a class="el" href="usage_8h.html#abea7ec4173f4f943110329ac2953b2b1">PSA_KEY_USAGE_VERIFY_MESSAGE</a>. </td></tr>
    <tr><td class="paramname">alg</td><td>An asymmetric signature algorithm: a value of type psa_algorithm_t such that <a class="el" href="asymmetric__signature_2algorithm_8h.html#acd8b87e858614134de566edaa4d84db8">PSA_ALG_IS_SIGN_MESSAGE</a>(<code>alg</code>) is true. </td></tr>
    <tr><td class="paramname">input</td><td>The message whose signature is to be verified. </td></tr>
    <tr><td class="paramname">input_length</td><td>Size of the <code>input</code> buffer in bytes. </td></tr>
    <tr><td class="paramname">signature</td><td>Buffer containing the signature to verify. </td></tr>
    <tr><td class="paramname">signature_length</td><td>Size of the <code>signature</code> buffer in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PSA_SUCCESS Success. The signature is valid. </dd>
<dd>
PSA_ERROR_BAD_STATE The library requires initializing by a call to <a class="el" href="crypto_8h.html#a2de150803fc2f7dc6101d5af7e921dd9">psa_crypto_init()</a>. </dd>
<dd>
PSA_ERROR_INVALID_HANDLE <code>key</code> is not a valid key identifier. </dd>
<dd>
PSA_ERROR_NOT_PERMITTED The key does not have the <a class="el" href="usage_8h.html#abea7ec4173f4f943110329ac2953b2b1">PSA_KEY_USAGE_VERIFY_MESSAGE</a> flag, or it does not permit the requested algorithm. </dd>
<dd>
PSA_ERROR_INVALID_SIGNATURE <code>signature</code> is not the result of signing the input message with algorithm <code>alg</code> using the private key corresponding to <code>key</code>. </dd>
<dd>
PSA_ERROR_INVALID_ARGUMENT The following conditions can result in this error:<ul>
<li><code>alg</code> is not an asymmetric signature algorithm.</li>
<li><code>key</code> is not a public key or an asymmetric key pair, that is compatible with <code>alg</code>.</li>
<li><code>input_length</code> is too large for the algorithm and key type. </li>
</ul>
</dd>
<dd>
PSA_ERROR_NOT_SUPPORTED The following conditions can result in this error:<ul>
<li><code>alg</code> is not supported or is not an asymmetric signature algorithm.</li>
<li><code>key</code> is not supported for use with <code>alg</code>.</li>
<li><code>input_length</code> is too large for the implementation. </li>
</ul>
</dd>
<dd>
PSA_ERROR_INSUFFICIENT_MEMORY </dd>
<dd>
PSA_ERROR_COMMUNICATION_FAILURE </dd>
<dd>
PSA_ERROR_CORRUPTION_DETECTED </dd>
<dd>
PSA_ERROR_STORAGE_FAILURE </dd>
<dd>
PSA_ERROR_DATA_CORRUPT </dd>
<dd>
PSA_ERROR_DATA_INVALID </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
    <div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
        <ul>
            <li class="footer">Generated on Thu Mar 13 2025 10:38:29 by <a href="http://www.doxygen.org/index.html">
                       <img class="footer" src="doxygen.png" alt="doxygen"></a> 1.8.14</li>
        </ul>
    </div>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="bootstrap.min.js"></script>
    <script src="jquery.smartmenus.min.js"></script>
    <script src="jquery.smartmenus.bootstrap.min.js"></script>
    <script src="riot-doxy.js"></script>
  </body>
</html>
